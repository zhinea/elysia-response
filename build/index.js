var RZ=Object.create;var{defineProperty:p6,getPrototypeOf:jZ,getOwnPropertyNames:KZ}=Object;var VZ=Object.prototype.hasOwnProperty;var w$=($,X,J)=>{J=$!=null?RZ(jZ($)):{};const Q=X||!$||!$.__esModule?p6(J,"default",{value:$,enumerable:!0}):J;for(let W of KZ($))if(!VZ.call(Q,W))p6(Q,W,{get:()=>$[W],enumerable:!0});return Q};var i8=($,X)=>()=>(X||$((X={exports:{}}).exports,X),X.exports);var b8=($,X)=>{for(var J in X)p6($,J,{get:X[J],enumerable:!0,configurable:!0,set:(Q)=>X[J]=()=>Q})};var CJ=i8((_U,m6)=>{var G$=function(){},IZ=function($,X,J){this.fn=$,this.context=X,this.once=J||!1},PJ=function($,X,J,Q,W){if(typeof J!=="function")throw new TypeError("The listener must be a function");var Z=new IZ(J,Q||$,W),Y=o0?o0+X:X;if(!$._events[Y])$._events[Y]=Z,$._eventsCount++;else if(!$._events[Y].fn)$._events[Y].push(Z);else $._events[Y]=[$._events[Y],Z];return $},$6=function($,X){if(--$._eventsCount===0)$._events=new G$;else delete $._events[X]},u0=function(){this._events=new G$,this._eventsCount=0},EZ=Object.prototype.hasOwnProperty,o0="~";if(Object.create){if(G$.prototype=Object.create(null),!new G$().__proto__)o0=!1}u0.prototype.eventNames=function $(){var X=[],J,Q;if(this._eventsCount===0)return X;for(Q in J=this._events)if(EZ.call(J,Q))X.push(o0?Q.slice(1):Q);if(Object.getOwnPropertySymbols)return X.concat(Object.getOwnPropertySymbols(J));return X};u0.prototype.listeners=function $(X){var J=o0?o0+X:X,Q=this._events[J];if(!Q)return[];if(Q.fn)return[Q.fn];for(var W=0,Z=Q.length,Y=new Array(Z);W<Z;W++)Y[W]=Q[W].fn;return Y};u0.prototype.listenerCount=function $(X){var J=o0?o0+X:X,Q=this._events[J];if(!Q)return 0;if(Q.fn)return 1;return Q.length};u0.prototype.emit=function $(X,J,Q,W,Z,Y){var z=o0?o0+X:X;if(!this._events[z])return!1;var q=this._events[z],G=arguments.length,B,H;if(q.fn){if(q.once)this.removeListener(X,q.fn,void 0,!0);switch(G){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,J),!0;case 3:return q.fn.call(q.context,J,Q),!0;case 4:return q.fn.call(q.context,J,Q,W),!0;case 5:return q.fn.call(q.context,J,Q,W,Z),!0;case 6:return q.fn.call(q.context,J,Q,W,Z,Y),!0}for(H=1,B=new Array(G-1);H<G;H++)B[H-1]=arguments[H];q.fn.apply(q.context,B)}else{var L=q.length,b;for(H=0;H<L;H++){if(q[H].once)this.removeListener(X,q[H].fn,void 0,!0);switch(G){case 1:q[H].fn.call(q[H].context);break;case 2:q[H].fn.call(q[H].context,J);break;case 3:q[H].fn.call(q[H].context,J,Q);break;case 4:q[H].fn.call(q[H].context,J,Q,W);break;default:if(!B)for(b=1,B=new Array(G-1);b<G;b++)B[b-1]=arguments[b];q[H].fn.apply(q[H].context,B)}}}return!0};u0.prototype.on=function $(X,J,Q){return PJ(this,X,J,Q,!1)};u0.prototype.once=function $(X,J,Q){return PJ(this,X,J,Q,!0)};u0.prototype.removeListener=function $(X,J,Q,W){var Z=o0?o0+X:X;if(!this._events[Z])return this;if(!J)return $6(this,Z),this;var Y=this._events[Z];if(Y.fn){if(Y.fn===J&&(!W||Y.once)&&(!Q||Y.context===Q))$6(this,Z)}else{for(var z=0,q=[],G=Y.length;z<G;z++)if(Y[z].fn!==J||W&&!Y[z].once||Q&&Y[z].context!==Q)q.push(Y[z]);if(q.length)this._events[Z]=q.length===1?q[0]:q;else $6(this,Z)}return this};u0.prototype.removeAllListeners=function $(X){var J;if(X){if(J=o0?o0+X:X,this._events[J])$6(this,J)}else this._events=new G$,this._eventsCount=0;return this};u0.prototype.off=u0.prototype.removeListener;u0.prototype.addListener=u0.prototype.on;u0.prefixed=o0;u0.EventEmitter=u0;if(typeof m6!=="undefined")m6.exports=u0});var R6=i8(($K,PW)=>{var HB=function($){var X=$.indexOf("%");if(X===-1)return $;var J=$.length,Q="",W=0,Z=0,Y=X,z=SW;while(X>-1&&X<J){var q=_W($[X+1],4),G=_W($[X+2],0),B=q|G,H=YJ[B];if(z=YJ[256+z+H],Z=Z<<6|B&YJ[364+H],z===SW)Q+=$.slice(W,Y),Q+=Z<=65535?String.fromCharCode(Z):String.fromCharCode(55232+(Z>>10),56320+(Z&1023)),Z=0,W=X+3,X=Y=$.indexOf("%",W);else if(z===AB)return null;else{if(X+=3,X<J&&$.charCodeAt(X)===37)continue;return null}}return Q+$.slice(W)},_W=function($,X){var J=NB[$];return J===void 0?255:J<<X},SW=12,AB=0,YJ=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7],NB={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};PW.exports=HB});var jW=i8((XK,RW)=>{var DB=function($){const X=new bW;if(typeof $!=="string")return X;let J=$.length,Q="",W="",Z=-1,Y=-1,z=!1,q=!1,G=!1,B=!1,H=!1,L=0;for(let b=0;b<J+1;b++)if(L=b!==J?$.charCodeAt(b):38,L===38){if(H=Y>Z,!H)Y=b;if(Q=$.slice(Z+1,Y),H||Q.length>0){if(G)Q=Q.replace(FW," ");if(z)Q=CW(Q)||Q;if(H){if(W=$.slice(Y+1,b),B)W=W.replace(FW," ");if(q)W=CW(W)||W}const T=X[Q];if(T===void 0)X[Q]=W;else if(T.pop)T.push(W);else X[Q]=[T,W]}W="",Z=b,Y=b,z=!1,q=!1,G=!1,B=!1}else if(L===61)if(Y<=Z)Y=b;else q=!0;else if(L===43)if(Y>Z)B=!0;else G=!0;else if(L===37)if(Y>Z)q=!0;else z=!0;return X},CW=R6(),FW=/\+/g,bW=function(){};bW.prototype=Object.create(null);RW.exports=DB});var VW=i8((JK,KW)=>{var LB=function($){const X=$.length;if(X===0)return"";let J="",Q=0,W=0;$:for(;W<X;W++){let Z=$.charCodeAt(W);while(Z<128){if(OB[Z]!==1){if(Q<W)J+=$.slice(Q,W);Q=W+1,J+=s1[Z]}if(++W===X)break $;Z=$.charCodeAt(W)}if(Q<W)J+=$.slice(Q,W);if(Z<2048){Q=W+1,J+=s1[192|Z>>6]+s1[128|Z&63];continue}if(Z<55296||Z>=57344){Q=W+1,J+=s1[224|Z>>12]+s1[128|Z>>6&63]+s1[128|Z&63];continue}if(++W,W>=X)throw new Error("URI malformed");const Y=$.charCodeAt(W)&1023;Q=W+1,Z=65536+((Z&1023)<<10|Y),J+=s1[240|Z>>18]+s1[128|Z>>12&63]+s1[128|Z>>6&63]+s1[128|Z&63]}if(Q===0)return $;if(Q<X)return J+$.slice(Q);return J},s1=Array.from({length:256},($,X)=>"%"+((X<16?"0":"")+X.toString(16)).toUpperCase()),OB=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);KW.exports={encodeString:LB}});var kW=i8((QK,IW)=>{var EW=function($){const X=typeof $;if(X==="string")return zJ($);else if(X==="bigint")return $.toString();else if(X==="boolean")return $?"true":"false";else if(X==="number"&&Number.isFinite($))return $<1000000000000000000000?""+$:zJ(""+$);return""},SB=function($){let X="";if($===null||typeof $!=="object")return X;const J="&",Q=Object.keys($),W=Q.length;let Z=0;for(let Y=0;Y<W;Y++){const z=Q[Y],q=$[z],G=zJ(z)+"=";if(Y)X+=J;if(Array.isArray(q)){Z=q.length;for(let B=0;B<Z;B++){if(B)X+=J;X+=G,X+=EW(q[B])}}else X+=G,X+=EW(q)}return X},{encodeString:zJ}=VW();IW.exports=SB});var qJ=i8((WK,t$)=>{var xW=jW(),gW=kW(),TW={parse:xW,stringify:gW};t$.exports=TW;t$.exports.default=TW;t$.exports.parse=xW;t$.exports.stringify=gW});var FJ=w$(CJ(),1);var bJ=FJ.default;function X6($){return y0($)&&Symbol.asyncIterator in $}function J6($){return y0($)&&Symbol.iterator in $}function w0($){return y0($)&&!y($)&&M$($.constructor)&&$.constructor.name==="Object"}function Q6($){return $ instanceof Promise}function Y1($){return $ instanceof Date&&Number.isFinite($.getTime())}function D1($){return ArrayBuffer.isView($)}function c8($){return $ instanceof globalThis.Uint8Array}function u($,X){return X in $}function y0($){return $!==null&&typeof $==="object"}function y($){return Array.isArray($)&&!ArrayBuffer.isView($)}function H0($){return $===void 0}function W8($){return $===null}function h1($){return typeof $==="boolean"}function E($){return typeof $==="number"}function W6($){return E($)&&Number.isInteger($)}function d0($){return typeof $==="bigint"}function v($){return typeof $==="string"}function M$($){return typeof $==="function"}function r0($){return typeof $==="symbol"}function z1($){return d0($)||h1($)||W8($)||E($)||v($)||r0($)||H0($)}var F0;(function($){$.ExactOptionalPropertyTypes=!1,$.AllowArrayObject=!1,$.AllowNaN=!1,$.AllowNullVoid=!1;function X(Y,z){return $.ExactOptionalPropertyTypes?z in Y:Y[z]!==void 0}$.IsExactOptionalProperty=X;function J(Y){const z=y0(Y);return $.AllowArrayObject?z:z&&!y(Y)}$.IsObjectLike=J;function Q(Y){return J(Y)&&!(Y instanceof Date)&&!(Y instanceof Uint8Array)}$.IsRecordLike=Q;function W(Y){const z=E(Y);return $.AllowNaN?z:z&&Number.isFinite(Y)}$.IsNumberLike=W;function Z(Y){const z=H0(Y);return $.AllowNullVoid?z||Y===null:z}$.IsVoidLike=Z})(F0||(F0={}));var _0={};b8(_0,{Set:()=>{{return fZ}},Has:()=>{{return TZ}},Get:()=>{{return yZ}},Entries:()=>{{return kZ}},Delete:()=>{{return gZ}},Clear:()=>{{return xZ}}});function kZ(){return new Map(o8)}function xZ(){return o8.clear()}function gZ($){return o8.delete($)}function TZ($){return o8.has($)}function fZ($,X){o8.set($,X)}function yZ($){return o8.get($)}var o8=new Map;var b0={};b8(b0,{Set:()=>{{return mZ}},Has:()=>{{return pZ}},Get:()=>{{return uZ}},Entries:()=>{{return dZ}},Delete:()=>{{return hZ}},Clear:()=>{{return vZ}}});function dZ(){return new Map(l8)}function vZ(){return l8.clear()}function hZ($){return l8.delete($)}function pZ($){return l8.has($)}function mZ($,X){l8.set($,X)}function uZ($){return l8.get($)}var l8=new Map;var E0=Symbol.for("TypeBox.Transform"),N8=Symbol.for("TypeBox.Readonly"),a0=Symbol.for("TypeBox.Optional"),O1=Symbol.for("TypeBox.Hint"),D=Symbol.for("TypeBox.Kind");function A$($={}){return{...$,[D]:$[D]??"Unsafe"}}class d extends Error{constructor($){super($)}}class u6 extends d{constructor($){super(`Duplicate type kind '${$}' detected`)}}class i6 extends d{constructor($){super(`Duplicate string format '${$}' detected`)}}var p1;(function($){function X(Q,W){if(b0.Has(Q))throw new u6(Q);return b0.Set(Q,W),(Z={})=>A$({...Z,[D]:Q})}$.Type=X;function J(Q,W){if(_0.Has(Q))throw new i6(Q);return _0.Set(Q,W),Q}$.Format=J})(p1||(p1={}));function n($){return{[D]:"MappedResult",properties:$}}var q1={};b8(q1,{IsUndefined:()=>{{return D0}},IsUint8Array:()=>{{return j8}},IsSymbol:()=>{{return s6}},IsString:()=>{{return N0}},IsRegExp:()=>{{return t6}},IsObject:()=>{{return R0}},IsNumber:()=>{{return m1}},IsNull:()=>{{return n6}},IsIterator:()=>{{return l6}},IsFunction:()=>{{return o6}},IsDate:()=>{{return N$}},IsBoolean:()=>{{return R8}},IsBigInt:()=>{{return H$}},IsAsyncIterator:()=>{{return c6}},IsArray:()=>{{return e0}}});function c6($){return R0($)&&!e0($)&&!j8($)&&Symbol.asyncIterator in $}function e0($){return Array.isArray($)}function H$($){return typeof $==="bigint"}function R8($){return typeof $==="boolean"}function N$($){return $ instanceof globalThis.Date}function o6($){return typeof $==="function"}function l6($){return R0($)&&!e0($)&&!j8($)&&Symbol.iterator in $}function n6($){return $===null}function m1($){return typeof $==="number"}function R0($){return typeof $==="object"&&$!==null}function t6($){return $ instanceof globalThis.RegExp}function N0($){return typeof $==="string"}function s6($){return typeof $==="symbol"}function j8($){return $ instanceof globalThis.Uint8Array}function D0($){return $===void 0}var iZ=function($){return $.map((X)=>Z6(X))},cZ=function($){return new Date($.getTime())},oZ=function($){return new Uint8Array($)},lZ=function($){return new RegExp($.source,$.flags)},nZ=function($){const X=Object.getOwnPropertyNames($).reduce((Q,W)=>({...Q,[W]:Z6($[W])}),{}),J=Object.getOwnPropertySymbols($).reduce((Q,W)=>({...Q,[W]:Z6($[W])}),{});return{...X,...J}},Z6=function($){return e0($)?iZ($):N$($)?cZ($):j8($)?oZ($):t6($)?lZ($):R0($)?nZ($):$};function RJ($){return Z6($)}function I0($){return $.map((X)=>S(X))}function S($,X={}){return{...RJ($),...X}}var tZ=function($,X){const{[X]:J,...Q}=$;return Q};function P0($,X){return X.reduce((J,Q)=>tZ(J,Q),$)}function D$($,X={}){return{...X,[D]:"Array",type:"array",items:S($)}}function O$($,X={}){return{...X,[D]:"AsyncIterator",type:"AsyncIterator",items:S($)}}function L$($,X,J){return{...J,[D]:"Constructor",type:"Constructor",parameters:I0($),returns:S(X)}}function Z8($,X,J){return{...J,[D]:"Function",type:"Function",parameters:I0($),returns:S(X)}}function $0($={}){return{...$,[D]:"Never",not:{}}}var w={};b8(w,{TypeGuardUnknownTypeError:()=>{{return jJ}},IsVoid:()=>{{return iJ}},IsUnsafe:()=>{{return uJ}},IsUnknown:()=>{{return mJ}},IsUnionLiteral:()=>{{return XY}},IsUnion:()=>{{return o}},IsUndefined:()=>{{return hJ}},IsUint8Array:()=>{{return pJ}},IsTuple:()=>{{return L1}},IsTransform:()=>{{return r}},IsThis:()=>{{return vJ}},IsTemplateLiteral:()=>{{return X1}},IsSymbol:()=>{{return dJ}},IsString:()=>{{return a8}},IsSchema:()=>{{return k}},IsRegExp:()=>{{return U6}},IsRef:()=>{{return B6}},IsRecursive:()=>{{return $Y}},IsRecord:()=>{{return q6}},IsReadonly:()=>{{return e6}},IsProperties:()=>{{return $X}},IsPromise:()=>{{return L8}},IsOptional:()=>{{return I1}},IsObject:()=>{{return j0}},IsNumber:()=>{{return O8}},IsNull:()=>{{return yJ}},IsNot:()=>{{return fJ}},IsNever:()=>{{return K8}},IsMappedResult:()=>{{return G0}},IsMappedKey:()=>{{return $1}},IsLiteralValue:()=>{{return TJ}},IsLiteralString:()=>{{return xJ}},IsLiteralNumber:()=>{{return gJ}},IsLiteralBoolean:()=>{{return eZ}},IsLiteral:()=>{{return B1}},IsKindOf:()=>{{return c}},IsKind:()=>{{return cJ}},IsIterator:()=>{{return r8}},IsIntersect:()=>{{return C0}},IsInteger:()=>{{return D8}},IsFunction:()=>{{return s8}},IsDate:()=>{{return kJ}},IsConstructor:()=>{{return t8}},IsBoolean:()=>{{return z6}},IsBigInt:()=>{{return Y6}},IsAsyncIterator:()=>{{return n8}},IsArray:()=>{{return u1}},IsAny:()=>{{return IJ}}});var KJ=function($){try{return new RegExp($),!0}catch{return!1}},r6=function($){if(!N0($))return!1;for(let X=0;X<$.length;X++){const J=$.charCodeAt(X);if(J>=7&&J<=13||J===27||J===127)return!1}return!0},VJ=function($){return a6($)||k($)},S$=function($){return D0($)||H$($)},B0=function($){return D0($)||m1($)},a6=function($){return D0($)||R8($)},W0=function($){return D0($)||N0($)},rZ=function($){return D0($)||N0($)&&r6($)&&KJ($)},aZ=function($){return D0($)||N0($)&&r6($)},EJ=function($){return D0($)||k($)};function e6($){return R0($)&&$[N8]==="Readonly"}function I1($){return R0($)&&$[a0]==="Optional"}function IJ($){return c($,"Any")&&W0($.$id)}function u1($){return c($,"Array")&&$.type==="array"&&W0($.$id)&&k($.items)&&B0($.minItems)&&B0($.maxItems)&&a6($.uniqueItems)&&EJ($.contains)&&B0($.minContains)&&B0($.maxContains)}function n8($){return c($,"AsyncIterator")&&$.type==="AsyncIterator"&&W0($.$id)&&k($.items)}function Y6($){return c($,"BigInt")&&$.type==="bigint"&&W0($.$id)&&S$($.exclusiveMaximum)&&S$($.exclusiveMinimum)&&S$($.maximum)&&S$($.minimum)&&S$($.multipleOf)}function z6($){return c($,"Boolean")&&$.type==="boolean"&&W0($.$id)}function t8($){return c($,"Constructor")&&$.type==="Constructor"&&W0($.$id)&&e0($.parameters)&&$.parameters.every((X)=>k(X))&&k($.returns)}function kJ($){return c($,"Date")&&$.type==="Date"&&W0($.$id)&&B0($.exclusiveMaximumTimestamp)&&B0($.exclusiveMinimumTimestamp)&&B0($.maximumTimestamp)&&B0($.minimumTimestamp)&&B0($.multipleOfTimestamp)}function s8($){return c($,"Function")&&$.type==="Function"&&W0($.$id)&&e0($.parameters)&&$.parameters.every((X)=>k(X))&&k($.returns)}function D8($){return c($,"Integer")&&$.type==="integer"&&W0($.$id)&&B0($.exclusiveMaximum)&&B0($.exclusiveMinimum)&&B0($.maximum)&&B0($.minimum)&&B0($.multipleOf)}function $X($){return R0($)&&Object.entries($).every(([X,J])=>r6(X)&&k(J))}function C0($){return c($,"Intersect")&&(N0($.type)&&$.type!=="object"?!1:!0)&&e0($.allOf)&&$.allOf.every((X)=>k(X)&&!r(X))&&W0($.type)&&(a6($.unevaluatedProperties)||EJ($.unevaluatedProperties))&&W0($.$id)}function r8($){return c($,"Iterator")&&$.type==="Iterator"&&W0($.$id)&&k($.items)}function c($,X){return R0($)&&D in $&&$[D]===X}function xJ($){return B1($)&&N0($.const)}function gJ($){return B1($)&&m1($.const)}function eZ($){return B1($)&&R8($.const)}function B1($){return c($,"Literal")&&W0($.$id)&&TJ($.const)}function TJ($){return R8($)||m1($)||N0($)}function $1($){return c($,"MappedKey")&&e0($.keys)&&$.keys.every((X)=>m1(X)||N0(X))}function G0($){return c($,"MappedResult")&&$X($.properties)}function K8($){return c($,"Never")&&R0($.not)&&Object.getOwnPropertyNames($.not).length===0}function fJ($){return c($,"Not")&&k($.not)}function yJ($){return c($,"Null")&&$.type==="null"&&W0($.$id)}function O8($){return c($,"Number")&&$.type==="number"&&W0($.$id)&&B0($.exclusiveMaximum)&&B0($.exclusiveMinimum)&&B0($.maximum)&&B0($.minimum)&&B0($.multipleOf)}function j0($){return c($,"Object")&&$.type==="object"&&W0($.$id)&&$X($.properties)&&VJ($.additionalProperties)&&B0($.minProperties)&&B0($.maxProperties)}function L8($){return c($,"Promise")&&$.type==="Promise"&&W0($.$id)&&k($.item)}function q6($){return c($,"Record")&&$.type==="object"&&W0($.$id)&&VJ($.additionalProperties)&&R0($.patternProperties)&&((X)=>{const J=Object.getOwnPropertyNames(X.patternProperties);return J.length===1&&KJ(J[0])&&R0(X.patternProperties)&&k(X.patternProperties[J[0]])})($)}function $Y($){return R0($)&&O1 in $&&$[O1]==="Recursive"}function B6($){return c($,"Ref")&&W0($.$id)&&N0($.$ref)}function U6($){return c($,"RegExp")&&W0($.$id)&&N0($.source)&&N0($.flags)&&B0($.maxLength)&&B0($.minLength)}function a8($){return c($,"String")&&$.type==="string"&&W0($.$id)&&B0($.minLength)&&B0($.maxLength)&&rZ($.pattern)&&aZ($.format)}function dJ($){return c($,"Symbol")&&$.type==="symbol"&&W0($.$id)}function X1($){return c($,"TemplateLiteral")&&$.type==="string"&&N0($.pattern)&&$.pattern[0]==="^"&&$.pattern[$.pattern.length-1]==="$"}function vJ($){return c($,"This")&&W0($.$id)&&N0($.$ref)}function r($){return R0($)&&E0 in $}function L1($){return c($,"Tuple")&&$.type==="array"&&W0($.$id)&&m1($.minItems)&&m1($.maxItems)&&$.minItems===$.maxItems&&(D0($.items)&&D0($.additionalItems)&&$.minItems===0||e0($.items)&&$.items.every((X)=>k(X)))}function hJ($){return c($,"Undefined")&&$.type==="undefined"&&W0($.$id)}function XY($){return o($)&&$.anyOf.every((X)=>xJ(X)||gJ(X))}function o($){return c($,"Union")&&W0($.$id)&&R0($)&&e0($.anyOf)&&$.anyOf.every((X)=>k(X))}function pJ($){return c($,"Uint8Array")&&$.type==="Uint8Array"&&W0($.$id)&&B0($.minByteLength)&&B0($.maxByteLength)}function mJ($){return c($,"Unknown")&&W0($.$id)}function uJ($){return c($,"Unsafe")}function iJ($){return c($,"Void")&&$.type==="void"&&W0($.$id)}function cJ($){return R0($)&&D in $&&N0($[D])&&!sZ.includes($[D])}function k($){return R0($)&&(IJ($)||u1($)||z6($)||Y6($)||n8($)||t8($)||kJ($)||s8($)||D8($)||C0($)||r8($)||B1($)||$1($)||G0($)||K8($)||fJ($)||yJ($)||O8($)||j0($)||L8($)||q6($)||B6($)||U6($)||a8($)||dJ($)||X1($)||vJ($)||L1($)||hJ($)||o($)||pJ($)||mJ($)||uJ($)||iJ($)||cJ($))}class jJ extends d{}var sZ=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];var JY=function($){return P0(S($),[a0])},QY=function($){return{...S($),[a0]:"Optional"}},WY=function($,X){return X===!1?JY($):QY($)};function l0($,X){const J=X??!0;return G0($)?oJ($,J):WY($,J)}var ZY=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:l0($[Q],X)}},{})},YY=function($,X){return ZY($.properties,X)};function oJ($,X){const J=YY($,X);return n(J)}function _$($,X){const J=$.every((W)=>j0(W)),Q=k(X.unevaluatedProperties)?{unevaluatedProperties:S(X.unevaluatedProperties)}:{};return X.unevaluatedProperties===!1||k(X.unevaluatedProperties)||J?{...X,...Q,[D]:"Intersect",type:"object",allOf:I0($)}:{...X,...Q,[D]:"Intersect",allOf:I0($)}}var zY=function($){return $.every((X)=>I1(X))},qY=function($){return P0($,[a0])},lJ=function($){return $.map((X)=>I1(X)?qY(X):X)},BY=function($,X){return zY($)?l0(_$(lJ($),X)):_$(lJ($),X)};function w6($,X={}){if($.length===0)return $0(X);if($.length===1)return S($[0],X);if($.some((J)=>r(J)))throw new Error("Cannot intersect transform types");return BY($,X)}function n0($,X={}){if($.length===0)return $0(X);if($.length===1)return S($[0],X);if($.some((J)=>r(J)))throw new Error("Cannot intersect transform types");return _$($,X)}function P$($,X){return{...X,[D]:"Union",anyOf:I0($)}}var UY=function($){return $.some((X)=>I1(X))},nJ=function($){return $.map((X)=>I1(X)?wY(X):X)},wY=function($){return P0($,[a0])},GY=function($,X){return UY($)?l0(P$(nJ($),X)):P$(nJ($),X)};function i1($,X={}){return $.length===0?$0(X):$.length===1?S($[0],X):GY($,X)}function X0($,X={}){return $.length===0?$0(X):$.length===1?S($[0],X):P$($,X)}var MY=function($){return $.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")},JX=function($,X,J){return $[X]===J&&$.charCodeAt(X-1)!==92},Y8=function($,X){return JX($,X,"(")},C$=function($,X){return JX($,X,")")},tJ=function($,X){return JX($,X,"|")},AY=function($){if(!(Y8($,0)&&C$($,$.length-1)))return!1;let X=0;for(let J=0;J<$.length;J++){if(Y8($,J))X+=1;if(C$($,J))X-=1;if(X===0&&J!==$.length-1)return!1}return!0},HY=function($){return $.slice(1,$.length-1)},NY=function($){let X=0;for(let J=0;J<$.length;J++){if(Y8($,J))X+=1;if(C$($,J))X-=1;if(tJ($,J)&&X===0)return!0}return!1},DY=function($){for(let X=0;X<$.length;X++)if(Y8($,X))return!0;return!1},OY=function($){let[X,J]=[0,0];const Q=[];for(let Z=0;Z<$.length;Z++){if(Y8($,Z))X+=1;if(C$($,Z))X-=1;if(tJ($,Z)&&X===0){const Y=$.slice(J,Z);if(Y.length>0)Q.push(e8(Y));J=Z+1}}const W=$.slice(J);if(W.length>0)Q.push(e8(W));if(Q.length===0)return{type:"const",const:""};if(Q.length===1)return Q[0];return{type:"or",expr:Q}},LY=function($){function X(W,Z){if(!Y8(W,Z))throw new XX("TemplateLiteralParser: Index must point to open parens");let Y=0;for(let z=Z;z<W.length;z++){if(Y8(W,z))Y+=1;if(C$(W,z))Y-=1;if(Y===0)return[Z,z]}throw new XX("TemplateLiteralParser: Unclosed group parens in expression")}function J(W,Z){for(let Y=Z;Y<W.length;Y++)if(Y8(W,Y))return[Z,Y];return[Z,W.length]}const Q=[];for(let W=0;W<$.length;W++)if(Y8($,W)){const[Z,Y]=X($,W),z=$.slice(Z,Y+1);Q.push(e8(z)),W=Y}else{const[Z,Y]=J($,W),z=$.slice(Z,Y);if(z.length>0)Q.push(e8(z));W=Y-1}return Q.length===0?{type:"const",const:""}:Q.length===1?Q[0]:{type:"and",expr:Q}};function e8($){return AY($)?e8(HY($)):NY($)?OY($):DY($)?LY($):{type:"const",const:MY($)}}function $$($){return e8($.slice(1,$.length-1))}class XX extends d{}var SY=function($){return $.type==="or"&&$.expr.length===2&&$.expr[0].type==="const"&&$.expr[0].const==="0"&&$.expr[1].type==="const"&&$.expr[1].const==="[1-9][0-9]*"},_Y=function($){return $.type==="or"&&$.expr.length===2&&$.expr[0].type==="const"&&$.expr[0].const==="true"&&$.expr[1].type==="const"&&$.expr[1].const==="false"},PY=function($){return $.type==="const"&&$.const===".*"};function V8($){return SY($)||PY($)?!1:_Y($)?!0:$.type==="and"?$.expr.every((X)=>V8(X)):$.type==="or"?$.expr.every((X)=>V8(X)):$.type==="const"?!0:(()=>{throw new sJ("Unknown expression type")})()}function G6($){const X=$$($.pattern);return V8(X)}class sJ extends d{}function*aJ($){if($.length===1)return yield*$[0];for(let X of $[0])for(let J of aJ($.slice(1)))yield`${X}${J}`}function*CY($){return yield*aJ($.expr.map((X)=>[...F$(X)]))}function*FY($){for(let X of $.expr)yield*F$(X)}function*bY($){return yield $.const}function*F$($){return $.type==="and"?yield*CY($):$.type==="or"?yield*FY($):$.type==="const"?yield*bY($):(()=>{throw new rJ("Unknown expression")})()}function X$($){const X=$$($.pattern);return V8(X)?[...F$(X)]:[]}class rJ extends d{}function t($,X={}){return{...X,[D]:"Literal",const:$,type:typeof $}}function b$($={}){return{...$,[D]:"Boolean",type:"boolean"}}function E8($={}){return{...$,[D]:"BigInt",type:"bigint"}}function k1($={}){return{...$,[D]:"Number",type:"number"}}function U1($={}){return{...$,[D]:"String",type:"string"}}function*RY($){const X=$.trim().replace(/"|'/g,"");return X==="boolean"?yield b$():X==="number"?yield k1():X==="bigint"?yield E8():X==="string"?yield U1():yield(()=>{const J=X.split("|").map((Q)=>t(Q.trim()));return J.length===0?$0():J.length===1?J[0]:i1(J)})()}function*jY($){if($[1]!=="{"){const X=t("$"),J=QX($.slice(1));return yield*[X,...J]}for(let X=2;X<$.length;X++)if($[X]==="}"){const J=RY($.slice(2,X)),Q=QX($.slice(X+1));return yield*[...J,...Q]}yield t($)}function*QX($){for(let X=0;X<$.length;X++)if($[X]==="$"){const J=t($.slice(0,X)),Q=jY($.slice(X));return yield*[J,...Q]}yield t($)}function eJ($){return[...QX($)]}var $Q="(true|false)",M6="(0|[1-9][0-9]*)",XQ="(.*)";var z8="^(0|[1-9][0-9]*)$",S8="^(.*)$";var KY=function($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},QQ=function($,X){return X1($)?$.pattern.slice(1,$.pattern.length-1):o($)?`(${$.anyOf.map((J)=>QQ(J,X)).join("|")})`:O8($)?`${X}${M6}`:D8($)?`${X}${M6}`:Y6($)?`${X}${M6}`:a8($)?`${X}${XQ}`:B1($)?`${X}${KY($.const.toString())}`:z6($)?`${X}${$Q}`:(()=>{throw new JQ(`Unexpected Kind '${$[D]}'`)})()};function WX($){return`^${$.map((X)=>QQ(X,"")).join("")}$`}class JQ extends d{}function I8($){const J=X$($).map((Q)=>t(Q));return i1(J)}function R$($,X={}){const J=N0($)?WX(eJ($)):WX($);return{...X,[D]:"TemplateLiteral",type:"string",pattern:J}}var VY=function($){return X$($).map((J)=>J.toString())},EY=function($){return $.reduce((X,J)=>{return[...X,...J1(J)]},[])},IY=function($){return[$.toString()]};function J1($){return[...new Set(X1($)?VY($):o($)?EY($.anyOf):B1($)?IY($.const):O8($)?["[number]"]:D8($)?["[number]"]:[])]}var kY=function($,X,J){return globalThis.Object.getOwnPropertyNames(X).reduce((Q,W)=>{return{...Q,[W]:x1($,J1(X[W]),J)}},{})},xY=function($,X,J){return kY($,X.properties,J)};function WQ($,X,J){const Q=xY($,X,J);return n(Q)}var YQ=function($,X){return $.map((J)=>zQ(J,X))},gY=function($){return $.filter((X)=>!K8(X))},TY=function($,X){return w6(gY(YQ($,X)))},fY=function($){return $.some((X)=>K8(X))?[]:$},yY=function($,X){return i1(fY(YQ($,X)))},dY=function($,X){return X in $?$[X]:X==="[number]"?i1($):$0()},vY=function($,X){return X==="[number]"?$:$0()},hY=function($,X){return X in $?$[X]:$0()};function zQ($,X){return C0($)?TY($.allOf,X):o($)?yY($.anyOf,X):L1($)?dY($.items??[],X):u1($)?vY($.items,X):j0($)?hY($.properties,X):$0()}function ZX($,X){return X.map((J)=>zQ($,J))}var ZQ=function($,X){return i1(ZX($,X))};function x1($,X,J={}){return G0(X)?S(WQ($,X,J)):$1(X)?S(qQ($,X,J)):k(X)?S(ZQ($,J1(X)),J):S(ZQ($,X),J)}var pY=function($,X,J){return{[X]:x1($,[X],J)}},mY=function($,X,J){return X.reduce((Q,W)=>{return{...Q,...pY($,W,J)}},{})},uY=function($,X,J){return mY($,X.keys,J)};function qQ($,X,J){const Q=uY($,X,J);return n(Q)}function j$($,X={}){return{...X,[D]:"Iterator",type:"Iterator",items:S($)}}var iY=function($,X={}){const J=globalThis.Object.getOwnPropertyNames($),Q=J.filter((z)=>I1($[z])),W=J.filter((z)=>!Q.includes(z)),Z=k(X.additionalProperties)?{additionalProperties:S(X.additionalProperties)}:{},Y=J.reduce((z,q)=>({...z,[q]:S($[q])}),{});return W.length>0?{...X,...Z,[D]:"Object",type:"object",properties:Y,required:W}:{...X,...Z,[D]:"Object",type:"object",properties:Y}},Z0=iY;function K$($,X={}){return{...X,[D]:"Promise",type:"Promise",item:S($)}}var cY=function($){return P0(S($),[N8])},oY=function($){return{...S($),[N8]:"Readonly"}},lY=function($,X){return X===!1?cY($):oY($)};function w1($,X){const J=X??!0;return G0($)?BQ($,J):lY($,J)}var nY=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:w1($[Q],X)}},{})},tY=function($,X){return nY($.properties,X)};function BQ($,X){const J=tY($,X);return n(J)}function g1($,X={}){const[J,Q,W]=[!1,$.length,$.length];return $.length>0?{...X,[D]:"Tuple",type:"array",items:I0($),additionalItems:J,minItems:Q,maxItems:W}:{...X,[D]:"Tuple",type:"array",minItems:Q,maxItems:W}}function UQ($,X){return $.includes(X)}function wQ($){return[...new Set($)]}function sY($,X){return $.filter((J)=>X.includes(J))}var rY=function($,X){return $.reduce((J,Q)=>{return sY(J,Q)},X)};function GQ($){return $.length===1?$[0]:$.length>1?rY($.slice(1),$[0]):[]}function MQ($){return $.reduce((X,J)=>[...X,...J],[])}var AQ=function($,X){return $ in X?S1($,X[$]):n(X)},aY=function($){return{[$]:t($)}},eY=function($){return $.reduce((X,J)=>{return{...X,[J]:t(J)}},{})},$9=function($,X){return UQ(X,$)?aY($):eY(X)},X9=function($,X){const J=$9($,X);return AQ($,J)},V$=function($,X){return X.map((J)=>S1($,J))},J9=function($,X){return globalThis.Object.getOwnPropertyNames(X).reduce((J,Q)=>{return{...J,[Q]:S1($,X[Q])}},{})},S1=function($,X){return I1(X)?l0(S1($,P0(X,[a0]))):e6(X)?w1(S1($,P0(X,[N8]))):G0(X)?AQ($,X.properties):$1(X)?X9($,X.keys):t8(X)?L$(V$($,X.parameters),S1($,X.returns)):s8(X)?Z8(V$($,X.parameters),S1($,X.returns)):n8(X)?O$(S1($,X.items)):r8(X)?j$(S1($,X.items)):C0(X)?n0(V$($,X.allOf)):o(X)?X0(V$($,X.anyOf)):L1(X)?g1(V$($,X.items??[])):j0(X)?Z0(J9($,X.properties)):u1(X)?D$(S1($,X.items)):L8(X)?K$(S1($,X.item)):X};function Q9($,X,J={}){return $.reduce((Q,W)=>{return{...Q,[W]:S1(W,X)}},{})}function YX($,X,J={}){const Q=k($)?J1($):$,W=X({[D]:"MappedKey",keys:Q}),Z=Q9(Q,W);return S(Z0(Z),J)}var HQ=function($){return $.reduce((X,J)=>{return[...X,Q1(J)]},[])},W9=function($){const X=HQ($);return MQ(X)},Z9=function($){const X=HQ($);return GQ(X)},Y9=function($){return $.map((X,J)=>J.toString())},z9=function($){return["[number]"]},q9=function($){return globalThis.Object.getOwnPropertyNames($)},B9=function($){if(!zX)return[];return globalThis.Object.getOwnPropertyNames($).map((J)=>{return J[0]==="^"&&J[J.length-1]==="$"?J.slice(1,J.length-1):J})};function Q1($){return C0($)?W9($.allOf):o($)?Z9($.anyOf):L1($)?Y9($.items??[]):u1($)?z9($.items):j0($)?q9($.properties):q6($)?B9($.patternProperties):[]}function q8($){zX=!0;const X=Q1($);return zX=!1,`^(${X.map((Q)=>`(${Q})`).join("|")})\$`}var zX=!1;function U9($){return $.map((X)=>X==="[number]"?k1():t(X))}function E$($,X={}){if(G0($))return NQ($,X);else{const J=Q1($),Q=U9(J),W=i1(Q);return S(W,X)}}var w9=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:E$($[Q],X)}},{})},G9=function($,X){return w9($.properties,X)};function NQ($,X){const J=G9($,X);return n(J)}var M9=function($){return $.allOf.every((X)=>B8(X))},A9=function($){return $.anyOf.some((X)=>B8(X))},H9=function($){return!B8($.not)};function B8($){return $[D]==="Intersect"?M9($):$[D]==="Union"?A9($):$[D]==="Not"?H9($):$[D]==="Undefined"?!0:!1}function N9($){switch($.errorType){case N.ArrayContains:return"Expected array to contain at least one matching value";case N.ArrayMaxContains:return`Expected array to contain no more than ${$.schema.maxContains} matching values`;case N.ArrayMinContains:return`Expected array to contain at least ${$.schema.minContains} matching values`;case N.ArrayMaxItems:return`Expected array length to be less or equal to ${$.schema.maxItems}`;case N.ArrayMinItems:return`Expected array length to be greater or equal to ${$.schema.minItems}`;case N.ArrayUniqueItems:return"Expected array elements to be unique";case N.Array:return"Expected array";case N.AsyncIterator:return"Expected AsyncIterator";case N.BigIntExclusiveMaximum:return`Expected bigint to be less than ${$.schema.exclusiveMaximum}`;case N.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${$.schema.exclusiveMinimum}`;case N.BigIntMaximum:return`Expected bigint to be less or equal to ${$.schema.maximum}`;case N.BigIntMinimum:return`Expected bigint to be greater or equal to ${$.schema.minimum}`;case N.BigIntMultipleOf:return`Expected bigint to be a multiple of ${$.schema.multipleOf}`;case N.BigInt:return"Expected bigint";case N.Boolean:return"Expected boolean";case N.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${$.schema.exclusiveMinimumTimestamp}`;case N.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${$.schema.exclusiveMaximumTimestamp}`;case N.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${$.schema.minimumTimestamp}`;case N.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${$.schema.maximumTimestamp}`;case N.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${$.schema.multipleOfTimestamp}`;case N.Date:return"Expected Date";case N.Function:return"Expected function";case N.IntegerExclusiveMaximum:return`Expected integer to be less than ${$.schema.exclusiveMaximum}`;case N.IntegerExclusiveMinimum:return`Expected integer to be greater than ${$.schema.exclusiveMinimum}`;case N.IntegerMaximum:return`Expected integer to be less or equal to ${$.schema.maximum}`;case N.IntegerMinimum:return`Expected integer to be greater or equal to ${$.schema.minimum}`;case N.IntegerMultipleOf:return`Expected integer to be a multiple of ${$.schema.multipleOf}`;case N.Integer:return"Expected integer";case N.IntersectUnevaluatedProperties:return"Unexpected property";case N.Intersect:return"Expected all values to match";case N.Iterator:return"Expected Iterator";case N.Literal:return`Expected ${typeof $.schema.const==="string"?`'${$.schema.const}'`:$.schema.const}`;case N.Never:return"Never";case N.Not:return"Value should not match";case N.Null:return"Expected null";case N.NumberExclusiveMaximum:return`Expected number to be less than ${$.schema.exclusiveMaximum}`;case N.NumberExclusiveMinimum:return`Expected number to be greater than ${$.schema.exclusiveMinimum}`;case N.NumberMaximum:return`Expected number to be less or equal to ${$.schema.maximum}`;case N.NumberMinimum:return`Expected number to be greater or equal to ${$.schema.minimum}`;case N.NumberMultipleOf:return`Expected number to be a multiple of ${$.schema.multipleOf}`;case N.Number:return"Expected number";case N.Object:return"Expected object";case N.ObjectAdditionalProperties:return"Unexpected property";case N.ObjectMaxProperties:return`Expected object to have no more than ${$.schema.maxProperties} properties`;case N.ObjectMinProperties:return`Expected object to have at least ${$.schema.minProperties} properties`;case N.ObjectRequiredProperty:return"Required property";case N.Promise:return"Expected Promise";case N.RegExp:return"Expected string to match regular expression";case N.StringFormatUnknown:return`Unknown format '${$.schema.format}'`;case N.StringFormat:return`Expected string to match '${$.schema.format}' format`;case N.StringMaxLength:return`Expected string length less or equal to ${$.schema.maxLength}`;case N.StringMinLength:return`Expected string length greater or equal to ${$.schema.minLength}`;case N.StringPattern:return`Expected string to match '${$.schema.pattern}'`;case N.String:return"Expected string";case N.Symbol:return"Expected symbol";case N.TupleLength:return`Expected tuple to have ${$.schema.maxItems||0} elements`;case N.Tuple:return"Expected tuple";case N.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${$.schema.maxByteLength}`;case N.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${$.schema.minByteLength}`;case N.Uint8Array:return"Expected Uint8Array";case N.Undefined:return"Expected undefined";case N.Union:return"Expected union value";case N.Void:return"Expected void";case N.Kind:return`Expected kind '${$.schema[D]}'`;default:return"Unknown error type"}}function DQ(){return D9}var D9=N9;function a($,X){const J=X.findIndex((Q)=>Q.$id===$.$ref);if(J===-1)throw new OQ($);return X[J]}class OQ extends d{schema;constructor($){super(`Unable to dereference schema with \$id '${$.$id}'`);this.schema=$}}function*_9($){const X=$===0?1:Math.ceil(Math.floor(Math.log2($)+1)/8);for(let J=0;J<X;J++)yield $>>8*(X-1-J)&255}var P9=function($){i0(G1.Array);for(let X of $)Q$(X)},C9=function($){i0(G1.Boolean),i0($?1:0)},F9=function($){i0(G1.BigInt),_Q.setBigInt64(0,$);for(let X of PQ)i0(X)},b9=function($){i0(G1.Date),Q$($.getTime())},R9=function($){i0(G1.Null)},j9=function($){i0(G1.Number),_Q.setFloat64(0,$);for(let X of PQ)i0(X)},K9=function($){i0(G1.Object);for(let X of globalThis.Object.keys($).sort())Q$(X),Q$($[X])},V9=function($){i0(G1.String);for(let X=0;X<$.length;X++)for(let J of _9($.charCodeAt(X)))i0(J)},E9=function($){i0(G1.Symbol),Q$($.description)},I9=function($){i0(G1.Uint8Array);for(let X=0;X<$.length;X++)i0($[X])},k9=function($){return i0(G1.Undefined)},Q$=function($){if(y($))return P9($);if(h1($))return C9($);if(d0($))return F9($);if(Y1($))return b9($);if(W8($))return R9($);if(E($))return j9($);if(w0($))return K9($);if(v($))return V9($);if(r0($))return E9($);if(c8($))return I9($);if(H0($))return k9($);throw new LQ($)},i0=function($){J$=J$^S9[$],J$=J$*O9%L9};function _8($){return J$=BigInt("14695981039346656037"),Q$($),J$}class LQ extends d{value;constructor($){super("Unable to hash value");this.value=$}}var G1;(function($){$[$.Undefined=0]="Undefined",$[$.Null=1]="Null",$[$.Boolean=2]="Boolean",$[$.Number=3]="Number",$[$.String=4]="String",$[$.Object=5]="Object",$[$.Array=6]="Array",$[$.Date=7]="Date",$[$.Uint8Array=8]="Uint8Array",$[$.Symbol=9]="Symbol",$[$.BigInt=10]="BigInt"})(G1||(G1={}));var J$=BigInt("14695981039346656037"),[O9,L9]=[BigInt("1099511628211"),BigInt("2")**BigInt("64")],S9=Array.from({length:256}).map(($,X)=>BigInt(X)),SQ=new Float64Array(1),_Q=new DataView(SQ.buffer),PQ=new Uint8Array(SQ.buffer);var U8=function($){return $.replace(/~/g,"~0").replace(/\//g,"~1")},h=function($){return $!==void 0},C=function($,X,J,Q){return{type:$,schema:X,path:J,value:Q,message:DQ()({errorType:$,path:J,schema:X,value:Q})}};function*x9($,X,J,Q){}function*g9($,X,J,Q){if(!y(Q))return yield C(N.Array,$,J,Q);if(h($.minItems)&&!(Q.length>=$.minItems))yield C(N.ArrayMinItems,$,J,Q);if(h($.maxItems)&&!(Q.length<=$.maxItems))yield C(N.ArrayMaxItems,$,J,Q);for(let Y=0;Y<Q.length;Y++)yield*v0($.items,X,`${J}/${Y}`,Q[Y]);if($.uniqueItems===!0&&!function(){const Y=new Set;for(let z of Q){const q=_8(z);if(Y.has(q))return!1;else Y.add(q)}return!0}())yield C(N.ArrayUniqueItems,$,J,Q);if(!(h($.contains)||h($.minContains)||h($.maxContains)))return;const W=h($.contains)?$.contains:$0(),Z=Q.reduce((Y,z,q)=>v0(W,X,`${J}${q}`,z).next().done===!0?Y+1:Y,0);if(Z===0)yield C(N.ArrayContains,$,J,Q);if(E($.minContains)&&Z<$.minContains)yield C(N.ArrayMinContains,$,J,Q);if(E($.maxContains)&&Z>$.maxContains)yield C(N.ArrayMaxContains,$,J,Q)}function*T9($,X,J,Q){if(!X6(Q))yield C(N.AsyncIterator,$,J,Q)}function*f9($,X,J,Q){if(!d0(Q))return yield C(N.BigInt,$,J,Q);if(h($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield C(N.BigIntExclusiveMaximum,$,J,Q);if(h($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield C(N.BigIntExclusiveMinimum,$,J,Q);if(h($.maximum)&&!(Q<=$.maximum))yield C(N.BigIntMaximum,$,J,Q);if(h($.minimum)&&!(Q>=$.minimum))yield C(N.BigIntMinimum,$,J,Q);if(h($.multipleOf)&&Q%$.multipleOf!==BigInt(0))yield C(N.BigIntMultipleOf,$,J,Q)}function*y9($,X,J,Q){if(!h1(Q))yield C(N.Boolean,$,J,Q)}function*d9($,X,J,Q){yield*v0($.returns,X,J,Q.prototype)}function*v9($,X,J,Q){if(!Y1(Q))return yield C(N.Date,$,J,Q);if(h($.exclusiveMaximumTimestamp)&&!(Q.getTime()<$.exclusiveMaximumTimestamp))yield C(N.DateExclusiveMaximumTimestamp,$,J,Q);if(h($.exclusiveMinimumTimestamp)&&!(Q.getTime()>$.exclusiveMinimumTimestamp))yield C(N.DateExclusiveMinimumTimestamp,$,J,Q);if(h($.maximumTimestamp)&&!(Q.getTime()<=$.maximumTimestamp))yield C(N.DateMaximumTimestamp,$,J,Q);if(h($.minimumTimestamp)&&!(Q.getTime()>=$.minimumTimestamp))yield C(N.DateMinimumTimestamp,$,J,Q);if(h($.multipleOfTimestamp)&&Q.getTime()%$.multipleOfTimestamp!==0)yield C(N.DateMultipleOfTimestamp,$,J,Q)}function*h9($,X,J,Q){if(!M$(Q))yield C(N.Function,$,J,Q)}function*p9($,X,J,Q){if(!W6(Q))return yield C(N.Integer,$,J,Q);if(h($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield C(N.IntegerExclusiveMaximum,$,J,Q);if(h($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield C(N.IntegerExclusiveMinimum,$,J,Q);if(h($.maximum)&&!(Q<=$.maximum))yield C(N.IntegerMaximum,$,J,Q);if(h($.minimum)&&!(Q>=$.minimum))yield C(N.IntegerMinimum,$,J,Q);if(h($.multipleOf)&&Q%$.multipleOf!==0)yield C(N.IntegerMultipleOf,$,J,Q)}function*m9($,X,J,Q){for(let W of $.allOf){const Z=v0(W,X,J,Q).next();if(!Z.done)yield C(N.Intersect,$,J,Q),yield Z.value}if($.unevaluatedProperties===!1){const W=new RegExp(q8($));for(let Z of Object.getOwnPropertyNames(Q))if(!W.test(Z))yield C(N.IntersectUnevaluatedProperties,$,`${J}/${Z}`,Q)}if(typeof $.unevaluatedProperties==="object"){const W=new RegExp(q8($));for(let Z of Object.getOwnPropertyNames(Q))if(!W.test(Z)){const Y=v0($.unevaluatedProperties,X,`${J}/${Z}`,Q[Z]).next();if(!Y.done)yield Y.value}}}function*u9($,X,J,Q){if(!J6(Q))yield C(N.Iterator,$,J,Q)}function*i9($,X,J,Q){if(Q!==$.const)yield C(N.Literal,$,J,Q)}function*c9($,X,J,Q){yield C(N.Never,$,J,Q)}function*o9($,X,J,Q){if(v0($.not,X,J,Q).next().done===!0)yield C(N.Not,$,J,Q)}function*l9($,X,J,Q){if(!W8(Q))yield C(N.Null,$,J,Q)}function*n9($,X,J,Q){if(!F0.IsNumberLike(Q))return yield C(N.Number,$,J,Q);if(h($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield C(N.NumberExclusiveMaximum,$,J,Q);if(h($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield C(N.NumberExclusiveMinimum,$,J,Q);if(h($.maximum)&&!(Q<=$.maximum))yield C(N.NumberMaximum,$,J,Q);if(h($.minimum)&&!(Q>=$.minimum))yield C(N.NumberMinimum,$,J,Q);if(h($.multipleOf)&&Q%$.multipleOf!==0)yield C(N.NumberMultipleOf,$,J,Q)}function*t9($,X,J,Q){if(!F0.IsObjectLike(Q))return yield C(N.Object,$,J,Q);if(h($.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=$.minProperties))yield C(N.ObjectMinProperties,$,J,Q);if(h($.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=$.maxProperties))yield C(N.ObjectMaxProperties,$,J,Q);const W=Array.isArray($.required)?$.required:[],Z=Object.getOwnPropertyNames($.properties),Y=Object.getOwnPropertyNames(Q);for(let z of W){if(Y.includes(z))continue;yield C(N.ObjectRequiredProperty,$.properties[z],`${J}/${U8(z)}`,void 0)}if($.additionalProperties===!1){for(let z of Y)if(!Z.includes(z))yield C(N.ObjectAdditionalProperties,$,`${J}/${U8(z)}`,Q[z])}if(typeof $.additionalProperties==="object")for(let z of Y){if(Z.includes(z))continue;yield*v0($.additionalProperties,X,`${J}/${U8(z)}`,Q[z])}for(let z of Z){const q=$.properties[z];if($.required&&$.required.includes(z)){if(yield*v0(q,X,`${J}/${U8(z)}`,Q[z]),B8($)&&!(z in Q))yield C(N.ObjectRequiredProperty,q,`${J}/${U8(z)}`,void 0)}else if(F0.IsExactOptionalProperty(Q,z))yield*v0(q,X,`${J}/${U8(z)}`,Q[z])}}function*s9($,X,J,Q){if(!Q6(Q))yield C(N.Promise,$,J,Q)}function*r9($,X,J,Q){if(!F0.IsRecordLike(Q))return yield C(N.Object,$,J,Q);if(h($.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=$.minProperties))yield C(N.ObjectMinProperties,$,J,Q);if(h($.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=$.maxProperties))yield C(N.ObjectMaxProperties,$,J,Q);const[W,Z]=Object.entries($.patternProperties)[0],Y=new RegExp(W);for(let[z,q]of Object.entries(Q))if(Y.test(z))yield*v0(Z,X,`${J}/${U8(z)}`,q);if(typeof $.additionalProperties==="object"){for(let[z,q]of Object.entries(Q))if(!Y.test(z))yield*v0($.additionalProperties,X,`${J}/${U8(z)}`,q)}if($.additionalProperties===!1)for(let[z,q]of Object.entries(Q)){if(Y.test(z))continue;return yield C(N.ObjectAdditionalProperties,$,`${J}/${U8(z)}`,q)}}function*a9($,X,J,Q){yield*v0(a($,X),X,J,Q)}function*e9($,X,J,Q){if(!v(Q))return yield C(N.String,$,J,Q);if(h($.minLength)&&!(Q.length>=$.minLength))yield C(N.StringMinLength,$,J,Q);if(h($.maxLength)&&!(Q.length<=$.maxLength))yield C(N.StringMaxLength,$,J,Q);if(!new RegExp($.source,$.flags).test(Q))return yield C(N.RegExp,$,J,Q)}function*$7($,X,J,Q){if(!v(Q))return yield C(N.String,$,J,Q);if(h($.minLength)&&!(Q.length>=$.minLength))yield C(N.StringMinLength,$,J,Q);if(h($.maxLength)&&!(Q.length<=$.maxLength))yield C(N.StringMaxLength,$,J,Q);if(v($.pattern)){if(!new RegExp($.pattern).test(Q))yield C(N.StringPattern,$,J,Q)}if(v($.format)){if(!_0.Has($.format))yield C(N.StringFormatUnknown,$,J,Q);else if(!_0.Get($.format)(Q))yield C(N.StringFormat,$,J,Q)}}function*X7($,X,J,Q){if(!r0(Q))yield C(N.Symbol,$,J,Q)}function*J7($,X,J,Q){if(!v(Q))return yield C(N.String,$,J,Q);if(!new RegExp($.pattern).test(Q))yield C(N.StringPattern,$,J,Q)}function*Q7($,X,J,Q){yield*v0(a($,X),X,J,Q)}function*W7($,X,J,Q){if(!y(Q))return yield C(N.Tuple,$,J,Q);if($.items===void 0&&Q.length!==0)return yield C(N.TupleLength,$,J,Q);if(Q.length!==$.maxItems)return yield C(N.TupleLength,$,J,Q);if(!$.items)return;for(let W=0;W<$.items.length;W++)yield*v0($.items[W],X,`${J}/${W}`,Q[W])}function*Z7($,X,J,Q){if(!H0(Q))yield C(N.Undefined,$,J,Q)}function*Y7($,X,J,Q){let W=0;for(let Z of $.anyOf){const Y=[...v0(Z,X,J,Q)];if(Y.length===0)return;W+=Y.length}if(W>0)yield C(N.Union,$,J,Q)}function*z7($,X,J,Q){if(!c8(Q))return yield C(N.Uint8Array,$,J,Q);if(h($.maxByteLength)&&!(Q.length<=$.maxByteLength))yield C(N.Uint8ArrayMaxByteLength,$,J,Q);if(h($.minByteLength)&&!(Q.length>=$.minByteLength))yield C(N.Uint8ArrayMinByteLength,$,J,Q)}function*q7($,X,J,Q){}function*B7($,X,J,Q){if(!F0.IsVoidLike(Q))yield C(N.Void,$,J,Q)}function*U7($,X,J,Q){if(!b0.Get($[D])($,Q))yield C(N.Kind,$,J,Q)}function*v0($,X,J,Q){const W=h($.$id)?[...X,$]:X,Z=$;switch(Z[D]){case"Any":return yield*x9(Z,W,J,Q);case"Array":return yield*g9(Z,W,J,Q);case"AsyncIterator":return yield*T9(Z,W,J,Q);case"BigInt":return yield*f9(Z,W,J,Q);case"Boolean":return yield*y9(Z,W,J,Q);case"Constructor":return yield*d9(Z,W,J,Q);case"Date":return yield*v9(Z,W,J,Q);case"Function":return yield*h9(Z,W,J,Q);case"Integer":return yield*p9(Z,W,J,Q);case"Intersect":return yield*m9(Z,W,J,Q);case"Iterator":return yield*u9(Z,W,J,Q);case"Literal":return yield*i9(Z,W,J,Q);case"Never":return yield*c9(Z,W,J,Q);case"Not":return yield*o9(Z,W,J,Q);case"Null":return yield*l9(Z,W,J,Q);case"Number":return yield*n9(Z,W,J,Q);case"Object":return yield*t9(Z,W,J,Q);case"Promise":return yield*s9(Z,W,J,Q);case"Record":return yield*r9(Z,W,J,Q);case"Ref":return yield*a9(Z,W,J,Q);case"RegExp":return yield*e9(Z,W,J,Q);case"String":return yield*$7(Z,W,J,Q);case"Symbol":return yield*X7(Z,W,J,Q);case"TemplateLiteral":return yield*J7(Z,W,J,Q);case"This":return yield*Q7(Z,W,J,Q);case"Tuple":return yield*W7(Z,W,J,Q);case"Undefined":return yield*Z7(Z,W,J,Q);case"Union":return yield*Y7(Z,W,J,Q);case"Uint8Array":return yield*z7(Z,W,J,Q);case"Unknown":return yield*q7(Z,W,J,Q);case"Void":return yield*B7(Z,W,J,Q);default:if(!b0.Has(Z[D]))throw new CQ($);return yield*U7(Z,W,J,Q)}}function I$(...$){const X=$.length===3?v0($[0],$[1],"",$[2]):v0($[0],[],"",$[1]);return new A6(X)}var N;(function($){$[$.ArrayContains=0]="ArrayContains",$[$.ArrayMaxContains=1]="ArrayMaxContains",$[$.ArrayMaxItems=2]="ArrayMaxItems",$[$.ArrayMinContains=3]="ArrayMinContains",$[$.ArrayMinItems=4]="ArrayMinItems",$[$.ArrayUniqueItems=5]="ArrayUniqueItems",$[$.Array=6]="Array",$[$.AsyncIterator=7]="AsyncIterator",$[$.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",$[$.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",$[$.BigIntMaximum=10]="BigIntMaximum",$[$.BigIntMinimum=11]="BigIntMinimum",$[$.BigIntMultipleOf=12]="BigIntMultipleOf",$[$.BigInt=13]="BigInt",$[$.Boolean=14]="Boolean",$[$.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",$[$.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",$[$.DateMaximumTimestamp=17]="DateMaximumTimestamp",$[$.DateMinimumTimestamp=18]="DateMinimumTimestamp",$[$.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",$[$.Date=20]="Date",$[$.Function=21]="Function",$[$.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",$[$.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",$[$.IntegerMaximum=24]="IntegerMaximum",$[$.IntegerMinimum=25]="IntegerMinimum",$[$.IntegerMultipleOf=26]="IntegerMultipleOf",$[$.Integer=27]="Integer",$[$.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",$[$.Intersect=29]="Intersect",$[$.Iterator=30]="Iterator",$[$.Kind=31]="Kind",$[$.Literal=32]="Literal",$[$.Never=33]="Never",$[$.Not=34]="Not",$[$.Null=35]="Null",$[$.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",$[$.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",$[$.NumberMaximum=38]="NumberMaximum",$[$.NumberMinimum=39]="NumberMinimum",$[$.NumberMultipleOf=40]="NumberMultipleOf",$[$.Number=41]="Number",$[$.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",$[$.ObjectMaxProperties=43]="ObjectMaxProperties",$[$.ObjectMinProperties=44]="ObjectMinProperties",$[$.ObjectRequiredProperty=45]="ObjectRequiredProperty",$[$.Object=46]="Object",$[$.Promise=47]="Promise",$[$.RegExp=48]="RegExp",$[$.StringFormatUnknown=49]="StringFormatUnknown",$[$.StringFormat=50]="StringFormat",$[$.StringMaxLength=51]="StringMaxLength",$[$.StringMinLength=52]="StringMinLength",$[$.StringPattern=53]="StringPattern",$[$.String=54]="String",$[$.Symbol=55]="Symbol",$[$.TupleLength=56]="TupleLength",$[$.Tuple=57]="Tuple",$[$.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",$[$.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",$[$.Uint8Array=60]="Uint8Array",$[$.Undefined=61]="Undefined",$[$.Union=62]="Union",$[$.Void=63]="Void"})(N||(N={}));class CQ extends d{schema;constructor($){super("Unknown type");this.schema=$}}class A6{iterator;constructor($){this.iterator=$}[Symbol.iterator](){return this.iterator}First(){const $=this.iterator.next();return $.done?void 0:$.value}}function w8($={}){return{...$,[D]:"Any"}}function c1($={}){return{...$,[D]:"Unknown"}}var _1=function($){return $===O.False?$:O.True},W$=function($){throw new KQ($)},K0=function($){return w.IsNever($)||w.IsIntersect($)||w.IsUnion($)||w.IsUnknown($)||w.IsAny($)},V0=function($,X){return w.IsNever(X)?IQ($,X):w.IsIntersect(X)?H6($,X):w.IsUnion(X)?GX($,X):w.IsUnknown(X)?TQ($,X):w.IsAny(X)?wX($,X):W$("StructuralRight")},wX=function($,X){return O.True},w7=function($,X){return w.IsIntersect(X)?H6($,X):w.IsUnion(X)&&X.anyOf.some((J)=>w.IsAny(J)||w.IsUnknown(J))?O.True:w.IsUnion(X)?O.Union:w.IsUnknown(X)?O.True:w.IsAny(X)?O.True:O.Union},G7=function($,X){return w.IsUnknown($)?O.False:w.IsAny($)?O.Union:w.IsNever($)?O.True:O.False},M7=function($,X){return w.IsObject(X)&&N6(X)?O.True:K0(X)?V0($,X):!w.IsArray(X)?O.False:_1(Y0($.items,X.items))},A7=function($,X){return K0(X)?V0($,X):!w.IsAsyncIterator(X)?O.False:_1(Y0($.items,X.items))},H7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsBigInt(X)?O.True:O.False},VQ=function($,X){return w.IsLiteralBoolean($)?O.True:w.IsBoolean($)?O.True:O.False},N7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsBoolean(X)?O.True:O.False},D7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):!w.IsConstructor(X)?O.False:$.parameters.length>X.parameters.length?O.False:!$.parameters.every((J,Q)=>_1(Y0(X.parameters[Q],J))===O.True)?O.False:_1(Y0($.returns,X.returns))},O7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsDate(X)?O.True:O.False},L7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):!w.IsFunction(X)?O.False:$.parameters.length>X.parameters.length?O.False:!$.parameters.every((J,Q)=>_1(Y0(X.parameters[Q],J))===O.True)?O.False:_1(Y0($.returns,X.returns))},EQ=function($,X){return w.IsLiteral($)&&q1.IsNumber($.const)?O.True:w.IsNumber($)||w.IsInteger($)?O.True:O.False},S7=function($,X){return w.IsInteger(X)||w.IsNumber(X)?O.True:K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):O.False},H6=function($,X){return X.allOf.every((J)=>Y0($,J)===O.True)?O.True:O.False},_7=function($,X){return $.allOf.some((J)=>Y0(J,X)===O.True)?O.True:O.False},P7=function($,X){return K0(X)?V0($,X):!w.IsIterator(X)?O.False:_1(Y0($.items,X.items))},C7=function($,X){return w.IsLiteral(X)&&X.const===$.const?O.True:K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsString(X)?gQ($,X):w.IsNumber(X)?kQ($,X):w.IsInteger(X)?EQ($,X):w.IsBoolean(X)?VQ($,X):O.False},IQ=function($,X){return O.False},F7=function($,X){return O.True},FQ=function($){let[X,J]=[$,0];while(!0){if(!w.IsNot(X))break;X=X.not,J+=1}return J%2===0?X:c1()},b7=function($,X){return w.IsNot($)?Y0(FQ($),X):w.IsNot(X)?Y0($,FQ(X)):W$("Invalid fallthrough for Not")},R7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsNull(X)?O.True:O.False},kQ=function($,X){return w.IsLiteralNumber($)?O.True:w.IsNumber($)||w.IsInteger($)?O.True:O.False},j7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsInteger(X)||w.IsNumber(X)?O.True:O.False},W1=function($,X){return Object.getOwnPropertyNames($.properties).length===X},bQ=function($){return N6($)},RQ=function($){return W1($,0)||W1($,1)&&"description"in $.properties&&w.IsUnion($.properties.description)&&$.properties.description.anyOf.length===2&&(w.IsString($.properties.description.anyOf[0])&&w.IsUndefined($.properties.description.anyOf[1])||w.IsString($.properties.description.anyOf[1])&&w.IsUndefined($.properties.description.anyOf[0]))},qX=function($){return W1($,0)},jQ=function($){return W1($,0)},K7=function($){return W1($,0)},V7=function($){return W1($,0)},E7=function($){return N6($)},I7=function($){const X=k1();return W1($,0)||W1($,1)&&"length"in $.properties&&_1(Y0($.properties.length,X))===O.True},k7=function($){return W1($,0)},N6=function($){const X=k1();return W1($,0)||W1($,1)&&"length"in $.properties&&_1(Y0($.properties.length,X))===O.True},x7=function($){const X=Z8([w8()],w8());return W1($,0)||W1($,1)&&"then"in $.properties&&_1(Y0($.properties.then,X))===O.True},xQ=function($,X){return Y0($,X)===O.False?O.False:w.IsOptional($)&&!w.IsOptional(X)?O.False:O.True},c0=function($,X){return w.IsUnknown($)?O.False:w.IsAny($)?O.Union:w.IsNever($)||w.IsLiteralString($)&&bQ(X)||w.IsLiteralNumber($)&&qX(X)||w.IsLiteralBoolean($)&&jQ(X)||w.IsSymbol($)&&RQ(X)||w.IsBigInt($)&&K7(X)||w.IsString($)&&bQ(X)||w.IsSymbol($)&&RQ(X)||w.IsNumber($)&&qX(X)||w.IsInteger($)&&qX(X)||w.IsBoolean($)&&jQ(X)||w.IsUint8Array($)&&E7(X)||w.IsDate($)&&V7(X)||w.IsConstructor($)&&k7(X)||w.IsFunction($)&&I7(X)?O.True:w.IsRecord($)&&w.IsString(BX($))?(()=>{return X[O1]==="Record"?O.True:O.False})():w.IsRecord($)&&w.IsNumber(BX($))?(()=>{return W1(X,0)?O.True:O.False})():O.False},g7=function($,X){return K0(X)?V0($,X):w.IsRecord(X)?P1($,X):!w.IsObject(X)?O.False:(()=>{for(let J of Object.getOwnPropertyNames(X.properties)){if(!(J in $.properties)&&!w.IsOptional(X.properties[J]))return O.False;if(w.IsOptional(X.properties[J]))return O.True;if(xQ($.properties[J],X.properties[J])===O.False)return O.False}return O.True})()},T7=function($,X){return K0(X)?V0($,X):w.IsObject(X)&&x7(X)?O.True:!w.IsPromise(X)?O.False:_1(Y0($.item,X.item))},BX=function($){return z8 in $.patternProperties?k1():(S8 in $.patternProperties)?U1():W$("Unknown record key pattern")},UX=function($){return z8 in $.patternProperties?$.patternProperties[z8]:(S8 in $.patternProperties)?$.patternProperties[S8]:W$("Unable to get record value schema")},P1=function($,X){const[J,Q]=[BX(X),UX(X)];return w.IsLiteralString($)&&w.IsNumber(J)&&_1(Y0($,Q))===O.True?O.True:w.IsUint8Array($)&&w.IsNumber(J)?Y0($,Q):w.IsString($)&&w.IsNumber(J)?Y0($,Q):w.IsArray($)&&w.IsNumber(J)?Y0($,Q):w.IsObject($)?(()=>{for(let W of Object.getOwnPropertyNames($.properties))if(xQ(Q,$.properties[W])===O.False)return O.False;return O.True})():O.False},f7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):!w.IsRecord(X)?O.False:Y0(UX($),UX(X))},y7=function($,X){const J=w.IsRegExp($)?U1():$,Q=w.IsRegExp(X)?U1():X;return Y0(J,Q)},gQ=function($,X){return w.IsLiteral($)&&q1.IsString($.const)?O.True:w.IsString($)?O.True:O.False},d7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsString(X)?O.True:O.False},v7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsSymbol(X)?O.True:O.False},h7=function($,X){return w.IsTemplateLiteral($)?Y0(I8($),X):w.IsTemplateLiteral(X)?Y0($,I8(X)):W$("Invalid fallthrough for TemplateLiteral")},p7=function($,X){return w.IsArray(X)&&$.items!==void 0&&$.items.every((J)=>Y0(J,X.items)===O.True)},m7=function($,X){return w.IsNever($)?O.True:w.IsUnknown($)?O.False:w.IsAny($)?O.Union:O.False},u7=function($,X){return K0(X)?V0($,X):w.IsObject(X)&&N6(X)?O.True:w.IsArray(X)&&p7($,X)?O.True:!w.IsTuple(X)?O.False:q1.IsUndefined($.items)&&!q1.IsUndefined(X.items)||!q1.IsUndefined($.items)&&q1.IsUndefined(X.items)?O.False:q1.IsUndefined($.items)&&!q1.IsUndefined(X.items)?O.True:$.items.every((J,Q)=>Y0(J,X.items[Q])===O.True)?O.True:O.False},i7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsUint8Array(X)?O.True:O.False},c7=function($,X){return K0(X)?V0($,X):w.IsObject(X)?c0($,X):w.IsRecord(X)?P1($,X):w.IsVoid(X)?n7($,X):w.IsUndefined(X)?O.True:O.False},GX=function($,X){return X.anyOf.some((J)=>Y0($,J)===O.True)?O.True:O.False},o7=function($,X){return $.anyOf.every((J)=>Y0(J,X)===O.True)?O.True:O.False},TQ=function($,X){return O.True},l7=function($,X){return w.IsNever(X)?IQ($,X):w.IsIntersect(X)?H6($,X):w.IsUnion(X)?GX($,X):w.IsAny(X)?wX($,X):w.IsString(X)?gQ($,X):w.IsNumber(X)?kQ($,X):w.IsInteger(X)?EQ($,X):w.IsBoolean(X)?VQ($,X):w.IsArray(X)?G7($,X):w.IsTuple(X)?m7($,X):w.IsObject(X)?c0($,X):w.IsUnknown(X)?O.True:O.False},n7=function($,X){return w.IsUndefined($)?O.True:w.IsUndefined($)?O.True:O.False},t7=function($,X){return w.IsIntersect(X)?H6($,X):w.IsUnion(X)?GX($,X):w.IsUnknown(X)?TQ($,X):w.IsAny(X)?wX($,X):w.IsObject(X)?c0($,X):w.IsVoid(X)?O.True:O.False},Y0=function($,X){return w.IsTemplateLiteral($)||w.IsTemplateLiteral(X)?h7($,X):w.IsRegExp($)||w.IsRegExp(X)?y7($,X):w.IsNot($)||w.IsNot(X)?b7($,X):w.IsAny($)?w7($,X):w.IsArray($)?M7($,X):w.IsBigInt($)?H7($,X):w.IsBoolean($)?N7($,X):w.IsAsyncIterator($)?A7($,X):w.IsConstructor($)?D7($,X):w.IsDate($)?O7($,X):w.IsFunction($)?L7($,X):w.IsInteger($)?S7($,X):w.IsIntersect($)?_7($,X):w.IsIterator($)?P7($,X):w.IsLiteral($)?C7($,X):w.IsNever($)?F7($,X):w.IsNull($)?R7($,X):w.IsNumber($)?j7($,X):w.IsObject($)?g7($,X):w.IsRecord($)?f7($,X):w.IsString($)?d7($,X):w.IsSymbol($)?v7($,X):w.IsTuple($)?u7($,X):w.IsPromise($)?T7($,X):w.IsUint8Array($)?i7($,X):w.IsUndefined($)?c7($,X):w.IsUnion($)?o7($,X):w.IsUnknown($)?l7($,X):w.IsVoid($)?t7($,X):W$(`Unknown left type operand '${$[D]}'`)};function P8($,X){return Y0($,X)}class KQ extends d{}var O;(function($){$[$.Union=0]="Union",$[$.True=1]="True",$[$.False=2]="False"})(O||(O={}));var s7=function($,X,J,Q,W){return globalThis.Object.getOwnPropertyNames($).reduce((Z,Y)=>{return{...Z,[Y]:k8($[Y],X,J,Q,W)}},{})},r7=function($,X,J,Q,W){return s7($.properties,X,J,Q,W)};function fQ($,X,J,Q,W){const Z=r7($,X,J,Q,W);return n(Z)}var a7=function($,X,J,Q){const W=P8($,X);return W===O.Union?X0([J,Q]):W===O.True?J:Q};function k8($,X,J,Q,W={}){return G0($)?fQ($,X,J,Q,W):$1($)?S(yQ($,X,J,Q,W)):S(a7($,X,J,Q),W)}var e7=function($,X,J,Q,W){return{[$]:k8(t($),X,J,Q,W)}},$2=function($,X,J,Q,W){return $.reduce((Z,Y)=>{return{...Z,...e7(Y,X,J,Q,W)}},{})},X2=function($,X,J,Q,W){return $2($.keys,X,J,Q,W)};function yQ($,X,J,Q,W){const Z=X2($,X,J,Q,W);return n(Z)}var J2=function($){return $[D]==="Any"||$[D]==="Unknown"},p=function($){return $!==void 0},Q2=function($,X,J){return!0},W2=function($,X,J){if(!y(J))return!1;if(p($.minItems)&&!(J.length>=$.minItems))return!1;if(p($.maxItems)&&!(J.length<=$.maxItems))return!1;if(!J.every((Z)=>h0($.items,X,Z)))return!1;if($.uniqueItems===!0&&!function(){const Z=new Set;for(let Y of J){const z=_8(Y);if(Z.has(z))return!1;else Z.add(z)}return!0}())return!1;if(!(p($.contains)||E($.minContains)||E($.maxContains)))return!0;const Q=p($.contains)?$.contains:$0(),W=J.reduce((Z,Y)=>h0(Q,X,Y)?Z+1:Z,0);if(W===0)return!1;if(E($.minContains)&&W<$.minContains)return!1;if(E($.maxContains)&&W>$.maxContains)return!1;return!0},Z2=function($,X,J){return X6(J)},Y2=function($,X,J){if(!d0(J))return!1;if(p($.exclusiveMaximum)&&!(J<$.exclusiveMaximum))return!1;if(p($.exclusiveMinimum)&&!(J>$.exclusiveMinimum))return!1;if(p($.maximum)&&!(J<=$.maximum))return!1;if(p($.minimum)&&!(J>=$.minimum))return!1;if(p($.multipleOf)&&J%$.multipleOf!==BigInt(0))return!1;return!0},z2=function($,X,J){return h1(J)},q2=function($,X,J){return h0($.returns,X,J.prototype)},B2=function($,X,J){if(!Y1(J))return!1;if(p($.exclusiveMaximumTimestamp)&&!(J.getTime()<$.exclusiveMaximumTimestamp))return!1;if(p($.exclusiveMinimumTimestamp)&&!(J.getTime()>$.exclusiveMinimumTimestamp))return!1;if(p($.maximumTimestamp)&&!(J.getTime()<=$.maximumTimestamp))return!1;if(p($.minimumTimestamp)&&!(J.getTime()>=$.minimumTimestamp))return!1;if(p($.multipleOfTimestamp)&&J.getTime()%$.multipleOfTimestamp!==0)return!1;return!0},U2=function($,X,J){return M$(J)},w2=function($,X,J){if(!W6(J))return!1;if(p($.exclusiveMaximum)&&!(J<$.exclusiveMaximum))return!1;if(p($.exclusiveMinimum)&&!(J>$.exclusiveMinimum))return!1;if(p($.maximum)&&!(J<=$.maximum))return!1;if(p($.minimum)&&!(J>=$.minimum))return!1;if(p($.multipleOf)&&J%$.multipleOf!==0)return!1;return!0},G2=function($,X,J){const Q=$.allOf.every((W)=>h0(W,X,J));if($.unevaluatedProperties===!1){const W=new RegExp(q8($)),Z=Object.getOwnPropertyNames(J).every((Y)=>W.test(Y));return Q&&Z}else if(k($.unevaluatedProperties)){const W=new RegExp(q8($)),Z=Object.getOwnPropertyNames(J).every((Y)=>W.test(Y)||h0($.unevaluatedProperties,X,J[Y]));return Q&&Z}else return Q},M2=function($,X,J){return J6(J)},A2=function($,X,J){return J===$.const},H2=function($,X,J){return!1},N2=function($,X,J){return!h0($.not,X,J)},D2=function($,X,J){return W8(J)},O2=function($,X,J){if(!F0.IsNumberLike(J))return!1;if(p($.exclusiveMaximum)&&!(J<$.exclusiveMaximum))return!1;if(p($.exclusiveMinimum)&&!(J>$.exclusiveMinimum))return!1;if(p($.minimum)&&!(J>=$.minimum))return!1;if(p($.maximum)&&!(J<=$.maximum))return!1;if(p($.multipleOf)&&J%$.multipleOf!==0)return!1;return!0},L2=function($,X,J){if(!F0.IsObjectLike(J))return!1;if(p($.minProperties)&&!(Object.getOwnPropertyNames(J).length>=$.minProperties))return!1;if(p($.maxProperties)&&!(Object.getOwnPropertyNames(J).length<=$.maxProperties))return!1;const Q=Object.getOwnPropertyNames($.properties);for(let W of Q){const Z=$.properties[W];if($.required&&$.required.includes(W)){if(!h0(Z,X,J[W]))return!1;if((B8(Z)||J2(Z))&&!(W in J))return!1}else if(F0.IsExactOptionalProperty(J,W)&&!h0(Z,X,J[W]))return!1}if($.additionalProperties===!1){const W=Object.getOwnPropertyNames(J);if($.required&&$.required.length===Q.length&&W.length===Q.length)return!0;else return W.every((Z)=>Q.includes(Z))}else if(typeof $.additionalProperties==="object")return Object.getOwnPropertyNames(J).every((Z)=>Q.includes(Z)||h0($.additionalProperties,X,J[Z]));else return!0},S2=function($,X,J){return Q6(J)},_2=function($,X,J){if(!F0.IsRecordLike(J))return!1;if(p($.minProperties)&&!(Object.getOwnPropertyNames(J).length>=$.minProperties))return!1;if(p($.maxProperties)&&!(Object.getOwnPropertyNames(J).length<=$.maxProperties))return!1;const[Q,W]=Object.entries($.patternProperties)[0],Z=new RegExp(Q),Y=Object.entries(J).every(([G,B])=>{return Z.test(G)?h0(W,X,B):!0}),z=typeof $.additionalProperties==="object"?Object.entries(J).every(([G,B])=>{return!Z.test(G)?h0($.additionalProperties,X,B):!0}):!0,q=$.additionalProperties===!1?Object.getOwnPropertyNames(J).every((G)=>{return Z.test(G)}):!0;return Y&&z&&q},P2=function($,X,J){return h0(a($,X),X,J)},C2=function($,X,J){const Q=new RegExp($.source,$.flags);if(p($.minLength)){if(!(J.length>=$.minLength))return!1}if(p($.maxLength)){if(!(J.length<=$.maxLength))return!1}return Q.test(J)},F2=function($,X,J){if(!v(J))return!1;if(p($.minLength)){if(!(J.length>=$.minLength))return!1}if(p($.maxLength)){if(!(J.length<=$.maxLength))return!1}if(p($.pattern)){if(!new RegExp($.pattern).test(J))return!1}if(p($.format)){if(!_0.Has($.format))return!1;return _0.Get($.format)(J)}return!0},b2=function($,X,J){return r0(J)},R2=function($,X,J){return v(J)&&new RegExp($.pattern).test(J)},j2=function($,X,J){return h0(a($,X),X,J)},K2=function($,X,J){if(!y(J))return!1;if($.items===void 0&&J.length!==0)return!1;if(J.length!==$.maxItems)return!1;if(!$.items)return!0;for(let Q=0;Q<$.items.length;Q++)if(!h0($.items[Q],X,J[Q]))return!1;return!0},V2=function($,X,J){return H0(J)},E2=function($,X,J){return $.anyOf.some((Q)=>h0(Q,X,J))},I2=function($,X,J){if(!c8(J))return!1;if(p($.maxByteLength)&&!(J.length<=$.maxByteLength))return!1;if(p($.minByteLength)&&!(J.length>=$.minByteLength))return!1;return!0},k2=function($,X,J){return!0},x2=function($,X,J){return F0.IsVoidLike(J)},g2=function($,X,J){if(!b0.Has($[D]))return!1;return b0.Get($[D])($,J)},h0=function($,X,J){const Q=p($.$id)?[...X,$]:X,W=$;switch(W[D]){case"Any":return Q2(W,Q,J);case"Array":return W2(W,Q,J);case"AsyncIterator":return Z2(W,Q,J);case"BigInt":return Y2(W,Q,J);case"Boolean":return z2(W,Q,J);case"Constructor":return q2(W,Q,J);case"Date":return B2(W,Q,J);case"Function":return U2(W,Q,J);case"Integer":return w2(W,Q,J);case"Intersect":return G2(W,Q,J);case"Iterator":return M2(W,Q,J);case"Literal":return A2(W,Q,J);case"Never":return H2(W,Q,J);case"Not":return N2(W,Q,J);case"Null":return D2(W,Q,J);case"Number":return O2(W,Q,J);case"Object":return L2(W,Q,J);case"Promise":return S2(W,Q,J);case"Record":return _2(W,Q,J);case"Ref":return P2(W,Q,J);case"RegExp":return C2(W,Q,J);case"String":return F2(W,Q,J);case"Symbol":return b2(W,Q,J);case"TemplateLiteral":return R2(W,Q,J);case"This":return j2(W,Q,J);case"Tuple":return K2(W,Q,J);case"Undefined":return V2(W,Q,J);case"Union":return E2(W,Q,J);case"Uint8Array":return I2(W,Q,J);case"Unknown":return k2(W,Q,J);case"Void":return x2(W,Q,J);default:if(!b0.Has(W[D]))throw new dQ(W);return g2(W,Q,J)}};function e(...$){return $.length===3?h0($[0],$[1],$[2]):h0($[0],[],$[1])}class dQ extends d{schema;constructor($){super("Unknown type");this.schema=$}}var T2=function($){return[...Object.getOwnPropertyNames($),...Object.getOwnPropertySymbols($)].reduce((J,Q)=>({...J,[Q]:z0($[Q])}),{})},f2=function($){return $.map((X)=>z0(X))},y2=function($){return $.slice()},d2=function($){return new Date($.toISOString())},v2=function($){return $};function z0($){if(y($))return f2($);if(Y1($))return d2($);if(w0($))return T2($);if(D1($))return y2($);if(z1($))return v2($);throw new Error("ValueClone: Unable to clone value")}var l=function($){return typeof $==="function"?$:z0($)},h2=function($,X){if(u($,"default"))return l($.default);else return{}},p2=function($,X){if($.uniqueItems===!0&&!u($,"default"))throw new C1($,"Array with the uniqueItems constraint requires a default value");else if("contains"in $&&!u($,"default"))throw new C1($,"Array with the contains constraint requires a default value");else if("default"in $)return l($.default);else if($.minItems!==void 0)return Array.from({length:$.minItems}).map((J)=>{return M1($.items,X)});else return[]},m2=function($,X){if(u($,"default"))return l($.default);else return async function*(){}()},u2=function($,X){if(u($,"default"))return l($.default);else return BigInt(0)},i2=function($,X){if(u($,"default"))return l($.default);else return!1},c2=function($,X){if(u($,"default"))return l($.default);else{const J=M1($.returns,X);if(typeof J==="object"&&!Array.isArray(J))return class{constructor(){for(let[Q,W]of Object.entries(J)){const Z=this;Z[Q]=W}}};else return class{}}},o2=function($,X){if(u($,"default"))return l($.default);else if($.minimumTimestamp!==void 0)return new Date($.minimumTimestamp);else return new Date},l2=function($,X){if(u($,"default"))return l($.default);else return()=>M1($.returns,X)},n2=function($,X){if(u($,"default"))return l($.default);else if($.minimum!==void 0)return $.minimum;else return 0},t2=function($,X){if(u($,"default"))return l($.default);else{const J=$.allOf.reduce((Q,W)=>{const Z=M1(W,X);return typeof Z==="object"?{...Q,...Z}:Z},{});if(!e($,X,J))throw new C1($,"Intersect produced invalid value. Consider using a default value.");return J}},s2=function($,X){if(u($,"default"))return l($.default);else return function*(){}()},r2=function($,X){if(u($,"default"))return l($.default);else return $.const},a2=function($,X){if(u($,"default"))return l($.default);else throw new C1($,"Never types cannot be created. Consider using a default value.")},e2=function($,X){if(u($,"default"))return l($.default);else throw new C1($,"Not types must have a default value")},$5=function($,X){if(u($,"default"))return l($.default);else return null},X5=function($,X){if(u($,"default"))return l($.default);else if($.minimum!==void 0)return $.minimum;else return 0},J5=function($,X){if(u($,"default"))return l($.default);else{const J=new Set($.required);return l($.default)||Object.entries($.properties).reduce((Q,[W,Z])=>{return J.has(W)?{...Q,[W]:M1(Z,X)}:{...Q}},{})}},Q5=function($,X){if(u($,"default"))return l($.default);else return Promise.resolve(M1($.item,X))},W5=function($,X){const[J,Q]=Object.entries($.patternProperties)[0];if(u($,"default"))return l($.default);else if(!(J===S8||J===z8))return J.slice(1,J.length-1).split("|").reduce((Z,Y)=>{return{...Z,[Y]:M1(Q,X)}},{});else return{}},Z5=function($,X){if(u($,"default"))return l($.default);else return M1(a($,X),X)},Y5=function($,X){if(u($,"default"))return l($.default);else throw new C1($,"RegExp types cannot be created. Consider using a default value.")},z5=function($,X){if($.pattern!==void 0)if(!u($,"default"))throw new C1($,"String types with patterns must specify a default value");else return l($.default);else if($.format!==void 0)if(!u($,"default"))throw new C1($,"String types with formats must specify a default value");else return l($.default);else if(u($,"default"))return l($.default);else if($.minLength!==void 0)return Array.from({length:$.minLength}).map(()=>" ").join("");else return""},q5=function($,X){if(u($,"default"))return l($.default);else if("value"in $)return Symbol.for($.value);else return Symbol()},B5=function($,X){if(u($,"default"))return l($.default);if(!G6($))throw new C1($,"Can only create template literals that produce a finite variants. Consider using a default value.");return X$($)[0]},U5=function($,X){if(vQ++>O5)throw new C1($,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(u($,"default"))return l($.default);else return M1(a($,X),X)},w5=function($,X){if(u($,"default"))return l($.default);if($.items===void 0)return[];else return Array.from({length:$.minItems}).map((J,Q)=>M1($.items[Q],X))},G5=function($,X){if(u($,"default"))return l($.default);else return},M5=function($,X){if(u($,"default"))return l($.default);else if($.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return M1($.anyOf[0],X)},A5=function($,X){if(u($,"default"))return l($.default);else if($.minByteLength!==void 0)return new Uint8Array($.minByteLength);else return new Uint8Array(0)},H5=function($,X){if(u($,"default"))return l($.default);else return{}},N5=function($,X){if(u($,"default"))return l($.default);else return},D5=function($,X){if(u($,"default"))return l($.default);else throw new Error("User defined types must specify a default value")},M1=function($,X){const J=v($.$id)?[...X,$]:X,Q=$;switch(Q[D]){case"Any":return h2(Q,J);case"Array":return p2(Q,J);case"AsyncIterator":return m2(Q,J);case"BigInt":return u2(Q,J);case"Boolean":return i2(Q,J);case"Constructor":return c2(Q,J);case"Date":return o2(Q,J);case"Function":return l2(Q,J);case"Integer":return n2(Q,J);case"Intersect":return t2(Q,J);case"Iterator":return s2(Q,J);case"Literal":return r2(Q,J);case"Never":return a2(Q,J);case"Not":return e2(Q,J);case"Null":return $5(Q,J);case"Number":return X5(Q,J);case"Object":return J5(Q,J);case"Promise":return Q5(Q,J);case"Record":return W5(Q,J);case"Ref":return Z5(Q,J);case"RegExp":return Y5(Q,J);case"String":return z5(Q,J);case"Symbol":return q5(Q,J);case"TemplateLiteral":return B5(Q,J);case"This":return U5(Q,J);case"Tuple":return w5(Q,J);case"Undefined":return G5(Q,J);case"Union":return M5(Q,J);case"Uint8Array":return A5(Q,J);case"Unknown":return H5(Q,J);case"Void":return N5(Q,J);default:if(!b0.Has(Q[D]))throw new C1(Q,"Unknown type");return D5(Q,J)}};function A1(...$){return vQ=0,$.length===2?M1($[0],$[1]):M1($[0],[])}class C1 extends d{schema;constructor($,X){super(X);this.schema=$}}var O5=512,vQ=0;var L5=function($,X,J){if($[D]==="Object"&&typeof J==="object"&&!W8(J)){const Q=$,W=Object.getOwnPropertyNames(J),Z=Object.entries(Q.properties),[Y,z]=[1/Z.length,Z.length];return Z.reduce((q,[G,B])=>{const H=B[D]==="Literal"&&B.const===J[G]?z:0,L=e(B,X,J[G])?Y:0,b=W.includes(G)?Y:0;return q+(H+L+b)},0)}else return e($,X,J)?1:0},S5=function($,X,J){let[Q,W]=[$.anyOf[0],0];for(let Z of $.anyOf){const Y=L5(Z,X,J);if(Y>W)Q=Z,W=Y}return Q},_5=function($,X,J){if("default"in $)return typeof J==="function"?$.default:z0($.default);else{const Q=S5($,X,J);return D6(Q,X,J)}},P5=function($,X,J){return e($,X,J)?z0(J):A1($,X)},C5=function($,X,J){return e($,X,J)?J:A1($,X)},F5=function($,X,J){if(e($,X,J))return z0(J);const Q=y(J)?z0(J):A1($,X),W=E($.minItems)&&Q.length<$.minItems?[...Q,...Array.from({length:$.minItems-Q.length},()=>null)]:Q,Y=(E($.maxItems)&&W.length>$.maxItems?W.slice(0,$.maxItems):W).map((q)=>o1($.items,X,q));if($.uniqueItems!==!0)return Y;const z=[...new Set(Y)];if(!e($,X,z))throw new MX($,"Array cast produced invalid data due to uniqueItems constraint");return z},b5=function($,X,J){if(e($,X,J))return A1($,X);const Q=new Set($.returns.required||[]),W=function(){};for(let[Z,Y]of Object.entries($.returns.properties)){if(!Q.has(Z)&&J.prototype[Z]===void 0)continue;W.prototype[Z]=o1(Y,X,J.prototype[Z])}return W},R5=function($,X,J){const Q=A1($,X),W=w0(Q)&&w0(J)?{...Q,...J}:J;return e($,X,W)?W:A1($,X)},j5=function($,X,J){throw new MX($,"Never types cannot be cast")},K5=function($,X,J){if(e($,X,J))return J;if(J===null||typeof J!=="object")return A1($,X);const Q=new Set($.required||[]),W={};for(let[Z,Y]of Object.entries($.properties)){if(!Q.has(Z)&&J[Z]===void 0)continue;W[Z]=o1(Y,X,J[Z])}if(typeof $.additionalProperties==="object"){const Z=Object.getOwnPropertyNames($.properties);for(let Y of Object.getOwnPropertyNames(J)){if(Z.includes(Y))continue;W[Y]=o1($.additionalProperties,X,J[Y])}}return W},V5=function($,X,J){if(e($,X,J))return z0(J);if(J===null||typeof J!=="object"||Array.isArray(J)||J instanceof Date)return A1($,X);const Q=Object.getOwnPropertyNames($.patternProperties)[0],W=$.patternProperties[Q],Z={};for(let[Y,z]of Object.entries(J))Z[Y]=o1(W,X,z);return Z},E5=function($,X,J){return o1(a($,X),X,J)},I5=function($,X,J){return o1(a($,X),X,J)},k5=function($,X,J){if(e($,X,J))return z0(J);if(!y(J))return A1($,X);if($.items===void 0)return[];return $.items.map((Q,W)=>o1(Q,X,J[W]))},x5=function($,X,J){return e($,X,J)?z0(J):_5($,X,J)},o1=function($,X,J){const Q=v($.$id)?[...X,$]:X,W=$;switch($[D]){case"Array":return F5(W,Q,J);case"Constructor":return b5(W,Q,J);case"Intersect":return R5(W,Q,J);case"Never":return j5(W,Q,J);case"Object":return K5(W,Q,J);case"Record":return V5(W,Q,J);case"Ref":return E5(W,Q,J);case"This":return I5(W,Q,J);case"Tuple":return k5(W,Q,J);case"Union":return x5(W,Q,J);case"Date":case"Symbol":case"Uint8Array":return P5($,X,J);default:return C5(W,Q,J)}};function D6(...$){return $.length===3?o1($[0],$[1],$[2]):o1($[0],[],$[1])}class MX extends d{schema;constructor($,X){super(X);this.schema=$}}var g5=function($){return k($)&&$[D]!=="Unsafe"},T5=function($,X,J){if(!y(J))return J;return J.map((Q)=>H1($.items,X,Q))},f5=function($,X,J){const Q=$.unevaluatedProperties,Z=$.allOf.map((z)=>H1(z,X,z0(J))).reduce((z,q)=>y0(q)?{...z,...q}:q,{});if(!y0(J)||!y0(Z)||!k(Q))return Z;const Y=Q1($);for(let z of Object.getOwnPropertyNames(J)){if(Y.includes(z))continue;if(e(Q,X,J[z]))Z[z]=H1(Q,X,J[z])}return Z},y5=function($,X,J){if(!y0(J)||y(J))return J;const Q=$.additionalProperties;for(let W of Object.getOwnPropertyNames(J)){if(W in $.properties){J[W]=H1($.properties[W],X,J[W]);continue}if(k(Q)&&e(Q,X,J[W])){J[W]=H1(Q,X,J[W]);continue}delete J[W]}return J},d5=function($,X,J){if(!y0(J))return J;const Q=$.additionalProperties,W=Object.keys(J),[Z,Y]=Object.entries($.patternProperties)[0],z=new RegExp(Z);for(let q of W){if(z.test(q)){J[q]=H1(Y,X,J[q]);continue}if(k(Q)&&e(Q,X,J[q])){J[q]=H1(Q,X,J[q]);continue}delete J[q]}return J},v5=function($,X,J){return H1(a($,X),X,J)},h5=function($,X,J){return H1(a($,X),X,J)},p5=function($,X,J){if(!y(J))return J;if(H0($.items))return[];const Q=Math.min(J.length,$.items.length);for(let W=0;W<Q;W++)J[W]=H1($.items[W],X,J[W]);return J.length>Q?J.slice(0,Q):J},m5=function($,X,J){for(let Q of $.anyOf)if(g5(Q)&&e(Q,J))return H1(Q,X,J);return J},H1=function($,X,J){const Q=v($.$id)?[...X,$]:X,W=$;switch(W[D]){case"Array":return T5(W,Q,J);case"Intersect":return f5(W,Q,J);case"Object":return y5(W,Q,J);case"Record":return d5(W,Q,J);case"Ref":return v5(W,Q,J);case"This":return h5(W,Q,J);case"Tuple":return p5(W,Q,J);case"Union":return m5(W,Q,J);default:return J}};function AX(...$){return $.length===3?H1($[0],$[1],$[2]):H1($[0],[],$[1])}var O6=function($){return v($)&&!isNaN($)&&!isNaN(parseFloat($))},u5=function($){return d0($)||h1($)||E($)},k$=function($){return $===!0||E($)&&$===1||d0($)&&$===BigInt("1")||v($)&&($.toLowerCase()==="true"||$==="1")},x$=function($){return $===!1||E($)&&($===0||Object.is($,-0))||d0($)&&$===BigInt("0")||v($)&&($.toLowerCase()==="false"||$==="0"||$==="-0")},i5=function($){return v($)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test($)},c5=function($){return v($)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test($)},o5=function($){return v($)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test($)},l5=function($){return v($)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test($)},n5=function($){return v($)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test($)},t5=function($,X){const J=pQ($);return J===X?J:$},s5=function($,X){const J=mQ($);return J===X?J:$},r5=function($,X){const J=hQ($);return J===X?J:$},a5=function($,X){return v($.const)?t5(X,$.const):E($.const)?s5(X,$.const):h1($.const)?r5(X,$.const):z0(X)},hQ=function($){return k$($)?!0:x$($)?!1:$},e5=function($){return O6($)?BigInt(parseInt($)):E($)?BigInt($|0):x$($)?BigInt(0):k$($)?BigInt(1):$},pQ=function($){return u5($)?$.toString():r0($)&&$.description!==void 0?$.description.toString():$},mQ=function($){return O6($)?parseFloat($):k$($)?1:x$($)?0:$},$z=function($){return O6($)?parseInt($):E($)?$|0:k$($)?1:x$($)?0:$},Xz=function($){return v($)&&$.toLowerCase()==="null"?null:$},Jz=function($){return v($)&&$==="undefined"?void 0:$},Qz=function($){return Y1($)?$:E($)?new Date($):k$($)?new Date(1):x$($)?new Date(0):O6($)?new Date(parseInt($)):c5($)?new Date(`1970-01-01T${$}.000Z`):i5($)?new Date(`1970-01-01T${$}`):l5($)?new Date(`${$}.000Z`):o5($)?new Date($):n5($)?new Date(`${$}T00:00:00.000Z`):$},Wz=function($){return $},Zz=function($,X,J){if(y(J))return J.map((Q)=>l1($.items,X,Q));return J},Yz=function($,X,J){return e5(J)},zz=function($,X,J){return hQ(J)},qz=function($,X,J){return Qz(J)},Bz=function($,X,J){return $z(J)},Uz=function($,X,J){return $.allOf.reduce((Q,W)=>l1(W,X,Q),J)},wz=function($,X,J){return a5($,J)},Gz=function($,X,J){return Xz(J)},Mz=function($,X,J){return mQ(J)},Az=function($,X,J){if(!y0(J))return J;return Object.getOwnPropertyNames($.properties).reduce((W,Z)=>{return!H0(W[Z])?{...W,[Z]:l1($.properties[Z],X,W[Z])}:{...W}},J)},Hz=function($,X,J){const Q=Object.getOwnPropertyNames($.patternProperties)[0],W=$.patternProperties[Q],Z={};for(let[Y,z]of Object.entries(J))Z[Y]=l1(W,X,z);return Z},Nz=function($,X,J){return l1(a($,X),X,J)},Dz=function($,X,J){return pQ(J)},Oz=function($,X,J){return v(J)||E(J)?Symbol(J):J},Lz=function($,X,J){return l1(a($,X),X,J)},Sz=function($,X,J){if(!(y(J)&&!H0($.items)))return J;return J.map((W,Z)=>{return Z<$.items.length?l1($.items[Z],X,W):W})},_z=function($,X,J){return Jz(J)},Pz=function($,X,J){for(let Q of $.anyOf){const W=l1(Q,X,J);if(!e(Q,X,W))continue;return W}return J},l1=function($,X,J){const Q=v($.$id)?[...X,$]:X,W=$;switch($[D]){case"Array":return Zz(W,Q,J);case"BigInt":return Yz(W,Q,J);case"Boolean":return zz(W,Q,J);case"Date":return qz(W,Q,J);case"Integer":return Bz(W,Q,J);case"Intersect":return Uz(W,Q,J);case"Literal":return wz(W,Q,J);case"Null":return Gz(W,Q,J);case"Number":return Mz(W,Q,J);case"Object":return Az(W,Q,J);case"Record":return Hz(W,Q,J);case"Ref":return Nz(W,Q,J);case"String":return Dz(W,Q,J);case"Symbol":return Oz(W,Q,J);case"This":return Lz(W,Q,J);case"Tuple":return Sz(W,Q,J);case"Undefined":return _z(W,Q,J);case"Union":return Pz(W,Q,J);default:return Wz(J)}};function HX(...$){return $.length===3?l1($[0],$[1],$[2]):l1($[0],[],$[1])}var C8=function($,X){return X===void 0&&"default"in $?z0($.default):X},Cz=function($){return k($)&&$[D]!=="Unsafe"},L6=function($){return k($)&&"default"in $},Fz=function($,X,J){const Q=C8($,J);if(!y(Q))return Q;for(let W=0;W<Q.length;W++)Q[W]=F1($.items,X,Q[W]);return Q},bz=function($,X,J){const Q=C8($,J);return $.allOf.reduce((W,Z)=>{const Y=F1(Z,X,Q);return y0(Y)?{...W,...Y}:Y},{})},Rz=function($,X,J){const Q=C8($,J);if(!y0(Q))return Q;const W=$.additionalProperties,Z=Object.getOwnPropertyNames($.properties);for(let Y of Z){if(!L6($.properties[Y]))continue;Q[Y]=F1($.properties[Y],X,Q[Y])}if(!L6(W))return Q;for(let Y of Object.getOwnPropertyNames(Q)){if(Z.includes(Y))continue;Q[Y]=F1(W,X,Q[Y])}return Q},jz=function($,X,J){const Q=C8($,J);if(!y0(Q))return Q;const W=$.additionalProperties,[Z,Y]=Object.entries($.patternProperties)[0],z=new RegExp(Z);for(let q of Object.getOwnPropertyNames(Q)){if(!(z.test(q)&&L6(Y)))continue;Q[q]=F1(Y,X,Q[q])}if(!L6(W))return Q;for(let q of Object.getOwnPropertyNames(Q)){if(z.test(q))continue;Q[q]=F1(W,X,Q[q])}return Q},Kz=function($,X,J){return F1(a($,X),X,C8($,J))},Vz=function($,X,J){return F1(a($,X),X,J)},Ez=function($,X,J){const Q=C8($,J);if(!y(Q)||H0($.items))return Q;const[W,Z]=[$.items,Math.max($.items.length,Q.length)];for(let Y=0;Y<Z;Y++)if(Y<W.length)Q[Y]=F1(W[Y],X,Q[Y]);return Q},Iz=function($,X,J){const Q=C8($,J);for(let W of $.anyOf){const Z=F1(W,X,Q);if(Cz(W)&&e(W,Z))return Z}return Q},F1=function($,X,J){const Q=v($.$id)?[...X,$]:X,W=$;switch(W[D]){case"Array":return Fz(W,Q,J);case"Intersect":return bz(W,Q,J);case"Object":return Rz(W,Q,J);case"Record":return jz(W,Q,J);case"Ref":return Kz(W,Q,J);case"This":return Vz(W,Q,J);case"Tuple":return Ez(W,Q,J);case"Union":return Iz(W,Q,J);default:return C8(W,J)}};function NX(...$){return $.length===3?F1($[0],$[1],$[2]):F1($[0],[],$[1])}var T1={};b8(T1,{ValuePointerRootSetError:()=>{{return DX}},ValuePointerRootDeleteError:()=>{{return OX}},Set:()=>{{return kz}},Has:()=>{{return gz}},Get:()=>{{return Tz}},Format:()=>{{return g$}},Delete:()=>{{return xz}}});var uQ=function($){return $.indexOf("~")===-1?$:$.replace(/~1/g,"/").replace(/~0/g,"~")};function*g$($){if($==="")return;let[X,J]=[0,0];for(let Q=0;Q<$.length;Q++)if($.charAt(Q)==="/")if(Q===0)X=Q+1;else J=Q,yield uQ($.slice(X,J)),X=Q+1;else J=Q;yield uQ($.slice(X))}function kz($,X,J){if(X==="")throw new DX($,X,J);let[Q,W,Z]=[null,$,""];for(let Y of g$(X)){if(W[Y]===void 0)W[Y]={};Q=W,W=W[Y],Z=Y}Q[Z]=J}function xz($,X){if(X==="")throw new OX($,X);let[J,Q,W]=[null,$,""];for(let Z of g$(X)){if(Q[Z]===void 0||Q[Z]===null)return;J=Q,Q=Q[Z],W=Z}if(Array.isArray(J)){const Z=parseInt(W);J.splice(Z,1)}else delete J[W]}function gz($,X){if(X==="")return!0;let[J,Q,W]=[null,$,""];for(let Z of g$(X)){if(Q[Z]===void 0)return!1;J=Q,Q=Q[Z],W=Z}return Object.getOwnPropertyNames(J).includes(W)}function Tz($,X){if(X==="")return $;let J=$;for(let Q of g$(X)){if(J[Q]===void 0)return;J=J[Q]}return J}class DX extends d{value;path;update;constructor($,X,J){super("Cannot set root value");this.value=$,this.path=X,this.update=J}}class OX extends d{value;path;constructor($,X){super("Cannot delete root value");this.value=$,this.path=X}}var f$=function($,X){return{type:"update",path:$,value:X}},iQ=function($,X){return{type:"insert",path:$,value:X}},cQ=function($){return{type:"delete",path:$}};function*vz($,X,J){if(!w0(J))return yield f$($,J);const Q=[...globalThis.Object.keys(X),...globalThis.Object.getOwnPropertySymbols(X)],W=[...globalThis.Object.keys(J),...globalThis.Object.getOwnPropertySymbols(J)];for(let Z of Q){if(r0(Z))throw new T$(Z);if(H0(J[Z])&&W.includes(Z))yield f$(`${$}/${globalThis.String(Z)}`,void 0)}for(let Z of W){if(H0(X[Z])||H0(J[Z]))continue;if(r0(Z))throw new T$(Z);yield*S6(`${$}/${globalThis.String(Z)}`,X[Z],J[Z])}for(let Z of W){if(r0(Z))throw new T$(Z);if(H0(X[Z]))yield iQ(`${$}/${globalThis.String(Z)}`,J[Z])}for(let Z of Q.reverse()){if(r0(Z))throw new T$(Z);if(H0(J[Z])&&!W.includes(Z))yield cQ(`${$}/${globalThis.String(Z)}`)}}function*hz($,X,J){if(!y(J))return yield f$($,J);for(let Q=0;Q<Math.min(X.length,J.length);Q++)yield*S6(`${$}/${Q}`,X[Q],J[Q]);for(let Q=0;Q<J.length;Q++){if(Q<X.length)continue;yield iQ(`${$}/${Q}`,J[Q])}for(let Q=X.length-1;Q>=0;Q--){if(Q<J.length)continue;yield cQ(`${$}/${Q}`)}}function*pz($,X,J){if(!D1(J)||X.length!==J.length||globalThis.Object.getPrototypeOf(X).constructor.name!==globalThis.Object.getPrototypeOf(J).constructor.name)return yield f$($,J);for(let Q=0;Q<Math.min(X.length,J.length);Q++)yield*S6(`${$}/${Q}`,X[Q],J[Q])}function*mz($,X,J){if(X===J)return;yield f$($,J)}function*S6($,X,J){if(w0(X))return yield*vz($,X,J);if(y(X))return yield*hz($,X,J);if(D1(X))return yield*pz($,X,J);if(z1(X))return yield*mz($,X,J);throw new LX(X,"Unable to create diff edits for unknown value")}function oQ($,X){return[...S6("",$,X)]}var uz=function($){return $.length>0&&$[0].path===""&&$[0].type==="update"},iz=function($){return $.length===0};function lQ($,X){if(uz(X))return z0(X[0].value);if(iz(X))return z0($);const J=z0($);for(let Q of X)switch(Q.type){case"insert":{T1.Set(J,Q.path,Q.value);break}case"update":{T1.Set(J,Q.path,Q.value);break}case"delete":{T1.Delete(J,Q.path);break}}return J}var fz=Z0({type:t("insert"),path:U1(),value:c1()}),yz=Z0({type:t("update"),path:U1(),value:c1()}),dz=Z0({type:t("delete"),path:U1()}),LO=X0([fz,yz,dz]);class LX extends d{value;constructor($,X){super(X);this.value=$}}class T$ extends LX{value;constructor($){super($,"Cannot diff objects with symbol keys");this.value=$}}var cz=function($,X){if(!w0(X))return!1;const J=[...Object.keys($),...Object.getOwnPropertySymbols($)],Q=[...Object.keys(X),...Object.getOwnPropertySymbols(X)];if(J.length!==Q.length)return!1;return J.every((W)=>y$($[W],X[W]))},oz=function($,X){return Y1(X)&&$.getTime()===X.getTime()},lz=function($,X){if(!y(X)||$.length!==X.length)return!1;return $.every((J,Q)=>y$(J,X[Q]))},nz=function($,X){if(!D1(X)||$.length!==X.length||Object.getPrototypeOf($).constructor.name!==Object.getPrototypeOf(X).constructor.name)return!1;return $.every((J,Q)=>y$(J,X[Q]))},tz=function($,X){return $===X};function y$($,X){if(w0($))return cz($,X);if(Y1($))return oz($,X);if(D1($))return nz($,X);if(y($))return lz($,X);if(z1($))return tz($,X);throw new Error("ValueEquals: Unable to compare value")}var sz=function($,X,J,Q){if(!w0(J))T1.Set($,X,z0(Q));else{const W=Object.keys(J),Z=Object.keys(Q);for(let Y of W)if(!Z.includes(Y))delete J[Y];for(let Y of Z)if(!W.includes(Y))J[Y]=null;for(let Y of Z)_X($,`${X}/${Y}`,J[Y],Q[Y])}},rz=function($,X,J,Q){if(!y(J))T1.Set($,X,z0(Q));else{for(let W=0;W<Q.length;W++)_X($,`${X}/${W}`,J[W],Q[W]);J.splice(Q.length)}},az=function($,X,J,Q){if(D1(J)&&J.length===Q.length)for(let W=0;W<J.length;W++)J[W]=Q[W];else T1.Set($,X,z0(Q))},ez=function($,X,J,Q){if(J===Q)return;T1.Set($,X,Q)},_X=function($,X,J,Q){if(y(Q))return rz($,X,J,Q);if(D1(Q))return az($,X,J,Q);if(w0(Q))return sz($,X,J,Q);if(z1(Q))return ez($,X,J,Q)},nQ=function($){return D1($)||z1($)},$4=function($,X){return w0($)&&y(X)||y($)&&w0(X)};function tQ($,X){if(nQ($)||nQ(X))throw new SX("Only object and array types can be mutated at the root level");if($4($,X))throw new SX("Cannot assign due type mismatch of assignable values");_X($,"",$,X)}class SX extends d{constructor($){super($)}}var O0=function($,X,J){try{return r($)?$[E0].Decode(J):J}catch(Q){throw new sQ($,X,J,Q)}},X4=function($,X,J,Q){return y(Q)?O0($,J,Q.map((W,Z)=>n1($.items,X,`${J}/${Z}`,W))):O0($,J,Q)},J4=function($,X,J,Q){if(!w0(Q)||z1(Q))return O0($,J,Q);const W=Q1($),Z=W.reduce((G,B)=>{return B in G?{...G,[B]:n1(x1($,[B]),X,`${J}/${B}`,G[B])}:G},Q);if(!r($.unevaluatedProperties))return O0($,J,Z);const Y=Object.getOwnPropertyNames(Z),z=$.unevaluatedProperties,q=Y.reduce((G,B)=>{return!W.includes(B)?{...G,[B]:O0(z,`${J}/${B}`,G[B])}:G},Z);return O0($,J,q)},Q4=function($,X,J,Q){return O0($,J,n1($.not,X,J,Q))},W4=function($,X,J,Q){if(!w0(Q))return O0($,J,Q);const W=Q1($),Z=W.reduce((G,B)=>{return B in G?{...G,[B]:n1($.properties[B],X,`${J}/${B}`,G[B])}:G},Q);if(!k($.additionalProperties))return O0($,J,Z);const Y=Object.getOwnPropertyNames(Z),z=$.additionalProperties,q=Y.reduce((G,B)=>{return!W.includes(B)?{...G,[B]:O0(z,`${J}/${B}`,G[B])}:G},Z);return O0($,J,q)},Z4=function($,X,J,Q){if(!w0(Q))return O0($,J,Q);const W=Object.getOwnPropertyNames($.patternProperties)[0],Z=new RegExp(W),Y=Object.getOwnPropertyNames(Q).reduce((B,H)=>{return Z.test(H)?{...B,[H]:n1($.patternProperties[W],X,`${J}/${H}`,B[H])}:B},Q);if(!k($.additionalProperties))return O0($,J,Y);const z=Object.getOwnPropertyNames(Y),q=$.additionalProperties,G=z.reduce((B,H)=>{return!Z.test(H)?{...B,[H]:O0(q,`${J}/${H}`,B[H])}:B},Y);return O0($,J,G)},Y4=function($,X,J,Q){const W=a($,X);return O0($,J,n1(W,X,J,Q))},z4=function($,X,J,Q){const W=a($,X);return O0($,J,n1(W,X,J,Q))},q4=function($,X,J,Q){return y(Q)&&y($.items)?O0($,J,$.items.map((W,Z)=>n1(W,X,`${J}/${Z}`,Q[Z]))):O0($,J,Q)},B4=function($,X,J,Q){for(let W of $.anyOf){if(!e(W,X,Q))continue;const Z=n1(W,X,J,Q);return O0($,J,Z)}return O0($,J,Q)},n1=function($,X,J,Q){const W=typeof $.$id==="string"?[...X,$]:X,Z=$;switch($[D]){case"Array":return X4(Z,W,J,Q);case"Intersect":return J4(Z,W,J,Q);case"Not":return Q4(Z,W,J,Q);case"Object":return W4(Z,W,J,Q);case"Record":return Z4(Z,W,J,Q);case"Ref":return Y4(Z,W,J,Q);case"Symbol":return O0(Z,J,Q);case"This":return z4(Z,W,J,Q);case"Tuple":return q4(Z,W,J,Q);case"Union":return B4(Z,W,J,Q);default:return O0(Z,J,Q)}};function _6($,X,J){return n1($,X,"",J)}class d$ extends d{schema;value;error;constructor($,X,J){super("Unable to decode value as it does not match the expected schema");this.schema=$,this.value=X,this.error=J}}class sQ extends d{schema;path;value;error;constructor($,X,J,Q){super(Q instanceof Error?Q.message:"Unknown error");this.schema=$,this.path=X,this.value=J,this.error=Q}}var x0=function($,X,J){try{return r($)?$[E0].Encode(J):J}catch(Q){throw new rQ($,X,J,Q)}},U4=function($,X,J,Q){const W=x0($,J,Q);return y(W)?W.map((Z,Y)=>t1($.items,X,`${J}/${Y}`,Z)):W},w4=function($,X,J,Q){const W=x0($,J,Q);if(!w0(Q)||z1(Q))return W;const Z=Q1($),Y=Z.reduce((G,B)=>{return B in W?{...G,[B]:t1(x1($,[B]),X,`${J}/${B}`,G[B])}:G},W);if(!r($.unevaluatedProperties))return x0($,J,Y);const z=Object.getOwnPropertyNames(Y),q=$.unevaluatedProperties;return z.reduce((G,B)=>{return!Z.includes(B)?{...G,[B]:x0(q,`${J}/${B}`,G[B])}:G},Y)},G4=function($,X,J,Q){return x0($.not,J,x0($,J,Q))},M4=function($,X,J,Q){const W=x0($,J,Q);if(!w0(Q))return W;const Z=Q1($),Y=Z.reduce((G,B)=>{return B in G?{...G,[B]:t1($.properties[B],X,`${J}/${B}`,G[B])}:G},W);if(!k($.additionalProperties))return Y;const z=Object.getOwnPropertyNames(Y),q=$.additionalProperties;return z.reduce((G,B)=>{return!Z.includes(B)?{...G,[B]:x0(q,`${J}/${B}`,G[B])}:G},Y)},A4=function($,X,J,Q){const W=x0($,J,Q);if(!w0(Q))return W;const Z=Object.getOwnPropertyNames($.patternProperties)[0],Y=new RegExp(Z),z=Object.getOwnPropertyNames(Q).reduce((B,H)=>{return Y.test(H)?{...B,[H]:t1($.patternProperties[Z],X,`${J}/${H}`,B[H])}:B},W);if(!k($.additionalProperties))return x0($,J,z);const q=Object.getOwnPropertyNames(z),G=$.additionalProperties;return q.reduce((B,H)=>{return!Y.test(H)?{...B,[H]:x0(G,`${J}/${H}`,B[H])}:B},z)},H4=function($,X,J,Q){const W=a($,X),Z=t1(W,X,J,Q);return x0($,J,Z)},N4=function($,X,J,Q){const W=a($,X),Z=t1(W,X,J,Q);return x0($,J,Z)},D4=function($,X,J,Q){const W=x0($,J,Q);return y($.items)?$.items.map((Z,Y)=>t1(Z,X,`${J}/${Y}`,W[Y])):[]},O4=function($,X,J,Q){for(let W of $.anyOf){if(!e(W,X,Q))continue;const Z=t1(W,X,J,Q);return x0($,J,Z)}for(let W of $.anyOf){const Z=t1(W,X,J,Q);if(!e($,X,Z))continue;return x0($,J,Z)}return x0($,J,Q)},t1=function($,X,J,Q){const W=typeof $.$id==="string"?[...X,$]:X,Z=$;switch($[D]){case"Array":return U4(Z,W,J,Q);case"Intersect":return w4(Z,W,J,Q);case"Not":return G4(Z,W,J,Q);case"Object":return M4(Z,W,J,Q);case"Record":return A4(Z,W,J,Q);case"Ref":return H4(Z,W,J,Q);case"This":return N4(Z,W,J,Q);case"Tuple":return D4(Z,W,J,Q);case"Union":return O4(Z,W,J,Q);default:return x0(Z,J,Q)}};function P6($,X,J){return t1($,X,"",J)}class v$ extends d{schema;value;error;constructor($,X,J){super("The encoded value does not match the expected schema");this.schema=$,this.value=X,this.error=J}}class rQ extends d{schema;path;value;error;constructor($,X,J,Q){super(`${Q instanceof Error?Q.message:"Unknown error"}`);this.schema=$,this.path=X,this.value=J,this.error=Q}}var L4=function($,X){return r($)||g0($.items,X)},S4=function($,X){return r($)||g0($.items,X)},_4=function($,X){return r($)||g0($.returns,X)||$.parameters.some((J)=>g0(J,X))},P4=function($,X){return r($)||g0($.returns,X)||$.parameters.some((J)=>g0(J,X))},C4=function($,X){return r($)||r($.unevaluatedProperties)||$.allOf.some((J)=>g0(J,X))},F4=function($,X){return r($)||g0($.items,X)},b4=function($,X){return r($)||g0($.not,X)},R4=function($,X){return r($)||Object.values($.properties).some((J)=>g0(J,X))||k($.additionalProperties)&&g0($.additionalProperties,X)},j4=function($,X){return r($)||g0($.item,X)},K4=function($,X){const J=Object.getOwnPropertyNames($.patternProperties)[0],Q=$.patternProperties[J];return r($)||g0(Q,X)||k($.additionalProperties)&&r($.additionalProperties)},V4=function($,X){if(r($))return!0;return g0(a($,X),X)},E4=function($,X){if(r($))return!0;return g0(a($,X),X)},I4=function($,X){return r($)||!H0($.items)&&$.items.some((J)=>g0(J,X))},k4=function($,X){return r($)||$.anyOf.some((J)=>g0(J,X))},g0=function($,X){const J=v($.$id)?[...X,$]:X,Q=$;if($.$id&&PX.has($.$id))return!1;if($.$id)PX.add($.$id);switch($[D]){case"Array":return L4(Q,J);case"AsyncIterator":return S4(Q,J);case"Constructor":return _4(Q,J);case"Function":return P4(Q,J);case"Intersect":return C4(Q,J);case"Iterator":return F4(Q,J);case"Not":return b4(Q,J);case"Object":return R4(Q,J);case"Promise":return j4(Q,J);case"Record":return K4(Q,J);case"Ref":return V4(Q,J);case"This":return E4(Q,J);case"Tuple":return I4(Q,J);case"Union":return k4(Q,J);default:return r($)}};function aQ($,X){return PX.clear(),g0($,X)}var PX=new Set;var q0={};b8(q0,{Patch:()=>{{return i4}},Mutate:()=>{{return c4}},Hash:()=>{{return u4}},Errors:()=>{{return FX}},Equal:()=>{{return p4}},Encode:()=>{{return h4}},Diff:()=>{{return m4}},Default:()=>{{return v4}},Decode:()=>{{return d4}},Create:()=>{{return g4}},Convert:()=>{{return f4}},Clone:()=>{{return y4}},Clean:()=>{{return T4}},Check:()=>{{return CX}},Cast:()=>{{return x4}}});function x4(...$){return D6.apply(D6,$)}function g4(...$){return A1.apply(A1,$)}function CX(...$){return e.apply(e,$)}function T4(...$){return AX.apply(AX,$)}function f4(...$){return HX.apply(HX,$)}function y4($){return z0($)}function d4(...$){const[X,J,Q]=$.length===3?[$[0],$[1],$[2]]:[$[0],[],$[1]];if(!CX(X,J,Q))throw new d$(X,Q,FX(X,J,Q).First());return _6(X,J,Q)}function v4(...$){return NX.apply(NX,$)}function h4(...$){const[X,J,Q]=$.length===3?[$[0],$[1],$[2]]:[$[0],[],$[1]],W=P6(X,J,Q);if(!CX(X,J,W))throw new v$(X,W,FX(X,J,W).First());return W}function FX(...$){return I$.apply(I$,$)}function p4($,X){return y$($,X)}function m4($,X){return oQ($,X)}function u4($){return _8($)}function i4($,X){return lQ($,X)}function c4($,X){tQ($,X)}var eQ=function($){return $.map((X)=>bX(X))},o4=function($){return n0(eQ($))},l4=function($){return X0(eQ($))},n4=function($){return bX($)},bX=function($){return C0($)?o4($.allOf):o($)?l4($.anyOf):L8($)?n4($.item):$};function RX($,X={}){return S(bX($),X)}var t4=function($){return $.reduce((X,J)=>{return wQ([...X,...Q1(J)])},[])},s4=function($){return $.filter((X)=>!K8(X))},r4=function($,X){return $.reduce((J,Q)=>{return s4([...J,...ZX(Q,[X])])},[])},a4=function($,X){return X.reduce((J,Q)=>{return{...J,[Q]:w6(r4($,Q))}},{})};function jX($,X={}){const J=t4($),Q=a4($,J);return Z0(Q,X)}function h$($={}){return{...$,[D]:"Date",type:"Date"}}function p$($={}){return{...$,[D]:"Null",type:"null"}}function m$($){return{...$,[D]:"Symbol",type:"symbol"}}function u$($={}){return{...$,[D]:"Undefined",type:"undefined"}}function i$($={}){return{...$,[D]:"Uint8Array",type:"Uint8Array"}}var e4=function($){return $.map((X)=>KX(X,!1))},$q=function($){return globalThis.Object.getOwnPropertyNames($).reduce((X,J)=>{return{...X,[J]:w1(KX($[J],!1))}},{})},C6=function($,X){return X===!0?$:w1($)},KX=function($,X){return c6($)?C6(w8(),X):l6($)?C6(w8(),X):e0($)?w1(g1(e4($))):j8($)?i$():N$($)?h$():R0($)?C6(Z0($q($)),X):o6($)?C6(Z8([],c1()),X):D0($)?u$():n6($)?p$():s6($)?m$():H$($)?E8():m1($)?t($):R8($)?t($):N0($)?t($):Z0({})};function VX($,X={}){return S(KX($,!0),X)}function EX($,X={}){return g1(I0($.parameters),{...X})}var c$=function($,X){return $.map((J)=>b1(J,X))},Xq=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:b1($[Q],X)}},{})},Jq=function($,X){return $.parameters=c$($.parameters,X),$.returns=b1($.returns,X),$},Qq=function($,X){return $.parameters=c$($.parameters,X),$.returns=b1($.returns,X),$},Wq=function($,X){return $.allOf=c$($.allOf,X),$},Zq=function($,X){return $.anyOf=c$($.anyOf,X),$},Yq=function($,X){if(D0($.items))return $;return $.items=c$($.items,X),$},zq=function($,X){return $.items=b1($.items,X),$},qq=function($,X){return $.properties=Xq($.properties,X),$},Bq=function($,X){return $.item=b1($.item,X),$},Uq=function($,X){return $.items=b1($.items,X),$},wq=function($,X){return $.items=b1($.items,X),$},Gq=function($,X){const J=X.find((W)=>W.$id===$.$ref);if(J===void 0)throw Error(`Unable to dereference schema with \$id ${$.$ref}`);const Q=P0(J,["$id"]);return b1(Q,X)},Mq=function($,X){return t8($)?Jq($,X):s8($)?Qq($,X):C0($)?Wq($,X):o($)?Zq($,X):L1($)?Yq($,X):u1($)?zq($,X):j0($)?qq($,X):L8($)?Bq($,X):n8($)?Uq($,X):r8($)?wq($,X):B6($)?Gq($,X):$};function b1($,X){return Mq(S($),I0(X))}function IX($,X={}){if(D0($))throw new Error("Enum undefined or empty");const J=globalThis.Object.getOwnPropertyNames($).filter((Z)=>isNaN(Z)).map((Z)=>$[Z]),W=[...new Set(J)].map((Z)=>t(Z));return X0(W,{...X,[O1]:"Enum"})}function $W($,X){return x8(I8($),X)}var Aq=function($,X){const J=$.filter((Q)=>P8(Q,X)===O.False);return J.length===1?J[0]:X0(J)};function x8($,X,J={}){if(X1($))return S($W($,X),J);if(G0($))return S(XW($,X),J);return S(o($)?Aq($.anyOf,X):P8($,X)!==O.False?$0():$,J)}var Hq=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:x8($[Q],X)}},{})},Nq=function($,X){return Hq($.properties,X)};function XW($,X){const J=Nq($,X);return n(J)}function JW($,X){return g8(I8($),X)}var Dq=function($,X){const J=$.filter((Q)=>P8(Q,X)!==O.False);return J.length===1?J[0]:X0(J)};function g8($,X,J={}){if(X1($))return S(JW($,X),J);if(G0($))return S(QW($,X),J);return S(o($)?Dq($.anyOf,X):P8($,X)!==O.False?$:$0(),J)}var Oq=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:g8($[Q],X)}},{})},Lq=function($,X){return Oq($.properties,X)};function QW($,X){const J=Lq($,X);return n(J)}function kX($,X={}){return S($.returns,X)}function xX($={}){return{...$,[D]:"Integer",type:"integer"}}var Sq=function($,X,J){return{[$]:f1(t($),X,J)}},_q=function($,X,J){return $.reduce((Q,W)=>{return{...Q,...Sq(W,X,J)}},{})},Pq=function($,X,J){return _q($.keys,X,J)};function WW($,X,J){const Q=Pq($,X,J);return n(Q)}var Cq=function($){const[X,J]=[$.slice(0,1),$.slice(1)];return[X.toLowerCase(),J].join("")},Fq=function($){const[X,J]=[$.slice(0,1),$.slice(1)];return[X.toUpperCase(),J].join("")},bq=function($){return $.toUpperCase()},Rq=function($){return $.toLowerCase()},jq=function($,X,J){const Q=$$($.pattern);if(!V8(Q))return{...$,pattern:ZW($.pattern,X)};const Y=[...F$(Q)].map((G)=>t(G)),z=YW(Y,X),q=X0(z);return R$([q],J)},ZW=function($,X){return typeof $==="string"?X==="Uncapitalize"?Cq($):X==="Capitalize"?Fq($):X==="Uppercase"?bq($):X==="Lowercase"?Rq($):$:$.toString()},YW=function($,X){return $.map((J)=>f1(J,X))};function f1($,X,J={}){return $1($)?WW($,X,J):X1($)?jq($,X,$):o($)?X0(YW($.anyOf,X),J):B1($)?t(ZW($.const,X),J):$}function gX($,X={}){return f1($,"Capitalize",X)}function TX($,X={}){return f1($,"Lowercase",X)}function fX($,X={}){return f1($,"Uncapitalize",X)}function yX($,X={}){return f1($,"Uppercase",X)}function dX($,X){return{...X,[D]:"Not",not:S($)}}var Kq=function($,X,J){return globalThis.Object.getOwnPropertyNames($).reduce((Q,W)=>{return{...Q,[W]:T8($[W],X,J)}},{})},Vq=function($,X,J){return Kq($.properties,X,J)};function zW($,X,J){const Q=Vq($,X,J);return n(Q)}var Eq=function($,X){return $.map((J)=>vX(J,X))},Iq=function($,X){return $.map((J)=>vX(J,X))},kq=function($,X){const{[X]:J,...Q}=$;return Q},xq=function($,X){return X.reduce((J,Q)=>{return kq(J,Q)},$)},vX=function($,X){return C0($)?n0(Eq($.allOf,X)):o($)?X0(Iq($.anyOf,X)):j0($)?Z0(xq($.properties,X)):Z0({})};function T8($,X,J={}){if($1(X))return qW($,X,J);if(G0($))return zW($,X,J);const Q=k(X)?J1(X):X,W=P0($,[E0,"$id","required"]),Z=S(vX($,Q),J);return{...W,...Z}}var gq=function($,X,J){return{[X]:T8($,[X],J)}},Tq=function($,X,J){return X.reduce((Q,W)=>{return{...Q,...gq($,W,J)}},{})},fq=function($,X,J){return Tq($,X.keys,J)};function qW($,X,J){const Q=fq($,X,J);return n(Q)}function hX($,X={}){return g1(I0($.parameters),{...X})}var BW=function($){return $.map((X)=>UW(X))},yq=function($){return globalThis.Object.getOwnPropertyNames($).reduce((X,J)=>{return{...X,[J]:l0($[J])}},{})},UW=function($){return C0($)?n0(BW($.allOf)):o($)?X0(BW($.anyOf)):j0($)?Z0(yq($.properties)):Z0({})};function o$($,X={}){if(G0($))return wW($,X);const J=P0($,[E0,"$id","required"]),Q=S(UW($),X);return{...J,...Q}}var dq=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:o$($[Q],X)}},{})},vq=function($,X){return dq($.properties,X)};function wW($,X){const J=vq($,X);return n(J)}var hq=function($,X,J){return globalThis.Object.getOwnPropertyNames($).reduce((Q,W)=>{return{...Q,[W]:f8($[W],X,J)}},{})},pq=function($,X,J){return hq($.properties,X,J)};function GW($,X,J){const Q=pq($,X,J);return n(Q)}var mq=function($,X){return $.map((J)=>pX(J,X))},uq=function($,X){return $.map((J)=>pX(J,X))},iq=function($,X){return X.reduce((J,Q)=>{return Q in $?{...J,[Q]:$[Q]}:J},{})},pX=function($,X){return C0($)?n0(mq($.allOf,X)):o($)?X0(uq($.anyOf,X)):j0($)?Z0(iq($.properties,X)):Z0({})};function f8($,X,J={}){if($1(X))return MW($,X,J);if(G0($))return GW($,X,J);const Q=k(X)?J1(X):X,W=P0($,[E0,"$id","required"]),Z=S(pX($,Q),J);return{...W,...Z}}var cq=function($,X,J){return{[X]:f8($,[X],J)}},oq=function($,X,J){return X.reduce((Q,W)=>{return{...Q,...cq($,W,J)}},{})},lq=function($,X,J){return oq($,X.keys,J)};function MW($,X,J){const Q=lq($,X,J);return n(Q)}function mX($){return w1(l0($))}var l$=function($,X,J){return{...J,[D]:"Record",type:"object",patternProperties:{[$]:S(X)}}},uX=function($,X,J){const Q=$.reduce((W,Z)=>({...W,[Z]:S(X)}),{});return Z0(Q,{...J,[O1]:"Record"})},nq=function($,X,J){return G6($)?uX(J1($),X,J):l$($.pattern,X,J)},tq=function($,X,J){return uX(J1(X0($)),X,J)},sq=function($,X,J){return uX([$.toString()],X,J)},rq=function($,X,J){return l$($.source,X,J)},aq=function($,X,J){const Q=D0($.pattern)?S8:$.pattern;return l$(Q,X,J)},eq=function($,X,J){return l$(z8,X,J)},$B=function($,X,J){return l$(z8,X,J)};function iX($,X,J={}){return o($)?tq($.anyOf,X,J):X1($)?nq($,X,J):B1($)?sq($.const,X,J):D8($)?eq($,X,J):O8($)?$B($,X,J):U6($)?rq($,X,J):a8($)?aq($,X,J):$0(J)}function cX($,X={}){if(D0(X.$id))X.$id=`T${XB++}`;const J=$({[D]:"This",$ref:`${X.$id}`});return J.$id=X.$id,S({...X,[O1]:"Recursive",...J})}var XB=0;function oX($,X={}){if(N0($))return{...X,[D]:"Ref",$ref:$};if(D0($.$id))throw new Error("Reference target type must specify an $id");return{...X,[D]:"Ref",$ref:$.$id}}function lX($,X={}){const J=N0($)?new globalThis.RegExp($):$;return{...X,[D]:"RegExp",type:"RegExp",source:J.source,flags:J.flags}}var AW=function($){return $.map((X)=>HW(X))},JB=function($){return globalThis.Object.getOwnPropertyNames($).reduce((X,J)=>{return{...X,[J]:P0($[J],[a0])}},{})},HW=function($){return C0($)?n0(AW($.allOf)):o($)?X0(AW($.anyOf)):j0($)?Z0(JB($.properties)):Z0({})};function n$($,X={}){if(G0($))return NW($,X);else{const J=P0($,[E0,"$id","required"]),Q=S(HW($),X);return{...J,...Q}}}var QB=function($,X){return globalThis.Object.getOwnPropertyNames($).reduce((J,Q)=>{return{...J,[Q]:n$($[Q],X)}},{})},WB=function($,X){return QB($.properties,X)};function NW($,X){const J=WB($,X);return n(J)}var ZB=function($){return C0($)?[...$.allOf]:o($)?[...$.anyOf]:L1($)?[...$.items??[]]:[]};function nX($){return I0(ZB($))}function tX($,X={}){return S($.returns,X)}function sX($){return JSON.parse(JSON.stringify($))}function rX($){return new DW($)}class DW{schema;constructor($){this.schema=$}Decode($){return new OW(this.schema,$)}}class OW{schema;decode;constructor($,X){this.schema=$,this.decode=X}EncodeTransform($,X){const W={Encode:(Z)=>X[E0].Encode($(Z)),Decode:(Z)=>this.decode(X[E0].Decode(Z))};return{...X,[E0]:W}}EncodeSchema($,X){const J={Decode:this.decode,Encode:$};return{...X,[E0]:J}}Encode($){const X=S(this.schema);return r(X)?this.EncodeTransform($,X):this.EncodeSchema($,X)}}function aX($={}){return{...$,[D]:"Void",type:"void"}}var eX={};b8(eX,{Void:()=>{{return aX}},Uppercase:()=>{{return yX}},Unsafe:()=>{{return A$}},Unknown:()=>{{return c1}},Union:()=>{{return X0}},Undefined:()=>{{return u$}},Uncapitalize:()=>{{return fX}},Uint8Array:()=>{{return i$}},Tuple:()=>{{return g1}},Transform:()=>{{return rX}},TemplateLiteral:()=>{{return R$}},Symbol:()=>{{return m$}},String:()=>{{return U1}},Strict:()=>{{return sX}},ReturnType:()=>{{return tX}},Rest:()=>{{return nX}},Required:()=>{{return n$}},RegExp:()=>{{return lX}},Ref:()=>{{return oX}},Recursive:()=>{{return cX}},Record:()=>{{return iX}},ReadonlyOptional:()=>{{return mX}},Readonly:()=>{{return w1}},Promise:()=>{{return K$}},Pick:()=>{{return f8}},Partial:()=>{{return o$}},Parameters:()=>{{return hX}},Optional:()=>{{return l0}},Omit:()=>{{return T8}},Object:()=>{{return Z0}},Number:()=>{{return k1}},Null:()=>{{return p$}},Not:()=>{{return dX}},Never:()=>{{return $0}},Mapped:()=>{{return YX}},Lowercase:()=>{{return TX}},Literal:()=>{{return t}},KeyOf:()=>{{return E$}},Iterator:()=>{{return j$}},Intersect:()=>{{return n0}},Integer:()=>{{return xX}},InstanceType:()=>{{return kX}},Index:()=>{{return x1}},Function:()=>{{return Z8}},Extract:()=>{{return g8}},Extends:()=>{{return k8}},Exclude:()=>{{return x8}},Enum:()=>{{return IX}},Deref:()=>{{return b1}},Date:()=>{{return h$}},ConstructorParameters:()=>{{return EX}},Constructor:()=>{{return L$}},Const:()=>{{return VX}},Composite:()=>{{return jX}},Capitalize:()=>{{return gX}},Boolean:()=>{{return b$}},BigInt:()=>{{return E8}},Awaited:()=>{{return RX}},AsyncIterator:()=>{{return O$}},Array:()=>{{return D$}},Any:()=>{{return w8}}});var Z$=eX;class QJ{schema;references;checkFunc;code;hasTransform;constructor($,X,J,Q){this.schema=$,this.references=X,this.checkFunc=J,this.code=Q,this.hasTransform=aQ($,X)}Code(){return this.code}Errors($){return I$(this.schema,this.references,$)}Check($){return this.checkFunc($)}Decode($){if(!this.checkFunc($))throw new d$(this.schema,$,this.Errors($).First());return this.hasTransform?_6(this.schema,this.references,$):$}Encode($){const X=this.hasTransform?P6(this.schema,this.references,$):$;if(!this.checkFunc(X))throw new v$(this.schema,$,this.Errors($).First());return X}}var G8;(function($){function X(Z){return Z===36}$.DollarSign=X;function J(Z){return Z===95}$.IsUnderscore=J;function Q(Z){return Z>=65&&Z<=90||Z>=97&&Z<=122}$.IsAlpha=Q;function W(Z){return Z>=48&&Z<=57}$.IsNumeric=W})(G8||(G8={}));var F6;(function($){function X(Z){if(Z.length===0)return!1;return G8.IsNumeric(Z.charCodeAt(0))}function J(Z){if(X(Z))return!1;for(let Y=0;Y<Z.length;Y++){const z=Z.charCodeAt(Y);if(!(G8.IsAlpha(z)||G8.IsNumeric(z)||G8.DollarSign(z)||G8.IsUnderscore(z)))return!1}return!0}function Q(Z){return Z.replace(/'/g,"\\'")}function W(Z,Y){return J(Y)?`${Z}.${Y}`:`${Z}['${Q(Y)}']`}$.Encode=W})(F6||(F6={}));var $J;(function($){function X(J){const Q=[];for(let W=0;W<J.length;W++){const Z=J.charCodeAt(W);if(G8.IsNumeric(Z)||G8.IsAlpha(Z))Q.push(J.charAt(W));else Q.push(`_${Z}_`)}return Q.join("").replace(/__/g,"_")}$.Encode=X})($J||($J={}));var XJ;(function($){function X(J){return J.replace(/'/g,"\\'")}$.Escape=X})(XJ||(XJ={}));class LW extends d{schema;constructor($){super("Unknown type");this.schema=$}}class JJ extends d{schema;constructor($){super("Preflight validation check failed to guard for the given schema");this.schema=$}}var y8;(function($){function X(Y,z,q){return F0.ExactOptionalPropertyTypes?`('${z}' in ${Y} ? ${q} : true)`:`(${F6.Encode(Y,z)} !== undefined ? ${q} : true)`}$.IsExactOptionalProperty=X;function J(Y){return!F0.AllowArrayObject?`(typeof ${Y} === 'object' && ${Y} !== null && !Array.isArray(${Y}))`:`(typeof ${Y} === 'object' && ${Y} !== null)`}$.IsObjectLike=J;function Q(Y){return!F0.AllowArrayObject?`(typeof ${Y} === 'object' && ${Y} !== null && !Array.isArray(${Y}) && !(${Y} instanceof Date) && !(${Y} instanceof Uint8Array))`:`(typeof ${Y} === 'object' && ${Y} !== null && !(${Y} instanceof Date) && !(${Y} instanceof Uint8Array))`}$.IsRecordLike=Q;function W(Y){return!F0.AllowNaN?`(typeof ${Y} === 'number' && Number.isFinite(${Y}))`:`typeof ${Y} === 'number'`}$.IsNumberLike=W;function Z(Y){return F0.AllowNullVoid?`(${Y} === undefined || ${Y} === null)`:`${Y} === undefined`}$.IsVoidLike=Z})(y8||(y8={}));var Y$;(function($){function X(U){return U[D]==="Any"||U[D]==="Unknown"}function*J(U,F,M){yield"true"}function*Q(U,F,M){yield`Array.isArray(${M})`;const[f,j]=[i("value","any"),i("acc","number")];if(E(U.maxItems))yield`${M}.length <= ${U.maxItems}`;if(E(U.minItems))yield`${M}.length >= ${U.minItems}`;const V=N1(U.items,F,"value");if(yield`${M}.every((${f}) => ${V})`,k(U.contains)||E(U.minContains)||E(U.maxContains)){const M0=k(U.contains)?U.contains:$0(),s0=N1(M0,F,"value"),Q8=E(U.minContains)?[`(count >= ${U.minContains})`]:[],E1=E(U.maxContains)?[`(count <= ${U.maxContains})`]:[],v1=`const count = value.reduce((${j}, ${f}) => ${s0} ? acc + 1 : acc, 0)`,e$=["(count > 0)",...Q8,...E1].join(" && ");yield`((${f}) => { ${v1}; return ${e$}})(${M})`}if(U.uniqueItems===!0)yield`((${f}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${M})`}function*W(U,F,M){yield`(typeof value === 'object' && Symbol.asyncIterator in ${M})`}function*Z(U,F,M){if(yield`(typeof ${M} === 'bigint')`,d0(U.exclusiveMaximum))yield`${M} < BigInt(${U.exclusiveMaximum})`;if(d0(U.exclusiveMinimum))yield`${M} > BigInt(${U.exclusiveMinimum})`;if(d0(U.maximum))yield`${M} <= BigInt(${U.maximum})`;if(d0(U.minimum))yield`${M} >= BigInt(${U.minimum})`;if(d0(U.multipleOf))yield`(${M} % BigInt(${U.multipleOf})) === 0`}function*Y(U,F,M){yield`(typeof ${M} === 'boolean')`}function*z(U,F,M){yield*J8(U.returns,F,`${M}.prototype`)}function*q(U,F,M){if(yield`(${M} instanceof Date) && Number.isFinite(${M}.getTime())`,E(U.exclusiveMaximumTimestamp))yield`${M}.getTime() < ${U.exclusiveMaximumTimestamp}`;if(E(U.exclusiveMinimumTimestamp))yield`${M}.getTime() > ${U.exclusiveMinimumTimestamp}`;if(E(U.maximumTimestamp))yield`${M}.getTime() <= ${U.maximumTimestamp}`;if(E(U.minimumTimestamp))yield`${M}.getTime() >= ${U.minimumTimestamp}`;if(E(U.multipleOfTimestamp))yield`(${M}.getTime() % ${U.multipleOfTimestamp}) === 0`}function*G(U,F,M){yield`(typeof ${M} === 'function')`}function*B(U,F,M){if(yield`(typeof ${M} === 'number' && Number.isInteger(${M}))`,E(U.exclusiveMaximum))yield`${M} < ${U.exclusiveMaximum}`;if(E(U.exclusiveMinimum))yield`${M} > ${U.exclusiveMinimum}`;if(E(U.maximum))yield`${M} <= ${U.maximum}`;if(E(U.minimum))yield`${M} >= ${U.minimum}`;if(E(U.multipleOf))yield`(${M} % ${U.multipleOf}) === 0`}function*H(U,F,M){const f=U.allOf.map((j)=>N1(j,F,M)).join(" && ");if(U.unevaluatedProperties===!1){const j=_(`${new RegExp(q8(U))};`),V=`Object.getOwnPropertyNames(${M}).every(key => ${j}.test(key))`;yield`(${f} && ${V})`}else if(k(U.unevaluatedProperties)){const j=_(`${new RegExp(q8(U))};`),V=`Object.getOwnPropertyNames(${M}).every(key => ${j}.test(key) || ${N1(U.unevaluatedProperties,F,`${M}[key]`)})`;yield`(${f} && ${V})`}else yield`(${f})`}function*L(U,F,M){yield`(typeof value === 'object' && Symbol.iterator in ${M})`}function*b(U,F,M){if(typeof U.const==="number"||typeof U.const==="boolean")yield`(${M} === ${U.const})`;else yield`(${M} === '${XJ.Escape(U.const)}')`}function*T(U,F,M){yield"false"}function*K(U,F,M){yield`(!${N1(U.not,F,M)})`}function*A(U,F,M){yield`(${M} === null)`}function*P(U,F,M){if(yield y8.IsNumberLike(M),E(U.exclusiveMaximum))yield`${M} < ${U.exclusiveMaximum}`;if(E(U.exclusiveMinimum))yield`${M} > ${U.exclusiveMinimum}`;if(E(U.maximum))yield`${M} <= ${U.maximum}`;if(E(U.minimum))yield`${M} >= ${U.minimum}`;if(E(U.multipleOf))yield`(${M} % ${U.multipleOf}) === 0`}function*g(U,F,M){if(yield y8.IsObjectLike(M),E(U.minProperties))yield`Object.getOwnPropertyNames(${M}).length >= ${U.minProperties}`;if(E(U.maxProperties))yield`Object.getOwnPropertyNames(${M}).length <= ${U.maxProperties}`;const f=Object.getOwnPropertyNames(U.properties);for(let j of f){const V=F6.Encode(M,j),M0=U.properties[j];if(U.required&&U.required.includes(j)){if(yield*J8(M0,F,V),B8(M0)||X(M0))yield`('${j}' in ${M})`}else{const s0=N1(M0,F,V);yield y8.IsExactOptionalProperty(M,j,s0)}}if(U.additionalProperties===!1)if(U.required&&U.required.length===f.length)yield`Object.getOwnPropertyNames(${M}).length === ${f.length}`;else{const j=`[${f.map((V)=>`'${V}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${M}).every(key => ${j}.includes(key))`}if(typeof U.additionalProperties==="object"){const j=N1(U.additionalProperties,F,`${M}[key]`),V=`[${f.map((M0)=>`'${M0}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${M}).every(key => ${V}.includes(key) || ${j}))`}}function*I(U,F,M){yield`(typeof value === 'object' && typeof ${M}.then === 'function')`}function*J0(U,F,M){if(yield y8.IsRecordLike(M),E(U.minProperties))yield`Object.getOwnPropertyNames(${M}).length >= ${U.minProperties}`;if(E(U.maxProperties))yield`Object.getOwnPropertyNames(${M}).length <= ${U.maxProperties}`;const[f,j]=Object.entries(U.patternProperties)[0],V=_(`${new RegExp(f)}`),M0=N1(j,F,"value"),s0=k(U.additionalProperties)?N1(U.additionalProperties,F,M):U.additionalProperties===!1?"false":"true",Q8=`(${V}.test(key) ? ${M0} : ${s0})`;yield`(Object.entries(${M}).every(([key, value]) => ${Q8}))`}function*U0(U,F,M){const f=a(U,F);if(k0.functions.has(U.$ref))return yield`${x(U.$ref)}(${M})`;yield*J8(f,F,M)}function*t0(U,F,M){const f=_(`${new RegExp(U.source,U.flags)};`);if(yield`(typeof ${M} === 'string')`,E(U.maxLength))yield`${M}.length <= ${U.maxLength}`;if(E(U.minLength))yield`${M}.length >= ${U.minLength}`;yield`${f}.test(${M})`}function*y1(U,F,M){if(yield`(typeof ${M} === 'string')`,E(U.maxLength))yield`${M}.length <= ${U.maxLength}`;if(E(U.minLength))yield`${M}.length >= ${U.minLength}`;if(U.pattern!==void 0)yield`${_(`${new RegExp(U.pattern)};`)}.test(${M})`;if(U.format!==void 0)yield`format('${U.format}', ${M})`}function*m0(U,F,M){yield`(typeof ${M} === 'symbol')`}function*A0(U,F,M){yield`(typeof ${M} === 'string')`,yield`${_(`${new RegExp(U.pattern)};`)}.test(${M})`}function*Q0(U,F,M){yield`${x(U.$ref)}(${M})`}function*m(U,F,M){if(yield`Array.isArray(${M})`,U.items===void 0)return yield`${M}.length === 0`;yield`(${M}.length === ${U.maxItems})`;for(let f=0;f<U.items.length;f++)yield`${N1(U.items[f],F,`${M}[${f}]`)}`}function*Z1(U,F,M){yield`${M} === undefined`}function*p8(U,F,M){yield`(${U.anyOf.map((j)=>N1(j,F,M)).join(" || ")})`}function*m8(U,F,M){if(yield`${M} instanceof Uint8Array`,E(U.maxByteLength))yield`(${M}.length <= ${U.maxByteLength})`;if(E(U.minByteLength))yield`(${M}.length >= ${U.minByteLength})`}function*u8(U,F,M){yield"true"}function*L0(U,F,M){yield y8.IsVoidLike(M)}function*A8(U,F,M){const f=k0.instances.size;k0.instances.set(f,U),yield`kind('${U[D]}', ${f}, ${M})`}function*J8(U,F,M,f=!0){const j=v(U.$id)?[...F,U]:F,V=U;if(f&&v(U.$id)){const M0=x(U.$id);if(k0.functions.has(M0))return yield`${M0}(${M})`;else{const s0=R(M0,U,F,"value",!1);return k0.functions.set(M0,s0),yield`${M0}(${M})`}}switch(V[D]){case"Any":return yield*J(V,j,M);case"Array":return yield*Q(V,j,M);case"AsyncIterator":return yield*W(V,j,M);case"BigInt":return yield*Z(V,j,M);case"Boolean":return yield*Y(V,j,M);case"Constructor":return yield*z(V,j,M);case"Date":return yield*q(V,j,M);case"Function":return yield*G(V,j,M);case"Integer":return yield*B(V,j,M);case"Intersect":return yield*H(V,j,M);case"Iterator":return yield*L(V,j,M);case"Literal":return yield*b(V,j,M);case"Never":return yield*T(V,j,M);case"Not":return yield*K(V,j,M);case"Null":return yield*A(V,j,M);case"Number":return yield*P(V,j,M);case"Object":return yield*g(V,j,M);case"Promise":return yield*I(V,j,M);case"Record":return yield*J0(V,j,M);case"Ref":return yield*U0(V,j,M);case"RegExp":return yield*t0(V,j,M);case"String":return yield*y1(V,j,M);case"Symbol":return yield*m0(V,j,M);case"TemplateLiteral":return yield*A0(V,j,M);case"This":return yield*Q0(V,j,M);case"Tuple":return yield*m(V,j,M);case"Undefined":return yield*Z1(V,j,M);case"Union":return yield*p8(V,j,M);case"Uint8Array":return yield*m8(V,j,M);case"Unknown":return yield*u8(V,j,M);case"Void":return yield*L0(V,j,M);default:if(!b0.Has(V[D]))throw new LW(U);return yield*A8(V,j,M)}}const k0={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function N1(U,F,M,f=!0){return`(${[...J8(U,F,M,f)].join(" && ")})`}function x(U){return`check_${$J.Encode(U)}`}function _(U){const F=`local_${k0.variables.size}`;return k0.variables.set(F,`const ${F} = ${U}`),F}function R(U,F,M,f,j=!0){const[V,M0]=["\n",(v1)=>"".padStart(v1," ")],s0=i("value","any"),Q8=S0("boolean"),E1=[...J8(F,M,f,j)].map((v1)=>`${M0(4)}${v1}`).join(` &&${V}`);return`function ${U}(${s0})${Q8} {${V}${M0(2)}return (${V}${E1}${V}${M0(2)})\n}`}function i(U,F){const M=k0.language==="typescript"?`: ${F}`:"";return`${U}${M}`}function S0(U){return k0.language==="typescript"?`: ${U}`:""}function H8(U,F,M){const f=R("check",U,F,"value"),j=i("value","any"),V=S0("boolean"),M0=[...k0.functions.values()],s0=[...k0.variables.values()],Q8=v(U.$id)?`return function check(${j})${V} {\n  return ${x(U.$id)}(value)\n}`:`return ${f}`;return[...s0,...M0,Q8].join("\n")}function d1(...U){const F={language:"javascript"},[M,f,j]=U.length===2&&y(U[1])?[U[0],U[1],F]:U.length===2&&!y(U[1])?[U[0],[],U[1]]:U.length===3?[U[0],U[1],U[2]]:U.length===1?[U[0],[],F]:[null,[],F];if(k0.language=j.language,k0.variables.clear(),k0.functions.clear(),k0.instances.clear(),!k(M))throw new JJ(M);for(let V of f)if(!k(V))throw new JJ(V);return H8(M,f,j)}$.Code=d1;function h6(U,F=[]){const M=d1(U,F,{language:"javascript"}),f=globalThis.Function("kind","format","hash",M),j=new Map(k0.instances);function V(E1,v1,e$){if(!b0.Has(E1)||!j.has(v1))return!1;const FZ=b0.Get(E1),bZ=j.get(v1);return FZ(bZ,e$)}function M0(E1,v1){if(!_0.Has(E1))return!1;return _0.Get(E1)(v1)}function s0(E1){return _8(E1)}const Q8=f(V,M0,s0);return new QJ(U,F,Q8,M)}$.Compile=h6})(Y$||(Y$={}));var qB=function($,X){if(typeof $!=="string")throw new TypeError("argument str must be a string");var J={},Q=X||{},W=Q.decode||UB,Z=0;while(Z<$.length){var Y=$.indexOf("=",Z);if(Y===-1)break;var z=$.indexOf(";",Z);if(z===-1)z=$.length;else if(z<Y){Z=$.lastIndexOf(";",Y-1)+1;continue}var q=$.slice(Z,Y).trim();if(J[q]===void 0){var G=$.slice(Y+1,z).trim();if(G.charCodeAt(0)===34)G=G.slice(1,-1);J[q]=MB(G,W)}Z=z+1}return J},BB=function($,X,J){var Q=J||{},W=Q.encode||wB;if(typeof W!=="function")throw new TypeError("option encode is invalid");if(!b6.test($))throw new TypeError("argument name is invalid");var Z=W(X);if(Z&&!b6.test(Z))throw new TypeError("argument val is invalid");var Y=$+"="+Z;if(Q.maxAge!=null){var z=Q.maxAge-0;if(isNaN(z)||!isFinite(z))throw new TypeError("option maxAge is invalid");Y+="; Max-Age="+Math.floor(z)}if(Q.domain){if(!b6.test(Q.domain))throw new TypeError("option domain is invalid");Y+="; Domain="+Q.domain}if(Q.path){if(!b6.test(Q.path))throw new TypeError("option path is invalid");Y+="; Path="+Q.path}if(Q.expires){var q=Q.expires;if(!GB(q)||isNaN(q.valueOf()))throw new TypeError("option expires is invalid");Y+="; Expires="+q.toUTCString()}if(Q.httpOnly)Y+="; HttpOnly";if(Q.secure)Y+="; Secure";if(Q.partitioned)Y+="; Partitioned";if(Q.priority){var G=typeof Q.priority==="string"?Q.priority.toLowerCase():Q.priority;switch(G){case"low":Y+="; Priority=Low";break;case"medium":Y+="; Priority=Medium";break;case"high":Y+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(Q.sameSite){var B=typeof Q.sameSite==="string"?Q.sameSite.toLowerCase():Q.sameSite;switch(B){case!0:Y+="; SameSite=Strict";break;case"lax":Y+="; SameSite=Lax";break;case"strict":Y+="; SameSite=Strict";break;case"none":Y+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return Y},UB=function($){return $.indexOf("%")!==-1?decodeURIComponent($):$},wB=function($){return encodeURIComponent($)},GB=function($){return zB.call($)==="[object Date]"||$ instanceof Date},MB=function($,X){try{return X($)}catch(J){return $}};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var WJ=qB,ZJ=BB;var zB=Object.prototype.toString,b6=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;var zZ=w$(R6(),1),dB=function($){let X=$;while(X.endsWith("="))X=X.slice(0,-1);return X};var MZ=w$(qJ(),1),AZ=w$(R6(),1),I6=w$(qJ(),1);var rB=function($){return $%4===0&&($%100!==0||$%400===0)},OZ=function($){const X=aB.exec($);if(!X)return!1;const J=+X[1],Q=+X[2],W=+X[3];return Q>=1&&Q<=12&&W>=1&&W<=(Q===2&&rB(J)?29:eB[Q])},NJ=function($){return function X(J){const Q=$U.exec(J);if(!Q)return!1;const W=+Q[1],Z=+Q[2],Y=+Q[3],z=Q[4],q=Q[5]==="-"?-1:1,G=+(Q[6]||0),B=+(Q[7]||0);if(G>23||B>59||$&&!z)return!1;if(W<=23&&Z<=59&&Y<60)return!0;const H=Z-B*q,L=W-G*q-(H<0?1:0);return(L===23||L===-1)&&(H===59||H===-1)&&Y<61}},rW=function($){const X=NJ($);return function J(Q){const W=Q.split(XU);return W.length===2&&OZ(W[0])&&X(W[1])}},WU=function($){return JU.test($)&&QU.test($)},ZU=function($){return aW.lastIndex=0,aW.test($)},qU=function($){return Number.isInteger($)&&$<=zU&&$>=YU},BU=function($){return Number.isInteger($)},eW=function(){return!0},wU=function($){if(UU.test($))return!1;try{return new RegExp($),!0}catch(X){return!1}};var z$=($,X)=>({part:$,store:null,inert:X!==void 0?new Map(X.map((J)=>[J.part.charCodeAt(0),J])):null,params:null,wildcardStore:null}),fW=($,X)=>({...$,part:X}),yW=($)=>({paramName:$,store:null,inert:null}),BJ=class ${root={};history=[];static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g};add(X,J,Q){let W;if(typeof J!="string")throw TypeError("Route path must be a string");J===""?J="/":J[0]!=="/"&&(J=`/${J}`),this.history.push([X,J,Q]);let Z=J[J.length-1]==="*";Z&&(J=J.slice(0,-1));let Y=J.split($.regex.static),z=J.match($.regex.params)||[];Y[Y.length-1]===""&&Y.pop(),W=this.root[X]?this.root[X]:this.root[X]=z$("/");let q=0;for(let G=0;G<Y.length;++G){let B=Y[G];if(G>0){let H=z[q++].slice(1);if(W.params===null)W.params=yW(H);else if(W.params.paramName!==H)throw Error(`Cannot create route "${J}" with parameter "${H}" because a route already exists with a different parameter name ("${W.params.paramName}") in the same location`);let L=W.params;if(L.inert===null){W=L.inert=z$(B);continue}W=L.inert}for(let H=0;;){if(H===B.length){if(H<W.part.length){let L=fW(W,W.part.slice(H));Object.assign(W,z$(B,[L]))}break}if(H===W.part.length){if(W.inert===null)W.inert=new Map;else if(W.inert.has(B.charCodeAt(H))){W=W.inert.get(B.charCodeAt(H)),B=B.slice(H),H=0;continue}let L=z$(B.slice(H));W.inert.set(B.charCodeAt(H),L),W=L;break}if(B[H]!==W.part[H]){let L=fW(W,W.part.slice(H)),b=z$(B.slice(H));Object.assign(W,z$(W.part.slice(0,H),[L,b])),W=b;break}++H}}if(q<z.length){let G=z[q],B=G.slice(1);if(W.params===null)W.params=yW(B);else if(W.params.paramName!==B)throw Error(`Cannot create route "${J}" with parameter "${B}" because a route already exists with a different parameter name ("${W.params.paramName}") in the same location`);return W.params.store===null&&(W.params.store=Q),W.params.store}return Z?(W.wildcardStore===null&&(W.wildcardStore=Q),W.wildcardStore):(W.store===null&&(W.store=Q),W.store)}find(X,J){let Q=this.root[X];return Q?HJ(J,J.length,Q,0):null}},HJ=($,X,J,Q)=>{let W=J?.part,Z=Q+W.length;if(W.length>1){if(Z>X)return null;if(W.length<15){for(let Y=1,z=Q+1;Y<W.length;++Y,++z)if(W.charCodeAt(Y)!==$.charCodeAt(z))return null}else if($.substring(Q,Z)!==W)return null}if(Z===X)return J.store!==null?{store:J.store,params:{}}:J.wildcardStore!==null?{store:J.wildcardStore,params:{"*":""}}:null;if(J.inert!==null){let Y=J.inert.get($.charCodeAt(Z));if(Y!==void 0){let z=HJ($,X,Y,Z);if(z!==null)return z}}if(J.params!==null){let Y=J.params,z=$.indexOf("/",Z);if(z!==Z){if(z===-1||z>=X){if(Y.store!==null){let q={};return q[Y.paramName]=$.substring(Z,X),{store:Y.store,params:q}}}else if(Y.inert!==null){let q=HJ($,X,Y.inert,z);if(q!==null)return q.params[Y.paramName]=$.substring(Z,z),q}}}return J.wildcardStore!==null?{store:J.wildcardStore,params:{"*":$.substring(Z,X)}}:null},j6=()=>{let $;return[new Promise((J)=>{$=J}),$]},F8=()=>{const[$,X]=j6(),[J,Q]=j6(),W=[],Z=[];return{signal:$,consume:(Y)=>{switch(Y.type){case"begin":if(Y.unit&&W.length===0)for(let z=0;z<Y.unit;z++){const[q,G]=j6(),[B,H]=j6();W.push(q),Z.push([(L)=>{G({children:[],end:B,name:L.name??"",skip:!1,time:L.time})},(L)=>{H(L)}])}X({children:W,end:J,name:Y.name??"",skip:!1,time:Y.time});break;case"end":Q(Y.time);break}},consumeChild(Y){switch(Y.type){case"begin":if(!Z[0])return;const[z]=Z[0];z({children:[],end:J,name:Y.name??"",skip:!1,time:Y.time});break;case"end":const q=Z.shift();if(!q)return;q[1](Y.time)}},resolve(){X({children:[],end:new Promise((Y)=>Y(0)),name:"",skip:!0,time:0});for(let[Y,z]of Z)Y({children:[],end:new Promise((q)=>q(0)),name:"",skip:!0,time:0}),z(0);Q(0)}}},_B=($,X,J)=>{if(typeof J==="object")J=J.fn;return async function Q(Q){if(Q.event!=="request"||Q.type!=="begin")return;const W=Q.id,Z=$(),Y=F8(),z=F8(),q=F8(),G=F8(),B=F8(),H=F8(),L=F8(),b=F8();Y.consume(Q);const T=(K)=>{if(K.id===W)switch(K.event){case"request":Y.consume(K);break;case"request.unit":Y.consumeChild(K);break;case"parse":z.consume(K);break;case"parse.unit":z.consumeChild(K);break;case"transform":q.consume(K);break;case"transform.unit":q.consumeChild(K);break;case"beforeHandle":G.consume(K);break;case"beforeHandle.unit":G.consumeChild(K);break;case"handle":B.consume(K);break;case"afterHandle":H.consume(K);break;case"afterHandle.unit":H.consumeChild(K);break;case"error":L.consume(K);break;case"error.unit":L.consumeChild(K);break;case"response":if(K.type==="begin")Y.resolve(),z.resolve(),q.resolve(),G.resolve(),B.resolve(),H.resolve(),L.resolve();else Z.off("event",T);b.consume(K);break;case"response.unit":b.consumeChild(K);break;case"exit":Y.resolve(),z.resolve(),q.resolve(),G.resolve(),B.resolve(),H.resolve(),L.resolve();break}};Z.on("event",T),await J({id:W,context:Q.ctx,set:Q.ctx?.set,store:Q.ctx?.store,time:Q.time,request:Y.signal,parse:z.signal,transform:q.signal,beforeHandle:G.signal,handle:B.signal,afterHandle:H.signal,error:L.signal,response:b.signal}),Z.emit(`res${W}.${X}`,void 0)}},XZ=($)=>{if($.startsWith("async"))$=$.slice(6);let X=-1;if($.charCodeAt(0)===40){if(X=$.indexOf(") => {\n"),X!==-1)return[$.slice(1,X),$.slice(X+5)];if(X=$.indexOf(") => "),X!==-1)return[$.slice(1,X),$.slice(X+5)]}if($.startsWith("function")){X=$.indexOf("(");const Q=$.indexOf(")");return[$.slice(X+1,Q),$.slice(Q+2)]}const J=$.indexOf("(");if(J!==-1){const[Q,W]=$.split("\n",2),Z=Q.lastIndexOf(")")+1;return[Q.slice(J,Z),"{"+W]}return $.split("\n",2)},JZ=($)=>{const X=$.indexOf("{");if(X===-1)return[-1,0];let J=X+1,Q=1;for(;J<$.length;J++){const W=$.charCodeAt(J);if(W===123)Q++;else if(W===125)Q--;if(Q===0)break}if(Q!==0)return[0,$.length];return[X,J+1]},PB=($)=>{const X=$.lastIndexOf("}");if(X===-1)return[-1,0];let J=X-1,Q=1;for(;J>=0;J--){const W=$.charCodeAt(J);if(W===125)Q++;else if(W===123)Q--;if(Q===0)break}if(Q!==0)return[-1,0];return[J,X+1]},y6=($)=>{if($.charCodeAt(0)===40)$=$.slice(1,-1);if($.charCodeAt(0)===123)$=$.slice(2,-2);while(!0){const[X,J]=JZ($);if(X===-1)break;$=$.slice(0,X-2)+$.slice(J+1)}return $.replace(/:/g,"").trim()},CB=($,X)=>{const J=y6($);if(!X.query&&J.includes("query"))X.query=!0;if(!X.headers&&J.includes("headers"))X.headers=!0;if(!X.body&&J.includes("body"))X.body=!0;if(!X.cookie&&J.includes("cookie"))X.cookie=!0;if(!X.set&&J.includes("set"))X.set=!0;return J},FB=($,X)=>{const J=y6($);if(!X.request&&J.includes("request"))X.request=!0;if(!X.parse&&J.includes("parse"))X.parse=!0;if(!X.transform&&J.includes("transform"))X.transform=!0;if(!X.handle&&J.includes("handle"))X.handle=!0;if(!X.beforeHandle&&J.includes("beforeHandle"))X.beforeHandle=!0;if(!X.afterHandle&&J.includes("afterHandle"))X.afterHandle=!0;if(!X.error&&J.includes("error"))X.error=!0;if(!X.context&&J.includes("context"))X.context=!0;if(!X.store&&J.includes("store"))X.store=!0;if(!X.set&&J.includes("set"))X.set=!0;return J},QZ=($,X,J)=>{const Q=X.indexOf($+"\n",J),W=X.indexOf($+"	",J),Z=X.indexOf($+",",J),Y=X.indexOf($+";",J),z=X.indexOf($+" ",J);return[Q,W,Z,Y,z].filter((q)=>q>0).sort((q,G)=>q-G)[0]||-1},bB=($,X,J)=>{const Q=X.indexOf($+"]",J),W=X.indexOf($+"'",J),Z=X.indexOf($+'"',J);return[Q,W,Z].filter((Y)=>Y>0).sort((Y,z)=>Y-z)[0]||-1},OJ=($,X,J=0)=>{if(J>5)return[];const Q=[];let W=X;while(!0){let Z=QZ(" = "+$,W);if(Z===-1){const q=W.indexOf(" = "+$);if(q+3+$.length!==W.length)break;Z=q}const Y=W.slice(0,Z);let z=Y.slice(Y.lastIndexOf(" ")+1);if(z==="}"){const[q,G]=PB(Y);Q.push(W.slice(q,G)),W=W.slice(Z+3+$.length);continue}while(z.charCodeAt(0)===44)z=z.slice(1);while(z.charCodeAt(0)===9)z=z.slice(1);Q.push(z),W=W.slice(Z+3+$.length)}for(let Z of Q){if(Z.charCodeAt(0)===123)continue;const Y=OJ(Z,X);if(Y.length>0)Q.push(...Y)}return Q},WZ=($,X)=>[$+"."+X,$+'["'+X+'"]',$+"['"+X+"']"],ZZ=($)=>{if(!$)return;if(!$.includes(",")){if($.includes("..."))return $.slice($.indexOf("...")+3);return $}const J=$.indexOf("...");if(J===-1)return;return $.slice(J+3).trimEnd()},dW=($,X,J)=>{const Q=(W,Z)=>$.includes(Z+"."+W)||$.includes(Z+'["'+W+'"]')||$.includes(Z+"['"+W+"']");for(let W of X){if(!W)continue;if(W.charCodeAt(0)===123){if(W=y6(W),!J.query&&W.includes("query"))J.query=!0;if(!J.headers&&W.includes("headers"))J.headers=!0;if(!J.body&&W.includes("body"))J.body=!0;if(!J.cookie&&W.includes("cookie"))J.cookie=!0;if(!J.set&&W.includes("set"))J.set=!0;continue}if($.includes("("+W+")")){J.query=!0,J.headers=!0,J.body=!0,J.cookie=!0,J.set=!0,J.queries=[],J.unknownQueries=!0;break}if(!J.query&&Q("query",W))J.query=!0;if($.includes("return "+W)||WZ("return "+W,"query").some((Z)=>$.includes(Z)))J.query=!0,J.unknownQueries=!0;if(J.query&&!J.unknownQueries)while(!0){let Z=W+".";if($.includes(Z+"query"))Z=W+".query";let Y=!1,z=$.indexOf(Z);if(z===-1)Y=!0,z=$.indexOf(W+'["');if(z===-1)Y=!0,z=$.indexOf(W+"['");if(z===-1&&$.indexOf(W+"[")!==-1){J.queries=[],J.unknownQueries=!0;break}if(z!==-1){let q=Y?bB("",$,z+Z.length+1):QZ("",$,z+Z.length+1);if(q===-1)q=void 0;const G=z+W.length+1;$=$.slice(z+W.length+1);let B=$.slice(0,q?q-G:q).trimEnd();while(z!==-1)if(z=B.indexOf("."),z!==-1)B=B.slice(z+1);if(B.charCodeAt(B.length-1)===59)B=B.slice(0,-1);if(B.charCodeAt(B.length-1)===44)B=B.slice(0,-1);if(B.charCodeAt(B.length-1)===93)B=B.slice(0,-1);if(B.charCodeAt(B.length-1)===41)B=B.slice(0,-1);if(Y)B=B.replaceAll(/("|')/g,"");if(B&&!J.queries.includes(B)){J.queries.push(B);continue}}break}if(!J.headers&&Q("headers",W))J.headers=!0;if(!J.body&&Q("body",W))J.body=!0;if(!J.cookie&&Q("cookie",W))J.cookie=!0;if(!J.set&&Q("set",W))J.set=!0;if(J.query&&J.headers&&J.body&&J.cookie&&J.set)break}return X},RB=($)=>{while(!0){const X=$.indexOf("=");if(X===-1)break;const J=$.indexOf(",",X),Q=$.indexOf("}",X),W=[J,Q].filter((Z)=>Z>0).sort((Z,Y)=>Z-Y)[0]||-1;if(W===-1){$=$.slice(0,X);break}$=$.slice(0,X)+$.slice(W)}return $.split(",").map((X)=>X.trim()).join(", ")},jB=($)=>{for(let X of $){if(X.charCodeAt(0)===123)return!1;if(X.indexOf("'")!==-1)return!1;if(X.indexOf('"')!==-1)return!1;if(X.indexOf("\n")!==-1)return!1;if(X.indexOf("	")!==-1)return!1}return!0},KB=($,X,J)=>{const Q=(W,Z)=>$.includes(W+"."+Z)||$.includes(W+'["'+Z+'"]')||$.includes(W+"['"+Z+"']");for(let W of X){if(W.charCodeAt(0)===123){if(W=y6(W),!J.request&&W.includes("request"))J.request=!0;if(!J.parse&&W.includes("parse"))J.parse=!0;if(!J.transform&&W.includes("transform"))J.transform=!0;if(!J.handle&&W.includes("handle"))J.handle=!0;if(!J.beforeHandle&&W.includes("beforeHandle"))J.beforeHandle=!0;if(!J.afterHandle&&W.includes("afterHandle"))J.afterHandle=!0;if(!J.error&&W.includes("error"))J.error=!0;if(!J.context&&W.includes("context"))J.context=!0;if(!J.store&&W.includes("store"))J.store=!0;if(!J.set&&W.includes("set"))J.set=!0;continue}if($.includes("("+W+")")){J.request=!0,J.parse=!0,J.transform=!0,J.handle=!0,J.beforeHandle=!0,J.afterHandle=!0,J.error=!0,J.context=!0,J.store=!0,J.set=!0;break}if(!J.request&&Q("request",W))J.request=!0;if(!J.parse&&Q("parse",W))J.parse=!0;if(!J.transform&&Q("transform",W))J.transform=!0;if(!J.handle&&Q("handle",W))J.handle=!0;if(!J.beforeHandle&&Q("beforeHandle",W))J.beforeHandle=!0;if(!J.afterHandle&&Q("afterHandle",W))J.afterHandle=!0;if(!J.error&&Q("error",W))J.error=!0;if(!J.context&&Q("context",W))J.context=!0;if(!J.store&&Q("store",W))J.store=!0;if(!J.set&&Q("set",W))J.set=!0;if(J.request&&J.parse&&J.transform&&J.handle&&J.beforeHandle&&J.afterHandle&&J.error&&J.context&&J.store&&J.set)break}return X},YZ=($,X={queries:[],query:!1,headers:!1,body:!1,cookie:!1,set:!1,unknownQueries:!1})=>{const J=[];if($.handler&&typeof $.handler==="function")J.push($.handler);if($.beforeHandle?.length)J.push(...$.beforeHandle);if($.parse?.length)J.push(...$.parse);if($.error?.length)J.push(...$.error);if($.transform?.length)J.push(...$.transform);if($.afterHandle?.length)J.push(...$.afterHandle);if($.mapResponse?.length)J.push(...$.mapResponse);if($.request?.length)J.push(...$.request);if($.onResponse?.length)J.push(...$.onResponse);for(let Q of J){if(!Q)continue;const W="fn"in Q?Q.fn:Q,[Z,Y]=XZ(W.toString()),z=CB(Z,X),q=ZZ(z);if(q){const B=OJ(q,Y);B.splice(0,-1,q),dW(Y,B,X)}const G=z||q;if(G&&["","return "].some((B)=>WZ(B+G,"query").some((H)=>Y.includes(H))))X.query=!0,X.unknownQueries=!0;if(X.query){dW(Y,["query"],X);const B=Z.indexOf("query: {");if(B!==-1){const H=Z.slice(B+7),[L,b]=JZ(H),T=RB(H.slice(L,b));for(let K of T.slice(1,-1).split(",")){const A=K.indexOf(":");if(A!==-1)K=K.slice(0,A);if(K=K.trim(),K&&!X.queries.includes(K))X.queries.push(K.trim())}}}if(X.query&&X.headers&&X.body&&X.cookie&&X.set)break}if(!jB(X.queries))X.unknownQueries=!0,X.queries=[];return X},VB=($,X={request:!1,parse:!1,transform:!1,handle:!1,beforeHandle:!1,afterHandle:!1,error:!1,context:!1,store:!1,set:!1})=>{for(let J of $){const[Q,W]=XZ(J.toString()),Z=FB(Q,X),Y=ZZ(Z);if(Y){const z=OJ(Y,W);z.splice(0,-1,Y),KB(W,z,X);continue}if(X.request&&X.parse&&X.transform&&X.handle&&X.beforeHandle&&X.afterHandle&&X.error&&X.context&&X.store&&X.set)break}return X},U$=class{constructor($,X,J={}){this.name=$,this.jar=X,this.initial=J}get cookie(){if(!(this.name in this.jar))return this.initial;return this.jar[this.name]}set cookie($){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=$}get value(){return this.cookie.value}set value($){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name].value=$}get expires(){return this.cookie.expires}set expires($){this.cookie.expires=$}get maxAge(){return this.cookie.maxAge}set maxAge($){this.cookie.maxAge=$}get domain(){return this.cookie.domain}set domain($){this.cookie.domain=$}get path(){return this.cookie.path}set path($){this.cookie.path=$}get secure(){return this.cookie.secure}set secure($){this.cookie.secure=$}get httpOnly(){return this.cookie.httpOnly}set httpOnly($){this.cookie.httpOnly=$}get sameSite(){return this.cookie.sameSite}set sameSite($){this.cookie.sameSite=$}get priority(){return this.cookie.priority}set priority($){this.cookie.priority=$}get secrets(){return this.cookie.secrets}set secrets($){this.cookie.secrets=$}update($){return this.cookie=Object.assign(this.cookie,typeof $==="function"?$(this.cookie):$),this}set($){return this.cookie=Object.assign({...this.initial,value:this.value},typeof $==="function"?$(this.cookie):$),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}},vW=($,X,J)=>{if(!$.cookie)$.cookie={};return new Proxy(X,{get(Q,W){if(W in X)return new U$(W,$.cookie,Object.assign({},J??{},X[W]));return new U$(W,$.cookie,Object.assign({},J))}})},qZ=async($,X,{secrets:J,sign:Q,...W}={})=>{if(!X)return vW($,{},W);const Z=typeof J==="string";if(Q&&Q!==!0&&!Array.isArray(Q))Q=[Q];const Y={},z=WJ(X);for(let[q,G]of Object.entries(z)){let B=zZ.default(G);if(Q===!0||Q?.includes(q)){if(!J)throw new Error("No secret is provided to cookie plugin");if(Z){const L=await cW(B,J);if(L===!1)throw new lW(q);B=L}else{let L=!0;for(let b=0;b<J.length;b++){const T=await cW(B,J[b]);if(T!==!1){L=!0,B=T;break}}if(!L)throw new lW(q)}}const H=B.charCodeAt(0);if(H===123||H===91)try{Y[q]={value:JSON.parse(B)};continue}catch{}if(x6(B)){Y[q]={value:parseInt(B)};continue}if(B==="true"){Y[q]={value:!0};continue}if(B==="false"){Y[q]={value:!1};continue}Y[q]={value:B}}return vW($,Y,W)},r$="toJSON"in new Headers,$8=($)=>{if(!$)return!1;for(let X in $)return!0;return!1},a$=($,X)=>{const J=$.size;if(!X&&J||J&&X&&X.status!==206&&X.status!==304&&X.status!==412&&X.status!==416){if(X){if(X.headers instanceof Headers){if(r$)X.headers=X.headers.toJSON();else for(let[Q,W]of X.headers.entries())if(Q in X.headers)X.headers[Q]=W}return new Response($,{status:X.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${J-1}/${J}`},X.headers)})}return new Response($,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${J-1}/${J}`}})}return new Response($)},BZ=($,X)=>{if(!$)return $;$.delete("Set-Cookie");for(let J=0;J<X.length;J++){const Q=X[J].indexOf("=");$.append("Set-Cookie",`${X[J].slice(0,Q)}=${X[J].slice(Q+1)||""}`)}return $},UZ=($)=>{if(!$||!$8($))return;const X=[];for(let[J,Q]of Object.entries($)){if(!J||!Q)continue;const W=Q.value;if(W===void 0||W===null)continue;X.push(ZJ(J,typeof W==="object"?JSON.stringify(W):W+"",Q))}if(X.length===0)return;if(X.length===1)return X[0];return X},a1=($,X,J)=>{if($?.$passthrough)$=$?.[$.$passthrough];if($?.[X8])X.status=$[X8],$=$.response;if($8(X.headers)||X.status!==200||X.redirect||X.cookie){if(typeof X.status==="string")X.status=d6[X.status];if(X.redirect){if(X.headers.Location=X.redirect,!X.status||X.status<300||X.status>=400)X.status=302}if(X.cookie&&$8(X.cookie))X.headers["Set-Cookie"]=UZ(X.cookie);if(X.headers["Set-Cookie"]&&Array.isArray(X.headers["Set-Cookie"]))X.headers=BZ(new Headers(X.headers),X.headers["Set-Cookie"]);switch($?.constructor?.name){case"String":return new Response($,X);case"Blob":return a$($,X);case"Object":case"Array":return Response.json($,X);case"ReadableStream":if(!X.headers["content-type"]?.startsWith("text/event-stream"))X.headers["content-type"]="text/event-stream; charset=utf-8";return J?.signal.addEventListener("abort",{handleEvent(){if(!J?.signal.aborted)$.cancel(J)}},{once:!0}),new Response($,X);case void 0:if(!$)return new Response("",X);return Response.json($,X);case"Response":const Q={...X.headers};if(r$)X.headers=$.headers.toJSON();else for(let[W,Z]of $.headers.entries())if(W in X.headers)X.headers[W]=Z;for(let W in Q)$.headers.append(W,Q[W]);return $;case"Error":return e1($,X);case"Promise":return $.then((W)=>a1(W,X));case"Function":return a1($(),X);case"Number":case"Boolean":return new Response($.toString(),X);case"Cookie":if($ instanceof U$)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response){const W=Object.assign({},X.headers);if(r$)X.headers=$.headers.toJSON();else for(let[Z,Y]of $.headers.entries())if(Z in X.headers)X.headers[Z]=Y;for(let Z in W)$.headers.append(Z,W[Z]);return $}if($ instanceof Promise)return $.then((W)=>a1(W,X));if($ instanceof Error)return e1($,X);if("charCodeAt"in $){const W=$.charCodeAt(0);if(W===123||W===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($,X)}}else switch($?.constructor?.name){case"String":return new Response($);case"Blob":return a$($,X);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"ReadableStream":return J?.signal.addEventListener("abort",{handleEvent(){if(!J?.signal.aborted)$.cancel(J)}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":return $;case"Error":return e1($,X);case"Promise":return $.then((Q)=>{const W=h8(Q);if(W!==void 0)return W;return new Response("")});case"Function":return h8($());case"Number":case"Boolean":return new Response($.toString());case"Cookie":if($ instanceof U$)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response)return new Response($.body,{headers:{"Content-Type":"application/json"}});if($ instanceof Promise)return $.then((Q)=>a1(Q,X));if($ instanceof Error)return e1($,X);if("charCodeAt"in $){const Q=$.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($)}},r1=($,X,J)=>{if($===void 0||$===null)return;if($?.$passthrough)$=$?.[$.$passthrough];if($?.[X8])X.status=$[X8],$=$.response;if($8(X.headers)||X.status!==200||X.redirect||X.cookie){if(typeof X.status==="string")X.status=d6[X.status];if(X.redirect){if(X.headers.Location=X.redirect,!X.status||X.status<300||X.status>=400)X.status=302}if(X.cookie&&$8(X.cookie))X.headers["Set-Cookie"]=UZ(X.cookie);if(X.headers["Set-Cookie"]&&Array.isArray(X.headers["Set-Cookie"]))X.headers=BZ(new Headers(X.headers),X.headers["Set-Cookie"]);switch($?.constructor?.name){case"String":return new Response($,X);case"Blob":return a$($,X);case"Object":case"Array":return Response.json($,X);case"ReadableStream":if(!X.headers["content-type"]?.startsWith("text/event-stream"))X.headers["content-type"]="text/event-stream; charset=utf-8";return J?.signal.addEventListener("abort",{handleEvent(){if(!J?.signal.aborted)$.cancel(J)}},{once:!0}),new Response($,X);case void 0:if(!$)return;return Response.json($,X);case"Response":const Q=Object.assign({},X.headers);if(r$)X.headers=$.headers.toJSON();else for(let[W,Z]of $.headers.entries())if(!(W in X.headers))X.headers[W]=Z;for(let W in Q)$.headers.append(W,Q[W]);if($.status!==X.status)X.status=$.status;return $;case"Promise":return $.then((W)=>{const Z=r1(W,X);if(Z!==void 0)return Z});case"Error":return e1($,X);case"Function":return r1($(),X);case"Number":case"Boolean":return new Response($.toString(),X);case"Cookie":if($ instanceof U$)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response){const W={...X.headers};if(r$)X.headers=$.headers.toJSON();else for(let[Z,Y]of $.headers.entries())if(Z in X.headers)X.headers[Z]=Y;for(let Z in W)$.headers.append(Z,W[Z]);return $}if($ instanceof Promise)return $.then((W)=>r1(W,X));if($ instanceof Error)return e1($,X);if("charCodeAt"in $){const W=$.charCodeAt(0);if(W===123||W===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($,X)}}else switch($?.constructor?.name){case"String":return new Response($);case"Blob":return a$($,X);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"ReadableStream":return J?.signal.addEventListener("abort",{handleEvent(){if(!J?.signal.aborted)$.cancel(J)}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":return $;case"Promise":return $.then((Q)=>{const W=r1(Q,X);if(W!==void 0)return W});case"Error":return e1($,X);case"Function":return h8($());case"Number":case"Boolean":return new Response($.toString());case"Cookie":if($ instanceof U$)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response)return new Response($.body,{headers:{"Content-Type":"application/json"}});if($ instanceof Promise)return $.then((Q)=>r1(Q,X));if($ instanceof Error)return e1($,X);if("charCodeAt"in $){const Q=$.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($)}},h8=($,X)=>{if($?.$passthrough)$=$?.[$.$passthrough];if($?.[X8])return a1($.response,{status:$[X8],headers:{}});switch($?.constructor?.name){case"String":return new Response($);case"Blob":return a$($);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"ReadableStream":return X?.signal.addEventListener("abort",{handleEvent(){if(!X?.signal.aborted)$.cancel(X)}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":return $;case"Error":return e1($);case"Promise":return $.then(h8);case"Function":return h8($());case"Number":case"Boolean":return new Response($.toString());default:if($ instanceof Response)return new Response($.body,{headers:{"Content-Type":"application/json"}});if($ instanceof Promise)return $.then(h8);if($ instanceof Error)return e1($);if("charCodeAt"in $){const J=$.charCodeAt(0);if(J===123||J===91)return new Response(JSON.stringify($),{headers:{"Content-Type":"application/json"}})}return new Response($)}},e1=($,X)=>new Response(JSON.stringify({name:$?.name,message:$?.message,cause:$?.cause}),{status:X?.status!==200?X?.status??500:500,headers:X?.headers}),hW=($,X)=>{const J=new URL($);return J.pathname=X,J.toString()},EB=($)=>typeof $==="function"&&/^\s*class\s+/.test($.toString())||$.toString().startsWith("[object ")||$8(Object.getPrototypeOf($)),UJ=($)=>$&&typeof $==="object"&&!Array.isArray($),V1=($,X,{skipKeys:J}={})=>{if(UJ($)&&UJ(X))for(let[Q,W]of Object.entries(X)){if(J?.includes(Q))continue;if(!UJ(W)||!(Q in $)||EB(W)){$[Q]=W;continue}$[Q]=V1($[Q],W)}return $},IB=($,X)=>{const{properties:J,...Q}=$??{},{properties:W,...Z}=X??{};return V1(Q,Z)},T0=($=[],X=[])=>{if(!$)return[];if(!X)return $;const J=[],Q=[];if(!Array.isArray($))$=[$];if(!Array.isArray(X))X=[X];for(let W of $)if(J.push(W),W.checksum)Q.push(W.checksum);for(let W of X)if(!Q.includes(W.checksum))J.push(W);return J},kB=["start","request","parse","transform","resolve","beforeHandle","afterHandle","onResponse","mapResponse","trace","error","stop","body","headers","params","query","response","type","detail"],xB=kB.reduce(($,X)=>($[X]=!0,$),{}),gB=($,X)=>{const J=(Q)=>typeof Q==="object"&&Object.keys(Q).every(x6);if(J($)&&J(X))return{...$,...X};return X??$},R1=($,X,{allowMacro:J=!1}={})=>{return{...J?{...$,...X}:void 0,body:X?.body??$?.body,headers:X?.headers??$?.headers,params:X?.params??$?.params,query:X?.query??$?.query,response:gB($?.response,X?.response),type:$?.type||X?.type,detail:V1(X?.detail??{},$?.detail??{}),parse:T0($?.parse,X?.parse),transform:T0($?.transform,X?.transform),beforeHandle:T0($?.beforeHandle,X?.beforeHandle),afterHandle:T0($?.afterHandle,X?.afterHandle),onResponse:T0($?.onResponse,X?.onResponse),mapResponse:T0($?.mapResponse,X?.mapResponse),trace:T0($?.trace,X?.trace),error:T0($?.error,X?.error)}},K1=($,{models:X={},dynamic:J=!1,normalize:Q=!1,additionalProperties:W=Q})=>{if(!$)return;if(typeof $==="string"&&!($ in X))return;const Z=typeof $==="string"?X[$]:$;if(Z.type==="object"&&"additionalProperties"in Z===!1)Z.additionalProperties=W;const Y=(q)=>q0.Clean(Z,q);if(J){const q={schema:Z,references:"",checkFunc:()=>{},code:"",Check:(G)=>q0.Check(Z,G),Errors:(G)=>q0.Errors(Z,G),Code:()=>""};if(Q&&Z.additionalProperties===!0)q.Clean=Y;if(Z.config){if(q.config=Z.config,q?.schema?.config)delete q.schema.config}return q}const z=Y$.Compile(Z,Object.values(X));if(z.Clean=Y,Z.config){if(z.config=Z.config,z?.schema?.config)delete z.schema.config}return z},pW=($,{models:X={},dynamic:J=!1,normalize:Q=!1,additionalProperties:W=Q})=>{if(!$)return;if(typeof $==="string"&&!($ in X))return;const Z=typeof $==="string"?X[$]:$,Y=(q,G)=>{const B=(L)=>q0.Clean(q,L);if(J)return{schema:q,references:"",checkFunc:()=>{},code:"",Check:(L)=>q0.Check(q,L),Errors:(L)=>q0.Errors(q,L),Code:()=>""};const H=Y$.Compile(q,G);if(Q&&q.additionalProperties===!0)H.Clean=B;return H};if(D in Z){if("additionalProperties"in Z===!1)Z.additionalProperties=W;return{200:Y(Z,Object.values(X))}}const z={};return Object.keys(Z).forEach((q)=>{const G=Z[+q];if(typeof G==="string"){if(G in X){const B=X[G];B.type==="object"&&"additionalProperties"in B,z[+q]=D in B?Y(B,Object.values(X)):B}return}if(G.type==="object"&&"additionalProperties"in G===!1)G.additionalProperties=W;z[+q]=D in G?Y(G,Object.values(X)):G}),z},TB=typeof Bun!=="undefined",fB=TB&&typeof Bun.hash==="function",K6=($)=>{if(fB)return Bun.hash($);let X=9;for(let J=0;J<$.length;)X=Math.imul(X^$.charCodeAt(J++),387420489);return X=X^X>>>9},wZ=({validator:$,defaultConfig:X={},config:J,dynamic:Q,models:W})=>{let Z=K1($,{dynamic:Q,models:W,additionalProperties:!0});if($8(X))if(Z)Z.config=IB(Z.config,J);else Z=K1(s.Cookie({}),{dynamic:Q,models:W,additionalProperties:!0}),Z.config=X;return Z},wJ=($,X,J)=>{const Q=(W)=>{if(!W)return;if(!Array.isArray(W)){const Y=W;if(J&&!Y.checksum)Y.checksum=J;if(Y.scope==="scoped")Y.scope="local";return Y}const Z=[...W];for(let Y of Z){if(J&&!Y.checksum)Y.checksum=J;if(Y.scope==="scoped")Y.scope="local"}return Z};return{start:T0($.start,Q(X?.start)),request:T0($.request,Q(X?.request)),parse:T0($.parse,Q(X?.parse)),transform:T0($.transform,Q(X?.transform)),beforeHandle:T0($.beforeHandle,Q(X?.beforeHandle)),afterHandle:T0($.afterHandle,Q(X?.afterHandle)),mapResponse:T0($.mapResponse,Q(X?.mapResponse)),onResponse:T0($.onResponse,Q(X?.onResponse)),trace:$.trace,error:T0($.error,Q(X?.error)),stop:T0($.stop,Q(X?.stop))}},yB=($,X,{skipIfHasType:J=!1}={})=>{if(!$)return $;if(!Array.isArray($)){if(J)$.scope??=X;else $.scope=X;return $}for(let Q of $)if(J)Q.scope??=X;else Q.scope=X;return $},d8=($)=>{if(!$)return $;if(!Array.isArray($))switch($.scope){case"global":case"scoped":return{...$};default:return{fn:$}}const X=[];for(let J of $)switch(J.scope){case"global":case"scoped":X.push({...J});break}return X},mW=($)=>{return{...$,type:$?.type,detail:$?.detail,parse:d8($?.parse),transform:d8($?.transform),beforeHandle:d8($?.beforeHandle),afterHandle:d8($?.afterHandle),onResponse:d8($?.onResponse),error:d8($?.error),mapResponse:d8($?.mapResponse)}},d6={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},uW=Object.fromEntries(Object.entries(d6).map(([$,X])=>[X,$])),iW=new TextEncoder,k6=async($,X)=>{if(typeof $!=="string")throw new TypeError("Cookie value must be provided as a string.");if(X===null)throw new TypeError("Secret key must be provided.");const J=await crypto.subtle.importKey("raw",iW.encode(X),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Q=await crypto.subtle.sign("HMAC",J,iW.encode($));return $+"."+dB(Buffer.from(Q).toString("base64"))},cW=async($,X)=>{if(typeof $!=="string")throw new TypeError("Signed cookie string must be provided.");if(X===null)throw new TypeError("Secret key must be provided.");const J=$.slice(0,$.lastIndexOf("."));return await k6(J,X)===$?J:!1},GZ=($,X,J=X)=>{if(!$||typeof $!=="object"||!X)return;for(let[Q,W]of Object.entries(X)){if(Q in xB||!(Q in $))continue;const Z=$[Q];if(typeof Z==="function")Z(W);else if(typeof Z==="object")GZ(Z,W,J)}},vB=({globalHook:$,localHook:X})=>(J)=>(Q,W)=>{if(typeof Q==="function")Q={fn:Q};if("fn"in Q||Array.isArray(Q)){if(!X[J])X[J]=[];if(typeof X[J]==="function")X[J]=[X[J]];if(Array.isArray(Q))X[J]=X[J].concat(Q);else X[J].push(Q);return}const{insert:Z="after",stack:Y="local"}=Q;if(typeof W==="function")W={fn:W};if(Y==="global")if(!Array.isArray(W))if(Z==="before")$[J].unshift(W);else $[J].push(W);else if(Z==="before")$[J]=W.concat($[J]);else $[J]=$[J].concat(W);else{if(!X[J])X[J]=[];if(typeof X[J]==="function")X[J]=[X[J]];if(!Array.isArray(W))if(Z==="before")X[J].unshift(W);else X[J].push(W);else if(Z==="before")X[J]=W.concat(X[J]);else X[J]=X[J].concat(W)}},x6=($)=>{if($.length<16)return $.trim().length!==0&&!Number.isNaN(Number($));if($.length===16){const X=Number($);if(X.toString()===$)return $.trim().length!==0&&!Number.isNaN(X)}return!1},hB=class{constructor($=console.error){this.onError=$,this.root=null,this.promises=[]}get size(){return this.promises.length}add($){return this.promises.push($),this.root||=this.drain(),$}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch($){this.onError($)}this.promises.shift()}this.root=null}then($,X){return(this.root??Promise.resolve()).then($,X)}},j1=($)=>{if(!$)return $;if(!Array.isArray($)){if(typeof $==="function")return{fn:$};else if("fn"in $)return $}const X=[];for(let J of $)if(typeof J==="function")X.push({fn:J});else if("fn"in J)X.push(J);return X},pB=($)=>{return{...$,start:j1($?.start),request:j1($?.request),parse:j1($?.parse),transform:j1($?.transform),beforeHandle:j1($?.beforeHandle),afterHandle:j1($?.afterHandle),onResponse:j1($?.onResponse),mapResponse:j1($?.mapResponse),trace:j1($?.trace),error:j1($?.error),stop:j1($?.stop)}},mB=($)=>{return{...$,start:$.start?.map((X)=>X.fn),request:$.request?.map((X)=>X.fn),parse:$.parse?.map((X)=>X.fn),transform:$.transform?.map((X)=>X.fn),beforeHandle:$.beforeHandle?.map((X)=>X.fn),afterHandle:$.afterHandle?.map((X)=>X.fn),onResponse:$.onResponse?.map((X)=>X.fn),mapResponse:$.mapResponse?.map((X)=>X.fn),trace:$.trace?.map((X)=>X.fn),error:$.error?.map((X)=>X.fn),stop:$.stop?.map((X)=>X.fn)}},GJ=($)=>({event:{body:$.event.body,cookie:$.event.cookie,headers:$.event.headers,queries:[...$.event.queries],query:$.event.query,set:$.event.set,unknownQueries:$.event.unknownQueries},trace:{request:$.trace.request,parse:$.trace.parse,transform:$.trace.transform,handle:$.trace.handle,beforeHandle:$.trace.beforeHandle,afterHandle:$.trace.afterHandle,error:$.trace.error,context:$.trace.context,store:$.trace.store,set:$.trace.set}}),oW=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,g6=Symbol("ElysiaErrorCode"),X8=Symbol("ElysiaResponse"),T6=(oW?.NODE_ENV??oW?.ENV)==="production",uB=($,X)=>({[X8]:d6[$]??$,response:X??($ in uW?uW[$]:$),_type:void 0}),iB=class extends Error{constructor($){super($??"INTERNAL_SERVER_ERROR");this.code="INTERNAL_SERVER_ERROR",this.status=500}},LJ=class extends Error{constructor($){super($??"NOT_FOUND");this.code="NOT_FOUND",this.status=404}},cB=class extends Error{constructor($,X){super($??"PARSE");this.body=X,this.code="PARSE",this.status=400}},lW=class extends Error{constructor($,X){super(X??`"${$}" has invalid cookie signature`);this.key=$,this.code="INVALID_COOKIE_SIGNATURE",this.status=400}},f0=class $ extends Error{constructor(X,J,Q){if(typeof Q==="object"&&X8 in Q)Q=Q.response;const W=T6?void 0:("Errors"in J)?J.Errors(Q).First():q0.Errors(J,Q).First(),Z=W?.schema.error?typeof W.schema.error==="function"?W.schema.error(X,J,Q):W.schema.error:void 0,Y=W?.path||"root";let z="";if(Z)z=typeof Z==="object"?JSON.stringify(Z):Z+"";else if(T6)z=JSON.stringify({type:"validation",on:X,message:W?.message,found:Q});else{const q=J?.schema??J,G="Errors"in J?[...J.Errors(Q)]:[...q0.Errors(J,Q)];let B;try{B=q0.Create(q)}catch(H){B={type:"Could not create expected value",message:H?.message,error:H}}z=JSON.stringify({type:"validation",on:X,property:Y,message:W?.message,expected:B,found:Q,errors:G},null,2)}super(z);this.type=X,this.validator=J,this.value=Q,this.code="VALIDATION",this.status=422,Object.setPrototypeOf(this,$.prototype)}get all(){return[...this.validator.Errors(this.value)]}static simplifyModel(X){const J="schema"in X?X.schema:X;try{return q0.Create(J)}catch{return J}}get model(){return $.simplifyModel(this.validator)}toResponse(X){return new Response(this.message,{status:400,headers:{...X,"content-type":"application/json"}})}},nW={open($){$.data.open?.($)},message($,X){$.data.message?.($,X)},drain($){$.data.drain?.($)},close($,X,J){$.data.close?.($,X,J)}},V6=class{constructor($,X){if(this.raw=$,this.data=X,this.validator=$.data.validator,$.data.id)this.id=$.data.id;else{const J=new Uint32Array(1);crypto.getRandomValues(J),this.id=J[0].toString()}}get id(){return this.raw.data.id}set id($){this.raw.data.id=$}get publish(){return($,X=void 0,J)=>{if(this.validator?.Check(X)===!1)throw new f0("message",this.validator,X);if(typeof X==="object")X=JSON.stringify(X);return this.raw.publish($,X,J),this}}get send(){return($)=>{if(this.validator?.Check($)===!1)throw new f0("message",this.validator,$);if(Buffer.isBuffer($))return this.raw.send($),this;if(typeof $==="object")$=JSON.stringify($);return this.raw.send($),this}}get subscribe(){return($)=>{return this.raw.subscribe($),this}}get unsubscribe(){return($)=>{return this.raw.unsubscribe($),this}}get cork(){return($)=>{return this.raw.cork($),this}}get close(){return()=>{return this.raw.close(),this}}get terminate(){return this.raw.terminate.bind(this.raw)}get isSubscribed(){return this.raw.isSubscribed.bind(this.raw)}get remoteAddress(){return this.raw.remoteAddress}},oB=(new Headers()).toJSON,HZ={value:0},NZ=({hasTrace:$,hasTraceSet:X=!1,addFn:J,condition:Q={}})=>{if($)return J(`
const reporter = getReporter()
`),(W,{name:Z,attribute:Y="",unit:z=0}={})=>{const q=W.indexOf("."),G=q===-1;if(W!=="request"&&W!=="response"&&!Q[G?W:W.slice(0,q)])return()=>{if(X&&W==="afterHandle")J(`
await traceDone
`)};if(G)Z||=W;else Z||="anonymous";return J("\n"+`reporter.emit('event', {
					id,
					event: '${W}',
					type: 'begin',
					name: '${Z}',
					time: performance.now(),
					${G?`unit: ${z},`:""}
					${Y}
				})`.replace(/(\t| |\n)/g,"")+"\n"),()=>{if(J("\n"+`reporter.emit('event', {
							id,
							event: '${W}',
							type: 'end',
							time: performance.now()
						})`.replace(/(\t| |\n)/g,"")+"\n"),X&&W==="afterHandle")J(`
await traceDone
`)}};else return()=>()=>{}},s$=($)=>{const X=$.indexOf(")");if($.charCodeAt(X+2)===61&&$.charCodeAt(X+5)!==123)return!0;return $.includes("return")},lB=($,{injectResponse:X="",normalize:J=!1}={})=>({composeValidation:(Q,W=`c.${Q}`)=>$?`c.set.status = 422; throw new ValidationError('${Q}', ${Q}, ${W})`:`c.set.status = 422; return new ValidationError('${Q}', ${Q}, ${W}).toResponse(c.set.headers)`,composeResponseValidation:(Q="r")=>{const W=$?`throw new ValidationError('response', response[c.set.status], ${Q})`:`return new ValidationError('response', response[c.set.status], ${Q}).toResponse(c.set.headers)`;let Z="\n"+X+"\n";if(Z+=`let er
		
		if(${Q} && typeof ${Q} === "object" && ELYSIA_RESPONSE in ${Q})
			er = ${Q}[ELYSIA_RESPONSE]
`,J)Z+=`
			if(!er && response[c.set.status]?.Clean)
				${Q} = response[c.set.status]?.Clean(${Q})
			else if(response[er]?.Clean)
				${Q}.response = response[er]?.Clean(${Q}.response)`;return Z+=`
			if(er) {
				if(!(${Q} instanceof Response) && response[er]?.Check(${Q}.response) === false) {
					if(!(response instanceof Error)) {
						c.set.status = ${Q}[ELYSIA_RESPONSE]

						${W}
					}
				}
			} else if(!(${Q} instanceof Response) && response[c.set.status]?.Check(${Q}) === false) {
				if(!(response instanceof Error))
					${W}
			}
`,Z}}),q$=Symbol.for("TypeBox.Kind"),f6=($,X)=>{if(!X)return;if(q$ in X&&X[q$]===$)return!0;if(X.type==="object"){const J=X.properties;for(let Q of Object.keys(J)){const W=J[Q];if(W.type==="object"){if(f6($,W))return!0}else if(W.anyOf){for(let Z=0;Z<W.anyOf.length;Z++)if(f6($,W.anyOf[Z]))return!0}if(q$ in W&&W[q$]===$)return!0}return!1}return X.properties&&q$ in X.properties&&X.properties[q$]===$},v8=($,X)=>{if(!X)return;if(X.type==="object"){const J=X.properties;if(!J)return!1;for(let Q of Object.keys(J)){const W=J[Q];if($ in W)return!0;if(W.type==="object"){if(v8($,W))return!0}else if(W.anyOf){for(let Z=0;Z<W.anyOf.length;Z++)if(v8($,W.anyOf[Z]))return!0}}return!1}return $ in X},MJ=Symbol.for("TypeBox.Transform"),B$=($)=>{if(!$)return;if($.type==="object"&&$.properties){const X=$.properties;for(let J of Object.keys(X)){const Q=X[J];if(Q.type==="object"){if(B$(Q))return!0}else if(Q.anyOf){for(let Z=0;Z<Q.anyOf.length;Z++)if(B$(Q.anyOf[Z]))return!0}if(MJ in Q)return!0}return!1}return MJ in $||$.properties&&MJ in $.properties},nB=($)=>{if(!$)return;const X=$?.schema;if(X&&"anyOf"in X){let J=!1;const Q=X.anyOf[0].type;for(let W of X.anyOf)if(W.type!==Q){J=!0;break}if(!J)return Q}return $.schema?.type},tB=/(?:return|=>) \S+\(/g,p0=($)=>{const X="fn"in $?$.fn:$;if(X.constructor.name==="AsyncFunction")return!0;const J=X.toString();if(J.includes("=> response.clone("))return!1;return!!J.match(tB)},AJ=({app:$,path:X,method:J,localHook:Q,hooks:W,validator:Z,handler:Y,allowMeta:z=!1,appInference:{event:q,trace:G}})=>{const B=typeof Y==="function";if(!B)Y=a1(Y,{headers:$.setHeaders??{}});const H=$.config.forceErrorEncapsulation&&(B||W.afterHandle.length>0||W.beforeHandle.length>0||W.transform.length>0)||W.error.length>0||$.event.error.length>0||typeof Bun==="undefined"||W.onResponse.length>0||W.onResponse.length>0||!!W.trace.length,L=B?"handler(c)":"handler",b=W.onResponse.length?`
;(async () => {${W.onResponse.map((x,_)=>`await res${_}(c)`).join(";")}})();
`:"",T=G,K=W.trace.length>0;let A="";const P=YZ(Object.assign(Q,{handler:Y}),q),g=P.query||!!Z.query,I=J!=="$INTERNALWS"&&J!=="GET"&&J!=="HEAD"&&W.type!=="none"&&(P.body||!!Z.body),J0=$.setHeaders,U0=J0&&!!Object.keys(J0).length,t0=P.headers||Z.headers,y1=P.cookie||!!Z.cookie,m0=y1?wZ({validator:Z.cookie,defaultConfig:$.config.cookie,dynamic:!!$.config.aot,config:Z.cookie?.config??{},models:$.definitions.type}):void 0,A0=m0?.config;let Q0="";if(A0?.sign){if(!A0.secrets)throw new Error(`t.Cookie required secret which is not set in (${J}) ${X}.`);const x=!A0.secrets?void 0:typeof A0.secrets==="string"?A0.secrets:A0.secrets[0];if(Q0+=`const _setCookie = c.set.cookie
		if(_setCookie) {`,A0.sign===!0)Q0+=`for(const [key, cookie] of Object.entries(_setCookie)) {
				c.set.cookie[key].value = await signCookie(cookie.value, '${x}')
			}`;else for(let _ of A0.sign)Q0+=`if(_setCookie['${_}']?.value) { c.set.cookie['${_}'].value = await signCookie(_setCookie['${_}'].value, '${x}') }
`;Q0+="}\n"}const m=$.config.normalize,{composeValidation:Z1,composeResponseValidation:p8}=lB(H,{normalize:m});if(t0)A+=oB?`c.headers = c.request.headers.toJSON()
`:`c.headers = {}
                for (const [key, value] of c.request.headers.entries())
					c.headers[key] = value
				`;if(y1){const x=(R,i)=>{const S0=A0?.[R]??i;if(!S0)return typeof i==="string"?`${R}: "${i}",`:`${R}: ${i},`;if(typeof S0==="string")return`${R}: '${S0}',`;if(S0 instanceof Date)return`${R}: new Date(${S0.getTime()}),`;return`${R}: ${S0},`},_=A0?`{
			secrets: ${A0.secrets!==void 0?typeof A0.secrets==="string"?`'${A0.secrets}'`:"["+A0.secrets.reduce((R,i)=>R+`'${i}',`,"")+"]":"undefined"},
			sign: ${A0.sign===!0?!0:A0.sign!==void 0?"["+A0.sign.reduce((R,i)=>R+`'${i}',`,"")+"]":"undefined"},
			${x("domain")}
			${x("expires")}
			${x("httpOnly")}
			${x("maxAge")}
			${x("path","/")}
			${x("priority")}
			${x("sameSite")}
			${x("secure")}
		}`:"undefined";if(t0)A+=`
c.cookie = await parseCookie(c.set, c.headers.cookie, ${_})
`;else A+=`
c.cookie = await parseCookie(c.set, c.request.headers.get('cookie'), ${_})
`}if(g){let x=[];if(Z.query&&Z.query.schema.type==="object")x=Object.keys(Z.query.schema.properties);else for(let _ of P.queries)if(x.indexOf(_)===-1)x.push(_);if($.config.forceDynamicQuery===!0||P.unknownQueries===!0||!x.length)A+=`if(c.qi !== -1) {
				c.query = parseQuery(c.request.url.slice(c.qi + 1).replace(/\\+/g, ' '))

				for(const key of Object.keys(c.query))
					c.query[key] = decodeURIComponent(c.query[key])
			} else c.query = {}`;else A+=`if(c.qi !== -1) {
				let url = c.request.url.slice(c.qi).replace(/\\+/g, ' ')

				${x.map((_,R)=>`
						${R===0?"let":""} memory = url.indexOf('&${_}=')
						if(memory === -1) memory = url.indexOf('?${_}=')
						let a${R}

						if(memory !== -1) {
							const start = memory + ${_.length+2}
							memory = url.indexOf('&', start)

							if(memory === -1) a${R} = decodeURIComponent(url.slice(start))
							else a${R} = decodeURIComponent(url.slice(start, memory))
						}`).join("\n")}

				c.query = {
					${x.map((_,R)=>`'${_}': a${R}`).join(", ")}
				}
			} else {
				c.query = {}
			}`}const m8=G.set,u8=P.cookie||P.set||m8||t0||B&&U0;if(K)A+="\nconst id = c.$$requestId\n";const L0=NZ({hasTrace:K,hasTraceSet:m8,condition:T,addFn:(x)=>{A+=x}});if(A+=H?"\n try {\n":"",m8){A+=`
const traceDone = Promise.all([`;for(let x=0;x<W.trace.length;x++)A+=`new Promise(r => { reporter.once(\`res\${id}.${x}\`, r) }),`;A+=`])
`}const A8=typeof Y==="function"&&p0(Y),J8=y1||I||m8||A8||!!W.mapResponse.length||W.parse.length>0||W.afterHandle.some(p0)||W.beforeHandle.some(p0)||W.transform.some(p0),k0=L0("parse",{unit:W.parse.length});if(I){const x=nB(Z?.body);if(W.type&&!Array.isArray(W.type)){if(W.type)switch(W.type){case"json":case"application/json":if(H)A+=`const tempBody = await c.request.text()
							
							try {
								c.body = JSON.parse(tempBody)
							} catch {
								throw new ParseError('Failed to parse body as found: ' + (typeof body === "string" ? "'" + body + "'" : body), body)
							}`;else A+="c.body = await c.request.json()";break;case"text":case"text/plain":A+=`c.body = await c.request.text()
`;break;case"urlencoded":case"application/x-www-form-urlencoded":A+=`c.body = parseQuery(await c.request.text())
`;break;case"arrayBuffer":case"application/octet-stream":A+=`c.body = await c.request.arrayBuffer()
`;break;case"formdata":case"multipart/form-data":A+=`c.body = {}

						const form = await c.request.formData()
						for (const key of form.keys()) {
							if (c.body[key])
								continue

							const value = form.getAll(key)
							if (value.length === 1)
								c.body[key] = value[0]
							else c.body[key] = value
						}
`;break}if(W.parse.length)A+="}}"}else{const R=(()=>{if(W.parse.length&&x&&!Array.isArray(W.type)){const i=Z?.body?.schema;if(typeof i==="object"&&(f6("File",i)||f6("Files",i)))return`c.body = {}

								const form = await c.request.formData()
								for (const key of form.keys()) {
									if (c.body[key])
										continue

									const value = form.getAll(key)
									if (value.length === 1)
										c.body[key] = value[0]
									else c.body[key] = value
								}`}})();if(R)A+=R;else{if(A+="\n",A+=t0?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",A+=`
				if (contentType) {
					const index = contentType.indexOf(';')
					if (index !== -1) contentType = contentType.substring(0, index)
`,W.parse.length){A+=`let used = false
`;const i=L0("parse",{unit:W.parse.length});for(let S0=0;S0<W.parse.length;S0++){const H8=L0("parse.unit",{name:W.parse[S0].fn.name}),d1=`bo${S0}`;if(S0!==0)A+=`if(!used) {
`;if(A+=`let ${d1} = parse[${S0}](c, contentType)
`,A+=`if(${d1} instanceof Promise) ${d1} = await ${d1}
`,A+=`if(${d1} !== undefined) { c.body = ${d1}; used = true }
`,H8(),S0!==0)A+="}"}i()}if(W.parse.length)A+="if (!used)";A+=`
				switch (contentType) {
					case 'application/json':
						${H?`
						const tempBody = await c.request.text()
						
						try {
							c.body = JSON.parse(tempBody)
						} catch {
							throw new ParseError('Failed to parse body as found: ' + (typeof body === "string" ? "'" + body + "'" : body), body)
						}
						`:`c.body = await c.request.json()
`}
						break

					case 'text/plain':
						c.body = await c.request.text()
						break

					case 'application/x-www-form-urlencoded':
						c.body = parseQuery(await c.request.text())
						break

					case 'application/octet-stream':
						c.body = await c.request.arrayBuffer();
						break

					case 'multipart/form-data':
						c.body = {}

						const form = await c.request.formData()
						for (const key of form.keys()) {
							if (c.body[key])
								continue

							const value = form.getAll(key)
							if (value.length === 1)
								c.body[key] = value[0]
							else c.body[key] = value
						}

						break
					}
`,A+="}\n"}}A+="\n"}if(k0(),W?.transform){const x=L0("transform",{unit:W.transform.length});if(W.transform.length)A+="\nlet transformed\n";for(let _=0;_<W.transform.length;_++){const R=W.transform[_],i=L0("transform.unit",{name:R.fn.name});A+=p0(R)?`transformed = await transform[${_}](c)
`:`transformed = transform[${_}](c)
`,A+=`if(transformed?.[ELYSIA_RESPONSE])
				throw transformed
			else
				Object.assign(c, transformed)
`,i()}x()}if(Z){if(A+="\n",Z.headers){if(v8("default",Z.headers.params))for(let[x,_]of Object.entries(q0.Default(Z.headers.schema,{}))){const R=typeof _==="object"?JSON.stringify(_):`'${_}'`;if(R)A+=`c.headers['${x}'] ??= ${R}
`}if(A+=`if(headers.Check(c.headers) === false) {
				${Z1("headers")}
			}`,B$(Z.headers.schema))A+=`
c.headers = headers.Decode(c.headers)
`}if(Z.params){if(v8("default",Z.params.schema))for(let[x,_]of Object.entries(q0.Default(Z.params.schema,{}))){const R=typeof _==="object"?JSON.stringify(_):`'${_}'`;if(R)A+=`c.params['${x}'] ??= ${R}
`}if(A+=`if(params.Check(c.params) === false) {
				${Z1("params")}
			}`,B$(Z.params.schema))A+=`
c.params = params.Decode(c.params)
`}if(Z.query){if(m)A+="c.query = query.Clean(c.query);\n";if(v8("default",Z.query.schema))for(let[x,_]of Object.entries(q0.Default(Z.query.schema,{}))){const R=typeof _==="object"?JSON.stringify(_):`'${_}'`;if(R)A+=`c.query['${x}'] ??= ${R}
`}if(A+=`if(query.Check(c.query) === false) {
				${Z1("query")}
			}`,B$(Z.query.schema))A+=`
c.query = query.Decode(Object.assign({}, c.query))
`}if(Z.body){if(m)A+="c.body = body.Clean(c.body);\n";if(v8("default",Z.body.schema))A+=`if(body.Check(c.body) === false) {
    				c.body = Object.assign(${JSON.stringify(q0.Default(Z.body.schema,null)??{})}, c.body)

    				if(body.Check(c.query) === false) {
        				${Z1("body")}
     			}
            }`;else A+=`if(body.Check(c.body) === false) {
			${Z1("body")}
		}`;if(B$(Z.body.schema))A+=`
c.body = body.Decode(c.body)
`}if($8(m0?.schema.properties??{})){if(A+=`const cookieValue = {}
    			for(const [key, value] of Object.entries(c.cookie))
    				cookieValue[key] = value.value
`,v8("default",m0.schema))for(let[x,_]of Object.entries(q0.Default(m0.schema,{})))A+=`cookieValue['${x}'] = ${typeof _==="object"?JSON.stringify(_):_}
`;A+=`if(cookie.Check(cookieValue) === false) {
				${Z1("cookie","cookieValue")}
			}`}}if(W?.beforeHandle){const x=L0("beforeHandle",{unit:W.beforeHandle.length});let _=!1;for(let R=0;R<W.beforeHandle.length;R++){const i=W.beforeHandle[R],S0=L0("beforeHandle.unit",{name:i.fn.name}),H8=s$(i.fn.toString());if(i.subType==="resolve"){if(!_)_=!0,A+="\nlet resolved\n";A+=p0(i)?`resolved = await beforeHandle[${R}](c);
`:`resolved = beforeHandle[${R}](c);
`,A+=`if(resolved[ELYSIA_RESPONSE])
						throw resolved
					else
						Object.assign(c, resolved)
`}else if(!H8)A+=p0(i)?`await beforeHandle[${R}](c);
`:`beforeHandle[${R}](c);
`,S0();else{A+="Object.assign(c, be);",A+=p0(i)?`be = await beforeHandle[${R}](c);
`:`be = beforeHandle[${R}](c);
`,S0(),A+=`if(be !== undefined) {
`,x();const h6=L0("afterHandle",{unit:W.transform.length});if(W.afterHandle){L0("handle",{name:B?Y.name:void 0})();for(let U=0;U<W.afterHandle.length;U++){const F=W.afterHandle[U],M=s$(F.fn.toString()),f=L0("afterHandle.unit",{name:F.fn.name});if(A+=`c.response = be
`,!M)A+=p0(F.fn)?`await afterHandle[${U}](c, be)
`:`afterHandle[${U}](c, be)
`;else A+=p0(F.fn)?`af = await afterHandle[${U}](c)
`:`af = afterHandle[${U}](c)
`,A+=`if(af !== undefined) { c.response = be = af }
`;f()}}if(h6(),Z.response)A+=p8("be");if(W.mapResponse.length){A+="c.response = be";for(let U=0;U<W.mapResponse.length;U++)A+=`
if(mr === undefined) {
							mr = onMapResponse[${U}](c)
							if(mr instanceof Promise) mr = await mr
							if(mr !== undefined) c.response = mr
						}
`}A+=Q0,A+=`return mapEarlyResponse(be, c.set, c.request)}
`}}x()}if(W?.afterHandle.length){const x=L0("handle",{name:B?Y.name:void 0});if(W.afterHandle.length)A+=A8?`let r = c.response = await ${L};
`:`let r = c.response = ${L};
`;else A+=A8?`let r = await ${L};
`:`let r = ${L};
`;x();const _=L0("afterHandle",{unit:W.afterHandle.length});for(let R=0;R<W.afterHandle.length;R++){const i=W.afterHandle[R],S0=s$(i.fn.toString()),H8=L0("afterHandle.unit",{name:i.fn.name});if(!S0)A+=p0(i.fn)?`await afterHandle[${R}](c)
`:`afterHandle[${R}](c)
`,H8();else if(A+=p0(i.fn)?`af = await afterHandle[${R}](c)
`:`af = afterHandle[${R}](c)
`,H8(),Z.response)A+="if(af !== undefined) {",_(),A+=p8("af"),A+="c.response = af }";else A+="if(af !== undefined) {",_(),A+=`c.response = af}
`}if(_(),A+=`r = c.response
`,Z.response)A+=p8();if(A+=Q0,W.mapResponse.length)for(let R=0;R<W.mapResponse.length;R++)A+=`
mr = onMapResponse[${R}](c)
				if(mr instanceof Promise) mr = await mr
				if(mr !== undefined) c.response = mr
`;if(u8)A+=`return mapResponse(r, c.set, c.request)
`;else A+=`return mapCompactResponse(r, c.request)
`}else{const x=L0("handle",{name:B?Y.name:void 0});if(Z.response||W.mapResponse.length){if(A+=A8?`let r = await ${L};
`:`let r = ${L};
`,x(),Z.response)A+=p8();if(L0("afterHandle")(),W.mapResponse.length){A+="c.response = r";for(let _=0;_<W.mapResponse.length;_++)A+=`
if(mr === undefined) { 
						mr = onMapResponse[${_}](c)
						if(mr instanceof Promise) mr = await mr
    					if(mr !== undefined) r = c.response = mr
					}
`}if(A+=Q0,Y instanceof Response)A+=P.set?`if(
					isNotEmpty(c.set.headers) ||
					c.set.status !== 200 ||
					c.set.redirect ||
					c.set.cookie
				)
					return mapResponse(${L}.clone(), c.set, c.request)
				else
					return ${L}.clone()`:`return ${L}.clone()`,A+="\n";else if(u8)A+=`return mapResponse(r, c.set, c.request)
`;else A+=`return mapCompactResponse(r, c.request)
`}else if(T.handle||y1){if(A+=A8?`let r = await ${L};
`:`let r = ${L};
`,x(),L0("afterHandle")(),W.mapResponse.length){A+="c.response = r";for(let _=0;_<W.mapResponse.length;_++)A+=`
if(mr === undefined) {
							mr = onMapResponse[${_}](c)
							if(mr instanceof Promise) mr = await mr
    						if(mr !== undefined) r = c.response = mr
						}
`}if(A+=Q0,u8)A+=`return mapResponse(r, c.set, c.request)
`;else A+=`return mapCompactResponse(r, c.request)
`}else{x();const _=A8?`await ${L}`:L;if(L0("afterHandle")(),Y instanceof Response)A+=P.set?`if(
					isNotEmpty(c.set.headers) ||
					c.set.status !== 200 ||
					c.set.redirect ||
					c.set.cookie
				)
					return mapResponse(${L}.clone(), c.set, c.request)
				else
					return ${L}.clone()`:`return ${L}.clone()`,A+="\n";else if(u8)A+=`return mapResponse(${_}, c.set, c.request)
`;else A+=`return mapCompactResponse(${_}, c.request)
`}}if(H||b){if(A+=`
} catch(error) {`,!J8)A+="return (async () => {";A+=`const set = c.set
if (!set.status || set.status < 300) set.status = error?.status || 500
`;const x=L0("error",{unit:W.error.length});if(W.error.length){A+=`
				c.error = error
				c.code = error.code ?? error[ERROR_CODE] ?? "UNKNOWN"
			`;for(let _=0;_<W.error.length;_++){const R=`er${_}`,i=L0("error.unit",{name:W.error[_].fn.name});if(A+=`
let ${R} = handleErrors[${_}](c)
`,p0(W.error[_]))A+=`if (${R} instanceof Promise) ${R} = await ${R}
`;i(),A+=`${R} = mapEarlyResponse(${R}, set, c.request)
`,A+=`if (${R}) {`,A+=`return ${R} }
`}}if(x(),A+=`return handleError(c, error, true)

`,!J8)A+="})()";if(A+="}",b||K){A+=" finally { ";const _=L0("response",{unit:W.onResponse.length});A+=b,_(),A+="}"}}return A=`const {
		handler,
		handleError,
		hooks: {
			transform,
			resolve,
			beforeHandle,
			afterHandle,
			mapResponse: onMapResponse,
			parse,
			error: handleErrors,
			onResponse
		},
		validator: {
			body,
			headers,
			params,
			query,
			response,
			cookie
		},
		utils: {
			mapResponse,
			mapCompactResponse,
			mapEarlyResponse,
			parseQuery,
			isNotEmpty
		},
		error: {
			NotFoundError,
			ValidationError,
			InternalServerError,
			ParseError
		},
		schema,
		definitions,
		ERROR_CODE,
		getReporter,
		requestId,
		parseCookie,
		signCookie,
		decodeURIComponent,
		ELYSIA_RESPONSE
	} = hooks

	${W.onResponse.length?`const ${W.onResponse.map((x,_)=>`res${_} = onResponse[${_}]`).join(",")}`:""}

	return ${J8?"async":""} function handle(c) {
		${W.beforeHandle.length?"let be":""}
		${W.afterHandle.length?"let af":""}
		${W.mapResponse.length?"let mr":""}

		${z?"c.schema = schema; c.defs = definitions":""}
		${A}
	}`,Function("hooks",A)({handler:Y,hooks:mB(W),validator:Z,handleError:$.handleError,utils:{mapResponse:a1,mapCompactResponse:h8,mapEarlyResponse:r1,parseQuery:MZ.parse,isNotEmpty:$8},error:{NotFoundError:LJ,ValidationError:f0,InternalServerError:iB,ParseError:cB},schema:$.router.history,definitions:$.definitions.type,ERROR_CODE:g6,getReporter:()=>$.reporter,requestId:HZ,parseCookie:qZ,signCookie:k6,decodeURIComponent:AZ.default,ELYSIA_RESPONSE:X8})},tW=($)=>{const X={event:{...$.inference.event,queries:[...$.inference.event.queries]},trace:{...$.inference.trace}};let J="",Q="";const W=$.setHeaders;for(let A of Object.keys($.singleton.decorator))J+=`,${A}: app.singleton.decorator.${A}`;const Z=$.router,Y=$.event.trace.length>0;let z=`
	const route = router.find(request.method, path) ${Z.http.root.ALL?'?? router.find("ALL", path)':""}

	if (route === null)
		return ${$.event.error.length?"app.handleError(ctx, notFound)":$.event.request.length?`new Response(error404Message, {
					status: ctx.set.status === 200 ? 404 : ctx.set.status,
					headers: ctx.set.headers
				})`:"error404.clone()"}

	ctx.params = route.params
`;if(!($.config.precompile===!0||typeof $.config.precompile==="object"&&$.config.precompile.compose===!0))z+=`
			if(route.store.composed)
				return route.store.composed(ctx)

			if(route.store.compose)
				return (route.store.compose())(ctx)`;else z+="return route.store(ctx)";z+="\n";let G="";for(let[A,{code:P,all:g}]of Object.entries(Z.static.http.map))G+=`case '${A}':
switch(request.method) {
${P}
${g??"default: break map"}}

`;const B=$.event.request.some(p0),H=`

	const url = request.url
	const s = url.indexOf('/', 11)
	const qi = url.indexOf('?', s + 1)
	let path
	if(qi === -1)
		path = url.substring(s)
	else 
		path = url.substring(s, qi)
`;if(Q+=`const {
		app,
		mapEarlyResponse,
		NotFoundError,
		requestId,
		getReporter,
		handleError,
		error
	} = data

	const store = app.singleton.store
	const staticRouter = app.router.static.http
	const wsRouter = app.router.ws
	const router = app.router.http

	const notFound = new NotFoundError()

	${$.event.request.length?"const onRequest = app.event.request.map(x => x.fn)":""}
	${Z.static.http.variables}
	${$.event.error.length?"":`
	const error404Message = notFound.message.toString()
	const error404 = new Response(error404Message, { status: 404 });
	`}

	return ${B?"async":""} function map(request) {
`,$.event.request.length)Q+="let re";const L=NZ({hasTrace:Y,hasTraceSet:X.trace.set,condition:{request:X.trace.request},addFn:(A)=>{Q+=A}});if($.event.request.length){Q+=`
			${Y?"const id = +requestId.value++":""}

			const ctx = {
				request,
				store,
				set: {
					headers: ${Object.keys(W??{}).length?"Object.assign({}, app.setHeaders)":"{}"},
					status: 200
				},
				error
				${Y?",$$requestId: +id":""}
				${J}
			}
		`;const A=L("request",{attribute:"ctx",unit:$.event.request.length});Q+=`
 try {
`;for(let P=0;P<$.event.request.length;P++){const g=$.event.request[P],I=s$(g.fn.toString()),J0=p0(g),U0=L("request.unit",{name:$.event.request[P].fn.name});if(I)Q+=`re = mapEarlyResponse(
					${J0?"await":""} onRequest[${P}](ctx),
					ctx.set,
					request
				)
`,U0(),Q+=`if(re !== undefined) return re
`;else Q+=`${J0?"await":""} onRequest[${P}](ctx)
`,U0()}Q+=`} catch (error) {
			return app.handleError(ctx, error)
		}`,A(),Q+=H,Q+=`
ctx.qi = qi
 ctx.path = path
`}else Q+=H,Q+=`${Y?"const id = +requestId.value++":""}
		const ctx = {
			request,
			store,
			qi,
			path,
			set: {
				headers: ${Object.keys(W??{}).length?"Object.assign({}, app.setHeaders)":"{}"},
				status: 200
			},
			error
			${Y?",$$requestId: id":""}
			${J}
		}`,L("request",{unit:$.event.request.length,attribute:X.trace.context||X.trace.store||X.trace.set?"ctx":""})();const b=$.router.static.ws,T=$.router.ws;if(Object.keys(b).length||T.history.length){Q+=`
			if(request.method === 'GET') {
				switch(path) {`;for(let[A,P]of Object.entries(b))Q+=`
					case '${A}':
						if(request.headers.get('upgrade') === 'websocket')
							return st${P}(ctx)

						break`;Q+=`
				default:
					if(request.headers.get('upgrade') === 'websocket') {
						const route = wsRouter.find('ws', path)

						if(route) {
							ctx.params = route.params

							return route.store(ctx)
						}
					}

					break
			}
		}
`}Q+=`
		map: switch(path) {
			${G}

			default:
				break
		}

		${z}
	}`;const K=DZ($);return $.handleError=K,Function("data",Q)({app:$,mapEarlyResponse:r1,NotFoundError:LJ,getReporter:()=>$.reporter,requestId:HZ,handleError:K,error:uB})},DZ=($)=>{let X=`const {
		app: { event: { error: onErrorContainer, onResponse: resContainer } },
		mapResponse,
		ERROR_CODE,
		ELYSIA_RESPONSE
	} = inject

	const onError = onErrorContainer.map(x => x.fn)
	const res = resContainer.map(x => x.fn)

	return ${$.event.error.find(p0)?"async":""} function(context, error, skipGlobal) {
		let r

		const { set } = context

		context.code = error.code
		context.error = error

		if(ELYSIA_RESPONSE in error) {
			error.status = error[ELYSIA_RESPONSE]
			error.message = error.response
		}
`;for(let J=0;J<$.event.error.length;J++){const Q=$.event.error[J],W=`${p0(Q)?"await ":""}onError[${J}](context)`;if(X+="\nif(skipGlobal !== true) {\n",s$(Q.fn.toString()))X+=`r = ${W}; if(r !== undefined) {
				if(r instanceof Response) return r

				if(r[ELYSIA_RESPONSE]) {
					error.status = error[ELYSIA_RESPONSE]
					error.message = error.response
				}
		
				if(set.status === 200) set.status = error.status
				return mapResponse(r, set, context.request)
			}
`;else X+=W+"\n";X+="\n}\n"}return X+=`if(error.constructor.name === "ValidationError" || error.constructor.name === "TransformDecodeError") {
		set.status = error.status ?? 422
		return new Response(
			error.message,
			{ 
				headers: Object.assign(
					{ 'content-type': 'application/json'}, 
					set.headers
				), 
				status: set.status
			}
		)
	} else {
		if(error.code && typeof error.status === "number")
			return new Response(
				error.message,
				{ headers: set.headers, status: error.status }
			)

		return mapResponse(error, set, context.request)
	}
}`,Function("inject",X)({app:$,mapResponse:a1,ERROR_CODE:g6,ELYSIA_RESPONSE:X8})},E6=($)=>`if(stc${$}) return stc${$}(ctx)
if(st${$}.compose) return (stc${$} = st${$}.compose())(ctx)

return st${$}(ctx)`,sW=($)=>async(X)=>{const J=X.url,Q=J.indexOf("/",11),W=J.indexOf("?",Q+1),Z=W===-1?J.substring(Q):J.substring(Q,W),Y={cookie:{},status:200,headers:{}},z=Object.assign({},$.singleton.decorator,{set:Y,store:$.singleton.store,request:X,path:Z,qi:W});try{for(let P=0;P<$.event.request.length;P++){const g=$.event.request[P].fn;let I=g(z);if(I instanceof Promise)I=await I;if(I=r1(I,Y),I)return I}const q=$.router.dynamic.find(X.method,Z)??$.router.dynamic.find("ALL",Z);if(!q)throw new LJ;const{handle:G,hooks:B,validator:H,content:L}=q.store;let b;if(X.method!=="GET"&&X.method!=="HEAD")if(L)switch(L){case"application/json":b=await X.json();break;case"text/plain":b=await X.text();break;case"application/x-www-form-urlencoded":b=I6.parse(await X.text());break;case"application/octet-stream":b=await X.arrayBuffer();break;case"multipart/form-data":b={};const P=await X.formData();for(let g of P.keys()){if(b[g])continue;const I=P.getAll(g);if(I.length===1)b[g]=I[0];else b[g]=I}break}else{let P=X.headers.get("content-type");if(P){const g=P.indexOf(";");if(g!==-1)P=P.slice(0,g);for(let I=0;I<B.parse.length;I++){const J0=B.parse[I].fn;let U0=J0(z,P);if(U0 instanceof Promise)U0=await U0;if(U0){b=U0;break}}if(b===void 0)switch(P){case"application/json":b=await X.json();break;case"text/plain":b=await X.text();break;case"application/x-www-form-urlencoded":b=I6.parse(await X.text());break;case"application/octet-stream":b=await X.arrayBuffer();break;case"multipart/form-data":b={};const I=await X.formData();for(let J0 of I.keys()){if(b[J0])continue;const U0=I.getAll(J0);if(U0.length===1)b[J0]=U0[0];else b[J0]=U0}break}}}z.body=b,z.params=q?.params||void 0,z.query=W===-1?{}:I6.parse(J.substring(W+1)),z.headers={};for(let[P,g]of X.headers.entries())z.headers[P]=g;const T=Object.assign({},$.config?.cookie,H?.cookie?.config),K=X.headers.get("cookie");z.cookie=await qZ(z.set,K,T?{secrets:T.secrets!==void 0?typeof T.secrets==="string"?T.secrets:T.secrets.join(","):void 0,sign:T.sign===!0?!0:T.sign!==void 0?typeof T.sign==="string"?T.sign:T.sign.join(","):void 0}:void 0);for(let P=0;P<B.transform.length;P++){const g=B.transform[P],I=g.fn(z);if(g.subType==="derive")if(I instanceof Promise)Object.assign(z,await I);else Object.assign(z,I);else if(I instanceof Promise)await I}if(H){if(H.headers){const P={};for(let g in X.headers)P[g]=X.headers.get(g);if(H.headers.Check(P)===!1)throw new f0("header",H.headers,P)}if(H.params?.Check(z.params)===!1)throw new f0("params",H.params,z.params);if(H.query?.Check(z.query)===!1)throw new f0("query",H.query,z.query);if(H.cookie){const P={};for(let[g,I]of Object.entries(z.cookie))P[g]=I.value;if(H.cookie?.Check(P)===!1)throw new f0("cookie",H.cookie,P)}if(H.body?.Check(b)===!1)throw new f0("body",H.body,b)}for(let P=0;P<B.beforeHandle.length;P++){let g=B.beforeHandle[P].fn(z);if(g instanceof Promise)g=await g;if(g!==void 0){z.response=g;for(let J0=0;J0<B.afterHandle.length;J0++){let U0=B.afterHandle[J0].fn(z);if(U0 instanceof Promise)U0=await U0;if(U0)g=U0}const I=r1(g,z.set);if(I)return I}}let A=G(z);if(A instanceof Promise)A=await A;if(!B.afterHandle.length){const P=H?.response?.[A.status];if(P?.Check(A)===!1)throw new f0("response",P,A)}else{z.response=A;for(let P=0;P<B.afterHandle.length;P++){let g=B.afterHandle[P].fn(z);if(g instanceof Promise)g=await g;const I=r1(g,z.set);if(I!==void 0){const J0=H?.response?.[A.status];if(J0?.Check(I)===!1)throw new f0("response",J0,I);return I}}}if(z.set.cookie&&T?.sign){const P=!T.secrets?void 0:typeof T.secrets==="string"?T.secrets:T.secrets[0];if(T.sign===!0)for(let[g,I]of Object.entries(z.set.cookie))z.set.cookie[g].value=await k6(I.value,"${secret}");else{const g=H?.cookie?.schema?.properties;for(let I of T.sign){if(!(I in g))continue;if(z.set.cookie[I]?.value)z.set.cookie[I].value=await k6(z.set.cookie[I].value,P)}}}return a1(A,z.set)}catch(q){if(q.status)Y.status=q.status;return $.handleError(z,q)}finally{for(let q of $.event.onResponse)await q.fn(z)}},sB=($)=>async(X,J)=>{const Q=Object.assign(X,{error:J,code:J.code});Q.set=X.set;for(let W=0;W<$.event.error.length;W++){let Y=$.event.error[W].fn(Q);if(Y instanceof Promise)Y=await Y;if(Y!==void 0&&Y!==null)return a1(Y,X.set)}return new Response(typeof J.cause==="string"?J.cause:J.message,{headers:X.set.headers,status:J.status??500})},SJ={date:OZ,time:NJ(!0),"date-time":rW(!0),"iso-time":NJ(!1),"iso-date-time":rW(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:WU,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:wU,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:ZU,int32:{type:"number",validate:qU},int64:{type:"number",validate:BU},float:{type:"number",validate:eW},double:{type:"number",validate:eW},password:!0,binary:!0},aB=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,eB=[0,31,28,31,30,31,30,31,31,30,31,30,31],$U=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i,XU=/t|\s/i,JU=/\/|:/,QU=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,aW=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm,YU=-2147483648,zU=2147483647,UU=/[^\\]\\Z/,LZ=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,SZ=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,_Z=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,GU=SJ.date,MU=SJ["date-time"];p1.Format("date",($)=>{const X=$.replace(/"/g,"");if(LZ.test(X)||SZ.test(X)||_Z.test(X)||GU(X)){const J=new Date(X);if(!Number.isNaN(J.getTime()))return!0}return!1});p1.Format("date-time",($)=>{const X=$.replace(/"/g,"");if(LZ.test(X)||SZ.test(X)||_Z.test(X)||MU(X)){const J=new Date(X);if(!Number.isNaN(J.getTime()))return!0}return!1});Object.entries(SJ).forEach(($)=>{const[X,J]=$;if(!_0.Has(X)){if(J instanceof RegExp)p1.Format(X,(Q)=>J.test(Q));else if(typeof J==="function")p1.Format(X,J)}});var s=Object.assign({},Z$),$Z=($)=>{if(typeof $==="string")switch($.slice(-1)){case"k":return+$.slice(0,$.length-1)*1024;case"m":return+$.slice(0,$.length-1)*1048576;default:return+$}return $},DJ=($,X)=>{if(!(X instanceof Blob))return!1;if($.minSize&&X.size<$Z($.minSize))return!1;if($.maxSize&&X.size>$Z($.maxSize))return!1;if($.extension)if(typeof $.extension==="string"){if(!X.type.startsWith($.extension))return!1}else{for(let J=0;J<$.extension.length;J++)if(X.type.startsWith($.extension[J]))return!0;return!1}return!0},AU=b0.Get("Files")??p1.Type("File",DJ),HU=b0.Get("Files")??p1.Type("Files",($,X)=>{if(!Array.isArray(X))return DJ($,X);if($.minItems&&X.length<$.minItems)return!1;if($.maxItems&&X.length>$.maxItems)return!1;for(let J=0;J<X.length;J++)if(!DJ($,X[J]))return!1;return!0});if(!_0.Has("numeric"))_0.Set("numeric",($)=>!!$&&!isNaN(+$));if(!_0.Has("boolean"))_0.Set("boolean",($)=>$==="true"||$==="false");if(!_0.Has("ObjectString"))_0.Set("ObjectString",($)=>{let X=$.charCodeAt(0);if(X===9||X===10||X===32)X=$.trimStart().charCodeAt(0);if(X!==123&&X!==91)return!1;try{return JSON.parse($),!0}catch{return!1}});var M8={Numeric:($)=>{const X=Z$.Number($);return s.Transform(s.Union([s.String({format:"numeric",default:0}),s.Number($)],$)).Decode((J)=>{const Q=+J;if(isNaN(Q))return J;if($&&!q0.Check(X,Q))throw new f0("property",X,Q);return Q}).Encode((J)=>J)},Date:($)=>{const X=Z$.Date($);return s.Transform(s.Union([Z$.Date($),s.String({format:"date",default:(new Date()).toISOString()}),s.String({format:"date-time",default:(new Date()).toISOString()})],$)).Decode((J)=>{if(J instanceof Date)return J;const Q=new Date(J);if(!q0.Check(X,Q))throw new f0("property",X,Q);return Q}).Encode((J)=>{if(typeof J==="string")return new Date(J);return J})},BooleanString:($)=>{const X=Z$.Boolean($);return s.Transform(s.Union([s.String({format:"boolean",default:!1}),s.Boolean($)],$)).Decode((J)=>{if(typeof J==="string")return J==="true";if($&&!q0.Check(X,J))throw new f0("property",X,J);return J}).Encode((J)=>J)},ObjectString:($={},X)=>{const J=s.Object($,X),Q=JSON.stringify(q0.Create(J));return s.Transform(s.Union([s.String({format:"ObjectString",default:Q}),J])).Decode((W)=>{if(typeof W==="string"){try{W=JSON.parse(W)}catch{throw new f0("property",J,W)}if(!q0.Check(J,W))throw new f0("property",J,W);return W}return W}).Encode((W)=>{if(typeof W==="string")try{W=JSON.parse(W)}catch{throw new f0("property",J,W)}if(!q0.Check(J,W))throw new f0("property",J,W);return JSON.stringify(W)})},File:AU,Files:($={})=>s.Transform(HU($)).Decode((X)=>{if(Array.isArray(X))return X;return[X]}).Encode((X)=>X),Nullable:($)=>s.Union([s.Null(),$]),MaybeEmpty:($)=>s.Union([s.Null(),s.Undefined(),$]),Cookie:($,{domain:X,expires:J,httpOnly:Q,maxAge:W,path:Z,priority:Y,sameSite:z,secure:q,secrets:G,sign:B,...H}={})=>{const L=s.Object($,H);return L.config={domain:X,expires:J,httpOnly:Q,maxAge:W,path:Z,priority:Y,sameSite:z,secure:q,secrets:G,sign:B},L}};s.BooleanString=M8.BooleanString;s.ObjectString=M8.ObjectString;s.Numeric=M8.Numeric;s.File=($={})=>M8.File({default:"File",...$,extension:$?.type,type:"string",format:"binary"});s.Files=($={})=>M8.Files({...$,elysiaMeta:"Files",default:"Files",extension:$?.type,type:"array",items:{...$,default:"Files",type:"string",format:"binary"}});s.Nullable=($)=>M8.Nullable($);s.MaybeEmpty=M8.MaybeEmpty;s.Cookie=M8.Cookie;s.Date=M8.Date;var PZ=class ${constructor(X){if(this.server=null,this.dependencies={},this.reporter=new bJ,this._routes={},this._types={Prefix:"",Scoped:!1,Singleton:{},Definitions:{},Metadata:{}},this._ephemeral={},this._volatile={},this.singleton={decorator:{},store:{},derive:{},resolve:{}},this.definitions={type:{},error:{}},this.extender={macros:[]},this.validator=null,this.event={start:[],request:[],parse:[],transform:[],beforeHandle:[],afterHandle:[],mapResponse:[],onResponse:[],trace:[],error:[],stop:[]},this.telemetry={stack:void 0},this.router={http:new BJ,ws:new BJ,dynamic:new BJ,static:{http:{handlers:[],variables:"",map:{},all:""},ws:{}},history:[]},this.inference={event:{body:!1,cookie:!1,headers:!1,queries:[],query:!1,set:!1,unknownQueries:!1},trace:{request:!1,parse:!1,transform:!1,handle:!1,beforeHandle:!1,afterHandle:!1,error:!1,context:!1,store:!1,set:!1}},this.promisedModules=new hB,this.routeTree=new Map,this.handle=async(J)=>this.fetch(J),this.fetch=(J)=>{return(this.fetch=this.config.aot?tW(this):sW(this))(J)},this.handleError=async(J,Q)=>(this.handleError=this.config.aot?DZ(this):sB(this))(J,Q),this.outerErrorHandler=(J)=>new Response(J.message||J.name||"Error",{status:J?.status??500}),this.listen=(J,Q)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(this.compile(),typeof J==="string"){if(!x6(J))throw new Error("Port must be a numeric value");J=parseInt(J)}const W=this.fetch,Z=typeof J==="object"?{development:!T6,reusePort:!0,...this.config.serve||{},...J||{},websocket:{...this.config.websocket||{},...nW||{}},fetch:W,error:this.outerErrorHandler}:{development:!T6,reusePort:!0,...this.config.serve||{},websocket:{...this.config.websocket||{},...nW||{}},port:J,fetch:W,error:this.outerErrorHandler};this.server=Bun?.serve(Z);for(let Y=0;Y<this.event.start.length;Y++)this.event.start[Y].fn(this);if(Q)Q(this.server);return process.on("beforeExit",()=>{if(this.server){this.server.stop(),this.server=null;for(let Y=0;Y<this.event.stop.length;Y++)this.event.stop[Y].fn(this)}}),this.promisedModules.then(()=>{Bun?.gc(!1)}),this},this.stop=async()=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(),this.server=null,this.event.stop.length)for(let J=0;J<this.event.stop.length;J++)this.event.stop[J].fn(this)}},X?.tags)if(!X.detail)X.detail={tags:X.tags};else X.detail.tags=X.tags;if(this.config={forceErrorEncapsulation:!0,prefix:"",aot:!0,strictPath:!1,global:!1,cookie:{},analytic:!1,...X,experimental:X?.experimental??{},seed:X?.seed===void 0?"":X?.seed},X?.analytic&&(X?.name||X?.seed!==void 0))this.telemetry.stack=new Error().stack}get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}get _scoped(){return this.config.scoped}getServer(){return this.server}get routes(){return this.router.history}applyMacro(X){if(this.extender.macros.length){const J=vB({globalHook:this.event,localHook:X}),Q={events:{global:this.event,local:X},onParse:J("parse"),onTransform:J("transform"),onBeforeHandle:J("beforeHandle"),onAfterHandle:J("afterHandle"),onResponse:J("onResponse"),mapResponse:J("mapResponse"),onError:J("error")};for(let W of this.extender.macros)GZ(W.fn(Q),X)}}add(X,J,Q,W,{allowMeta:Z=!1,skipPrefix:Y=!1}={allowMeta:!1,skipPrefix:!1}){if(W=pB(W),J!==""&&J.charCodeAt(0)!==47)J="/"+J;if(this.config.prefix&&!Y&&!this.config.scoped)J=this.config.prefix+J;if(W?.type)switch(W.type){case"text":W.type="text/plain";break;case"json":W.type="application/json";break;case"formdata":W.type="multipart/form-data";break;case"urlencoded":W.type="application/x-www-form-urlencoded";break;case"arrayBuffer":W.type="application/octet-stream";break;default:break}const z=this.definitions.type;let q,G,B,H,L,b;const T=!this.config.aot,K={body:W?.body??this.validator?.body,headers:W?.headers??this.validator?.headers,params:W?.params??this.validator?.params,query:W?.query??this.validator?.query,cookie:W?.cookie??this.validator?.cookie,response:W?.response??this.validator?.response},A=()=>K.cookie?wZ({validator:K.cookie,defaultConfig:this.config.cookie,config:K.cookie?.config??{},dynamic:T,models:z}):void 0,P=this.config.normalize,g=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.schema===!0?{body:K1(K.body,{dynamic:T,models:z,normalize:P}),headers:K1(K.headers,{dynamic:T,models:z,additionalProperties:!0}),params:K1(K.params,{dynamic:T,models:z}),query:K1(K.query,{dynamic:T,models:z,normalize:P}),cookie:A(),response:pW(K.response,{dynamic:T,models:z,normalize:P})}:{get body(){if(q)return q;return q=K1(K.body,{dynamic:T,models:z,normalize:P})},get headers(){if(G)return G;return K1(K.headers,{dynamic:T,models:z,additionalProperties:!0})},get params(){if(B)return B;return B=K1(K.params,{dynamic:T,models:z})},get query(){if(H)return H;return H=K1(K.query,{dynamic:T,models:z})},get cookie(){if(L)return L;return L=A()},get response(){if(b)return b;return b=pW(K.response,{dynamic:T,models:z,normalize:P})}},I=J.endsWith("/")?J.slice(0,J.length-1):J+"/";if(W=R1(W,{},{allowMacro:!0}),W.tags)if(!W.detail)W.detail={tags:W.tags};else W.detail.tags=W.tags;if($8(this.config.detail))W.detail=V1(Object.assign({},this.config.detail),W.detail);this.applyMacro(W);const J0=R1(this.event,W);if(this.config.aot===!1){if(this.router.dynamic.add(X,J,{validator:g,hooks:J0,content:W?.type,handle:Q}),this.config.strictPath===!1)this.router.dynamic.add(X,I,{validator:g,hooks:J0,content:W?.type,handle:Q});this.router.history.push({method:X,path:J,composed:null,handler:Q,hooks:J0});return}let U0=void 0;const t0=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,y1=GJ(this.inference),m0=t0?AJ({app:this,path:J,method:X,localHook:R1(W),hooks:J0,validator:g,handler:Q,allowMeta:Z,appInference:y1}):(m)=>{if(U0)return U0(m);return(U0=AJ({app:this,path:J,method:X,localHook:R1(W),hooks:J0,validator:g,handler:Q,allowMeta:Z,appInference:y1}))(m)};if(!t0)m0.compose=()=>{return m0.composed=AJ({app:this,path:J,method:X,localHook:R1(W),hooks:J0,validator:g,handler:Q,allowMeta:Z,appInference:y1})};let A0=this.router.history.length;if(this.routeTree.has(X+J)){if(A0=this.router.history.findIndex((m)=>m.path===J&&m.method===X),A0!==-1){const m=this.router.history.splice(A0,1)[0];if(m&&this.routeTree.has(m?.method+m?.path))this.routeTree.delete(m.method+m.path)}}this.routeTree.set(X+J,A0),this.router.history.push({method:X,path:J,composed:m0,handler:Q,hooks:J0});const Q0=this.router.static.http;if(X==="$INTERNALWS"){const m=this.config.strictPath?void 0:J.endsWith("/")?J.slice(0,J.length-1):J+"/";if(J.indexOf(":")===-1&&J.indexOf("*")===-1){const Z1=Q0.handlers.length;if(Q0.handlers.push(m0),Q0.variables+=`const st${Z1} = staticRouter.handlers[${Z1}]
`,this.router.static.ws[J]=Z1,m)this.router.static.ws[m]=Z1}else if(this.router.ws.add("ws",J,m0),m)this.router.ws.add("ws",m,m0);return}if(J.indexOf(":")===-1&&J.indexOf("*")===-1){const m=Q0.handlers.length;if(Q0.handlers.push(m0),Q0.variables+=t0?`const st${m} = staticRouter.handlers[${m}]
`:`let st${m} = staticRouter.handlers[${m}]
let stc${m}
`,!Q0.map[J])Q0.map[J]={code:""};if(X==="ALL")Q0.map[J].all=t0?`default: return st${m}(ctx)
`:`default: ${E6(m)}
`;else Q0.map[J].code=t0?`case '${X}': return st${m}(ctx)
${Q0.map[J].code}`:`case '${X}': ${E6(m)}
${Q0.map[J].code}`;if(!this.config.strictPath){if(!Q0.map[I])Q0.map[I]={code:""};if(X==="ALL")Q0.map[I].all=t0?`default: return st${m}(ctx)
`:`default: ${E6(m)}
`;else Q0.map[I].code=t0?`case '${X}': return st${m}(ctx)
${Q0.map[I].code}`:`case '${X}': ${E6(m)}
${Q0.map[I].code}`}}else if(this.router.http.add(X,J,m0),!this.config.strictPath)this.router.http.add(X,J.endsWith("/")?J.slice(0,J.length-1):J+"/",m0)}headers(X){if(!X)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=V1(this.setHeaders,X),this}onStart(X){return this.on("start",X),this}onRequest(X){return this.on("request",X),this}onParse(X,J){if(!J)return this.on("parse",X);return this.on(X,"parse",J)}onTransform(X,J){if(!J)return this.on("transform",X);return this.on(X,"transform",J)}resolve(X,J){if(!J)J=X,X={as:"local"};const Q={subType:"resolve",fn:J};return this.onBeforeHandle(X,Q)}mapResolve(X,J){if(!J)J=X,X={as:"local"};const Q={subType:"resolve",fn:J};return this.onBeforeHandle(X,Q)}onBeforeHandle(X,J){if(!J)return this.on("beforeHandle",X);return this.on(X,"beforeHandle",J)}onAfterHandle(X,J){if(!J)return this.on("afterHandle",X);return this.on(X,"afterHandle",J)}mapResponse(X,J){if(!J)return this.on("mapResponse",X);return this.on(X,"mapResponse",J)}onResponse(X,J){if(!J)return this.on("response",X);return this.on(X,"response",J)}trace(X,J){if(!J)J=X,X={as:"local"};if(!Array.isArray(J))J=[J];for(let Q of J)this.reporter.on("event",_B(()=>this.reporter,this.event.trace.length,Q));return this.on(X,"trace",J),this}error(X,J){switch(typeof X){case"string":return J.prototype[g6]=X,this.definitions.error[X]=J,this;case"function":return this.definitions.error=X(this.definitions.error),this}for(let[Q,W]of Object.entries(X))W.prototype[g6]=Q,this.definitions.error[Q]=W;return this}onError(X,J){if(!J)return this.on("error",X);return this.on(X,"error",J)}onStop(X){return this.on("stop",X),this}on(X,J,Q){let W;switch(typeof X){case"string":W=X,Q=J;break;case"object":W=J;break}if(W==="response")W="onResponse";if(Array.isArray(Q))Q=j1(Q);else if(typeof Q==="function")Q=[{fn:Q}];else Q=[Q];const Z=Q;for(let Y of Z)Y.scope=typeof X==="string"?"local":X?.as??"local";if(W==="trace")VB(Z.map((Y)=>Y.fn),this.inference.trace);else YZ({[W]:Z.map((Y)=>Y.fn)},this.inference.event);for(let Y of Z){const z=yB(Y,"global",{skipIfHasType:!0});switch(W){case"start":this.event.start.push(z);break;case"request":this.event.request.push(z);break;case"parse":this.event.parse.push(z);break;case"transform":this.event.transform.push(z);break;case"beforeHandle":this.event.beforeHandle.push(z);break;case"afterHandle":this.event.afterHandle.push(z);break;case"mapResponse":this.event.mapResponse.push(z);break;case"onResponse":this.event.onResponse.push(z);break;case"trace":this.event.trace.push(z);break;case"error":this.event.error.push(z);break;case"stop":this.event.stop.push(z);break}}return this}propagate(){const X=(J)=>{for(let Q of J)if("scope"in Q&&Q.scope==="local")Q.scope="scoped"};return X(this.event.parse),X(this.event.transform),X(this.event.beforeHandle),X(this.event.afterHandle),X(this.event.mapResponse),X(this.event.onResponse),X(this.event.trace),X(this.event.error),this}group(X,J,Q){const W=new $({...this.config,prefix:""});W.singleton={...this.singleton},W.definitions={...this.definitions},W.getServer=()=>this.server,W.inference=GJ(this.inference);const Z=typeof J==="object",Y=(Z?Q:J)(W);if(this.singleton=V1(this.singleton,W.singleton),this.definitions=V1(this.definitions,W.definitions),Y.event.request.length)this.event.request=[...this.event.request||[],...Y.event.request||[]];if(Y.event.onResponse.length)this.event.onResponse=[...this.event.onResponse||[],...Y.event.onResponse||[]];return this.model(Y.definitions.type),Object.values(W.router.history).forEach(({method:z,path:q,handler:G,hooks:B})=>{if(q=(Z?"":this.config.prefix)+X+q,Z){const H=J,L=B;this.add(z,q,G,R1(H,{...L||{},error:!L.error?Y.event.error:Array.isArray(L.error)?[...L.error||{},...Y.event.error||{}]:[L.error,...Y.event.error||{}]}))}else this.add(z,q,G,R1(B,{error:Y.event.error}),{skipPrefix:!0})}),this}guard(X,J){if(!J){if(typeof X==="object"){if(this.applyMacro(X),this.event=wJ(this.event,X),this.validator={body:X.body??this.validator?.body,headers:X.headers??this.validator?.headers,params:X.params??this.validator?.params,query:X.query??this.validator?.query,response:X.response??this.validator?.response,cookie:X.cookie??this.validator?.cookie},X.detail)if(this.config.detail)this.config.detail=V1(Object.assign({},this.config.detail),X.detail);else this.config.detail=X.detail;if(X?.tags)if(!this.config.detail)this.config.detail={tags:X.tags};else this.config.detail.tags=X.tags;return this}return this.guard({},X)}const Q=new $({...this.config,prefix:""});Q.singleton={...this.singleton},Q.definitions={...this.definitions},Q.inference=GJ(this.inference);const W=J(Q);if(this.singleton=V1(this.singleton,Q.singleton),this.definitions=V1(this.definitions,Q.definitions),W.getServer=()=>this.server,W.event.request.length)this.event.request=[...this.event.request||[],...W.event.request||[]];if(W.event.onResponse.length)this.event.onResponse=[...this.event.onResponse||[],...W.event.onResponse||[]];return this.model(W.definitions.type),Object.values(Q.router.history).forEach(({method:Z,path:Y,handler:z,hooks:q})=>{this.add(Z,Y,z,R1(X,{...q||{},error:!q.error?W.event.error:Array.isArray(q.error)?[...q.error||{},...W.event.error||[]]:[q.error,...W.event.error||[]]},{allowMacro:!0}))}),this}use(X,J){if(J?.scoped)return this.guard({},(Q)=>Q.use(X));if(Array.isArray(X)){let Q=this;for(let W of X)Q=this.use(W);return Q}if(X instanceof Promise)return this.promisedModules.add(X.then((Q)=>{if(typeof Q==="function")return Q(this);if(Q instanceof $)return this._use(Q);if(typeof Q.default==="function")return Q.default(this);if(Q.default instanceof $)return this._use(Q.default);throw new Error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.')}).then((Q)=>Q.compile())),this;return this._use(X)}_use(X){if(typeof X==="function"){const Z=X(this);if(Z instanceof Promise)return this.promisedModules.add(Z.then((Y)=>{if(Y instanceof $){this.compile();for(let{method:z,path:q,handler:G,hooks:B}of Object.values(Y.router.history))this.add(z,q,G,R1(B,{error:Y.event.error}));return Y}if(typeof Y==="function")return Y(this);if(typeof Y.default==="function")return Y.default(this);return this._use(Y)}).then((Y)=>Y.compile())),this;return Z}if(X.promisedModules.size)return this.promisedModules.add(X.modules.then(()=>this._use(X)).then((Z)=>Z.compile())),this;const{name:J,seed:Q}=X.config;X.getServer=()=>this.getServer(),X.model(this.definitions.type),X.error(this.definitions.error);const W=X.config.scoped;if(W){if(J){if(!(J in this.dependencies))this.dependencies[J]=[];const Y=Q!==void 0?K6(J+JSON.stringify(Q)):0;if(this.dependencies[J].some(({checksum:z})=>Y===z))return this;this.dependencies[J].push(!this.config?.analytic?{name:X.config.name,seed:X.config.seed,checksum:Y,dependencies:X.dependencies}:{name:X.config.name,seed:X.config.seed,checksum:Y,dependencies:X.dependencies,stack:X.telemetry.stack,routes:X.router.history,decorators:X.singleton.decorator,store:X.singleton.store,type:X.definitions.type,error:X.definitions.error,derive:X.event.transform.filter((z)=>z.subType==="derive").map((z)=>({fn:z.fn.toString(),stack:new Error().stack??""})),resolve:X.event.transform.filter((z)=>z.subType==="derive").map((z)=>({fn:z.fn.toString(),stack:new Error().stack??""}))})}X.extender.macros=this.extender.macros.concat(X.extender.macros);const Z=[];for(let Y=0;Y<X.extender.macros.length;Y++){const z=this.extender.macros[Y];if(Z.includes(z.checksum))X.extender.macros.splice(Y,1),Y--;Z.push(z.checksum)}if(X.onRequest((Y)=>{Object.assign(Y,this.singleton.decorator),Object.assign(Y.store,this.singleton.store)}),X.event.trace.length)X.event.trace.push(...X.event.trace);if(!X.config.prefix)console.warn("It's recommended to use scoped instance with a prefix to prevent collision routing with other instance.");if(X.event.error.length)X.event.error.push(...this.event.error);if(X.config.aot)X.compile();if(W===!0&&X.config.prefix){this.mount(X.config.prefix+"/",X.fetch);for(let Y of X.router.history)this.routeTree.set(Y.method+`${X.config.prefix}${Y.path}`,this.router.history.length),this.router.history.push({...Y,path:`${X.config.prefix}${Y.path}`,hooks:R1(Y.hooks,{error:this.event.error})})}else{this.mount(X.fetch);for(let Y of X.router.history)this.routeTree.set(Y.method+`${X.config.prefix}${Y.path}`,this.router.history.length),this.router.history.push({...Y,path:`${X.config.prefix}${Y.path}`,hooks:R1(Y.hooks,{error:this.event.error})})}return this}else{this.headers(X.setHeaders),X.reporter=this.reporter;for(let Y of X.event.trace)if(Y.scope&&Y.scope!=="local")this.trace(Y);if(J){if(!(J in this.dependencies))this.dependencies[J]=[];const Y=Q!==void 0?K6(J+JSON.stringify(Q)):0;if(!this.dependencies[J].some(({checksum:z})=>Y===z))this.extender.macros=this.extender.macros.concat(X.extender.macros)}else this.extender.macros=this.extender.macros.concat(X.extender.macros);const Z=[];for(let Y=0;Y<this.extender.macros.length;Y++){const z=this.extender.macros[Y];if(z.checksum){if(Z.includes(z.checksum))this.extender.macros.splice(Y,1),Y--;Z.push(z.checksum)}}this.inference={event:{body:this.inference.event.body||X.inference.event.body,cookie:this.inference.event.cookie||X.inference.event.cookie,headers:this.inference.event.headers||X.inference.event.headers,queries:[...this.inference.event.queries,...X.inference.event.queries],query:this.inference.event.query||X.inference.event.query,set:this.inference.event.set||X.inference.event.set,unknownQueries:this.inference.event.unknownQueries||X.inference.event.unknownQueries},trace:{request:this.inference.trace.request||X.inference.trace.request,parse:this.inference.trace.parse||X.inference.trace.parse,transform:this.inference.trace.transform||X.inference.trace.transform,handle:this.inference.trace.handle||X.inference.trace.handle,beforeHandle:this.inference.trace.beforeHandle||X.inference.trace.beforeHandle,afterHandle:this.inference.trace.afterHandle||X.inference.trace.afterHandle,error:this.inference.trace.error||X.inference.trace.error,context:this.inference.trace.context||X.inference.trace.context,store:this.inference.trace.store||X.inference.trace.store,set:this.inference.trace.set||X.inference.trace.set}}}this.decorate(X.singleton.decorator),this.state(X.singleton.store),this.model(X.definitions.type),this.error(X.definitions.error);for(let{method:Z,path:Y,handler:z,hooks:q}of Object.values(X.router.history))this.add(Z,Y,z,R1(q,{error:X.event.error}));if(!W)if(J){if(!(J in this.dependencies))this.dependencies[J]=[];const Z=Q!==void 0?K6(J+JSON.stringify(Q)):0;if(this.dependencies[J].some(({checksum:Y})=>Z===Y))return this;this.dependencies[J].push(!this.config?.analytic?{name:X.config.name,seed:X.config.seed,checksum:Z,dependencies:X.dependencies}:{name:X.config.name,seed:X.config.seed,checksum:Z,dependencies:X.dependencies,stack:X.telemetry.stack,routes:X.router.history,decorators:X.singleton,store:X.singleton.store,type:X.definitions.type,error:X.definitions.error,derive:X.event.transform.filter((Y)=>Y?.subType==="derive").map((Y)=>({fn:Y.toString(),stack:new Error().stack??""})),resolve:X.event.transform.filter((Y)=>Y?.subType==="resolve").map((Y)=>({fn:Y.toString(),stack:new Error().stack??""}))}),this.event=wJ(this.event,mW(X.event),Z)}else this.event=wJ(this.event,mW(X.event));return this}macro(X){const J={checksum:K6(JSON.stringify({name:this.config.name,seed:this.config.seed,content:X.toString()})),fn:X};return this.extender.macros.push(J),this}mount(X,J){if(X instanceof $||typeof X==="function"||X.length===0||X==="/"){const Z=typeof X==="function"?X:X instanceof $?X.compile().fetch:J instanceof $?J.compile().fetch:J,Y=async({request:z,path:q})=>Z(new Request(hW(z.url,q||"/"),z));return this.all("/*",Y,{type:"none"}),this}const Q=X.length;if(J instanceof $)J=J.compile().fetch;const W=async({request:Z,path:Y})=>J(new Request(hW(Z.url,Y.slice(Q)||"/"),Z));return this.all(X,W,{type:"none"}),this.all(X+(X.endsWith("/")?"*":"/*"),W,{type:"none"}),this}get(X,J,Q){return this.add("GET",X,J,Q),this}post(X,J,Q){return this.add("POST",X,J,Q),this}put(X,J,Q){return this.add("PUT",X,J,Q),this}patch(X,J,Q){return this.add("PATCH",X,J,Q),this}delete(X,J,Q){return this.add("DELETE",X,J,Q),this}options(X,J,Q){return this.add("OPTIONS",X,J,Q),this}all(X,J,Q){return this.add("ALL",X,J,Q),this}head(X,J,Q){return this.add("HEAD",X,J,Q),this}connect(X,J,Q){return this.add("CONNECT",X,J,Q),this}route(X,J,Q,W){return this.add(X.toUpperCase(),J,Q,W,W?.config),this}ws(X,J){const Q=J.transformMessage?Array.isArray(J.transformMessage)?J.transformMessage:[J.transformMessage]:void 0;let W=null;const Z=K1(J?.body,{models:this.definitions.type,normalize:this.config.normalize}),Y=K1(J?.response,{models:this.definitions.type,normalize:this.config.normalize}),z=(q)=>{if(typeof q==="string"){const G=q?.charCodeAt(0);if(G===47||G===123)try{q=JSON.parse(q)}catch{}else if(x6(q))q=+q}if(Q?.length)for(let G=0;G<Q.length;G++){const B=Q[G](q);if(B!==void 0)q=B}return q};return this.route("$INTERNALWS",X,(q)=>{const{set:G,path:B,qi:H,headers:L,query:b,params:T}=q;if(W===null)W=this.getServer();if(W?.upgrade(q.request,{headers:typeof J.upgrade==="function"?J.upgrade(q):J.upgrade,data:{validator:Y,open(K){J.open?.(new V6(K,q))},message:(K,A)=>{const P=z(A);if(Z?.Check(P)===!1)return void K.send(new f0("message",Z,P).message);J.message?.(new V6(K,q),P)},drain(K){J.drain?.(new V6(K,q))},close(K,A,P){J.close?.(new V6(K,q),A,P)}}}))return;return G.status=400,"Expected a websocket connection"},{beforeHandle:J.beforeHandle,transform:J.transform,headers:J.headers,params:J.params,query:J.query}),this}state(X,J){switch(typeof X){case"object":return this.singleton.store=V1(this.singleton.store,X),this;case"function":return this.singleton.store=X(this.singleton.store),this}if(!(X in this.singleton.store))this.singleton.store[X]=J;return this}decorate(X,J){switch(typeof X){case"object":return this.singleton.decorator=V1(this.singleton.decorator,X),this;case"function":return this.singleton.decorator=X(this.singleton.decorator),this}if(!(X in this.singleton.decorator))this.singleton.decorator[X]=J;return this}derive(X,J){if(!J)J=X,X={as:"local"};const Q={subType:"derive",fn:J};return this.onTransform(X,Q)}model(X,J){switch(typeof X){case"object":return Object.entries(X).forEach(([Q,W])=>{if(!(Q in this.definitions.type))this.definitions.type[Q]=W}),this;case"function":return this.definitions.type=X(this.definitions.type),this}return this.definitions.type[X]=J,this}mapDerive(X,J){if(!J)J=X,X={as:"local"};const Q={subType:"derive",fn:J};return this.onTransform(X,Q)}affix(X,J,Q){if(Q==="")return this;const W=["_","-"," "],Z=(G)=>G[0].toUpperCase()+G.slice(1),Y=X==="prefix"?(G,B)=>W.includes(G.at(-1)??"")?G+B:G+Z(B):W.includes(Q.at(-1)??"")?(G,B)=>B+G:(G,B)=>B+Z(G),z=(G)=>{const B={};switch(G){case"decorator":for(let H in this.singleton.decorator)B[Y(Q,H)]=this.singleton.decorator[H];this.singleton.decorator=B;break;case"state":for(let H in this.singleton.store)B[Y(Q,H)]=this.singleton.store[H];this.singleton.store=B;break;case"model":for(let H in this.definitions.type)B[Y(Q,H)]=this.definitions.type[H];this.definitions.type=B;break;case"error":for(let H in this.definitions.error)B[Y(Q,H)]=this.definitions.error[H];this.definitions.error=B;break}},q=Array.isArray(J)?J:[J];for(let G of q.some((B)=>B==="all")?["decorator","state","model","error"]:q)z(G);return this}prefix(X,J){return this.affix("prefix",X,J)}suffix(X,J){return this.affix("suffix",X,J)}compile(){if(this.fetch=this.config.aot?tW(this):sW(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}get modules(){return Promise.all(this.promisedModules.promises)}};var DU=function($){return Bun.gzipSync($)},OU=function($){return Bun.deflateSync($)},NU=new TextEncoder,CZ=($,X)=>{const J=typeof $==="object";let Q=NU.encode(J?JSON.stringify($):$);switch(X){case"gzip":return DU(Q);case"deflate":return OU(Q);default:return $}};class _J{statusCode=200;headers=new Headers;header($,X){return this.headers.set($,X),this}status($){return this.statusCode=$,this}ok($){return this.compress($)}tooManyRequests($){return this.statusCode=429,this.compress($)}notFound($){return this.statusCode=404,this.compress($)}badRequest($){return this.statusCode=400,this.compress($)}unauthorized($){return this.statusCode=401,this.compress($)}forbidden($){return this.statusCode=403,this.compress($)}internalServerError($){return this.statusCode=500,this.compress($)}serviceUnavailable($){return this.statusCode=503,this.compress($)}problem($){return this.header("Content-Type","application/problem+json"),this.compress($)}withoutCompress($){return this.setContentType($),new Response($,{headers:this.headers,status:this.statusCode})}compress($){if(!v6.enableCompression)return this.withoutCompress($);const X=["gzip","deflate"],J=X.findIndex((W)=>v6.compressions.indexOf(W)!==-1),Q=J!==-1?X[J]:"";if(Q!="")this.headers.set("Content-Encoding",Q);return this.setContentType($),new Response(CZ($,Q),{headers:this.headers,status:this.statusCode})}setContentType($){this.headers.set("Content-Type",`${typeof $==="object"?"application/json":"text/plain"}; charset=utf-8`)}}var v6,LU={enableCompression:!0,compressions:["gzip"]},xK=($=LU)=>{return v6=$,new PZ({name:"ElysiaResponse"}).decorate("res",new _J)};export{v6 as cfg,xK as ElysiaResponse};
